//*********************************************************************
//* Program   : GECTechnology.BED
//*             Generated by Forrest Bentley's GEC B-Edit Analysis System v2.1
//* Date      : 07/18/14
//* Time      : 10:47:22 
//* Desc      : This system will visually display GEC technologies
//*
//*********************************************************************
//*                       Change Log
//*
//* Date       Author          Description
//* ---------- --------------- ----------------------------------------
//* 07/18/2014 Forrest Bentley Initial program
//* 07/22/2014 Forrest Bentley Added Filter selection
//* 08/01/2014 Forrest Bentley Draw objects
//*                            Bubble Help
//* 08/04/2014 Forrest Bentley Boxes in proper lanes
//* 08/05/2014 Forrest Bentley Details window cleanup
//*                            Details Window data fill
//*                            Bubble include Version
//*                            Bubble help off when Details Open
//*                            Details Add/Change/Delete
//*                            Don't hide gridlines when filters are present
//*                            Fixed Filter "ALL" bug
//*                            Changed GECTechnology.csv to GECTechnology.dat delimited by '|'
//*                            Added Maintenance, Support, Hits, and Comments to data
//*                            Added input validation
//* 08/06/2014 Forrest Bentley Added Backups
//*                            Added Motion View of History
//*                            Added Speed buttons, including 1/2 second change to beditwin.exe
//*                            Prevent any changes until viewing GECTechnology.dat file
//*                            Added Forward/Backward history buttons
//*                            Added Multiple Business
//*                            Added Size buttons (Lines of Code, Maintenance, Support, Hits/Usage)
//*                            Allow click of object when paused, disable all detal buttons
//* 08/07/2014 Forrest Bentley Changed sizes of each lane (Adopt is largest)
//* 08/08/2014 Forrest Bentley Changed presentation of boxes to reflect Type
//*                            Added visual radio button if Watch is turned on
//*                            Added Filter by Description
//*                            Fixed display past border bug not zeroing Ymax
//*                            Added Strategy display
//*                            Added Legend
//*                            Added Click in blank area -> Add
//* 08/11/2014 Forrest Bentley Added Login
//*                            Changed technology create (click blank area) to set Status based on mouse position
//* 08/13/2014 Forrest Bentley Added Applications Window logic
//*                            Added Size button to View
//* 08/14/2014 Forrest Bentley Fixed Application Filtering
//*                            Changed Access to Assess
//* 08/15/2014 Forrest Bentley Added paint using circles
//* 08/16/2014 Forrest Bentley Added slectable color schemes
//*                            Added Last Update Filter
//* 08/19/2014 Forrest Bentley Added Strategy Lines
//*                            Added Menu selection checks
//*                            Added Draw Down
//* 08/20/2014 Forrest Bentley Corrected drawing overlap bug
//*                            Show drawing
//*                            Added Average
//* 08/21/2014 Forrest Bentley Added Filter Clear button
//*                            Added Refresh button
//* 08/22/2014 Forrest Bentley Replaced Size button with Age/Size radio buttons
//*                            Added Filter Description to Title
//*                            Disable Change/Delete buttons if click to add a new technology
//*                            Added Progress Bar
//*                            Dynamic index text colors
//* 08/26/2014 Forrest Bentley Added Business Process
//*                            Fixed Filtering Title "Filtered by and"
//* 08/27/2014 Forrest Bentley Added optional labels to view
//*                            Title include date/time when playing history (bug fix)
//* 08/29/2014 Forrest Bentley Added View background colors
//*                            Changed Drawing menu selections and buttons to checkbox/radio buttons
//*                            Optional Background
//*                            Display Style selection
//* 09/02/2014 Forrest Bentley Added hilights to Axis'
//*                            Single char Y Axis
//*                            Removed "Viewer" from titles
//*                            Search And/Or
//*                            Average line based on actual positions
//*                            Polar view
//* 09/03/2014 Forrest Bentley Added Polar Status Labels
//*                            Changed Polar Ball Type to Ellipse
//*                            Corrected Overlapping Large over Small
//*                            Moved all controls right
//*                            Reset StartAngle on every refresh
//*                            Retain Style after color refresh
//*                            If filter by Type, use full circle for polar view
//* 09/04/2014 Forrest Bentley Increased window height
//*                            Balls drawn from center
//* 09/05/2014 Forrest Bentley Added object drawing retry count
//*                            Fixed overlap after centering ball paint
//*                            Fix Labels location
//*                            Misc Cleanup
//* 09/08/2014 Forrest Bentley Added Large Titles to Polar View
//*                            Darker Polar Separator Lines
//*                            Average Polar Radius = 2*BallSize - StatusRadius
//*                            Default to Polar
//*                            Added List View
//* 09/09/2014 Forrest Bentley Fixed List View
//*                            Fixed bad open on sorted files
//*                            Misc cleanup
//* 09/10/2014 Forrest Bentley Added page count to List view
//* 09/11/2014 Forrest Bentley Added Polar Zoom in/out/move
//* 09/12/2014 Forrest Bentley Moved Zoom controls to top
//* 09/16/2014 Forrest Bentley Added 'b' to progress update to prevent paint error (bug)
//* 09/17/2014 Forrest Bentley Fixed bubble help if position = 0 force to 1
//*                            Changed "Trend" to "Strategy"
//*                            Zoom retains translation
//*                            Reset Label size to 8 when filtering
//* 09/24/2014 Forrest Bentley Added Legend
//* 09/25/2014 Forrest Bentley Added more room for Tools in Polar View
//* 09/30/2014 Forrest Bentley Added 3D Bitmap Balls
//* 10/01/2014 Forrest Bentley Changed 3D Ball Colors to standard
//*                            Higher resolution 3D balls
//*                            Added watch circle for 3D balls
//* 10/02/2014 Forrest Bentley Added GE Logo to main window
//* 10/03/2014 Forrest Bentley Added Export to Excel
//* 10/06/2014 Forrest Bentley Added names to paintfile objects
//* 11/03/2014 Forrest Bentley Increased Zoom size for +-
//* 11/25/2014 Forrest Bentley Changed to proper Arrows
//* 12/05/2014 Forrest Bentley Changed Watch EFOBJ to Follow-Up CBOBJ
//* 12/15/2014 Forrest Bentley Speed up Zoom in/out
//* 12/16/2014 Forrest Bentley Added drag during zoom
//* 12/18/2014 Forrest Bentley Moved Legend button to upper right
//* 01/09/2015 Forrest Bentley Prevented drag if not Polar View
//* 01/21/2015 Forrest Bentley Added Key to DataFile
//* 02/20/2015 Forrest Bentley Added ArchLayers and TechStacks
//*                            Added Multiselect for Type, Status, Strategy
//* 04/28/2015 Forrest Bentley Added HTML rendering
//* 04/30/2015 Forrest Bentley Added logic to create HTML detail screens
//*                            Added HTML details screens click navigation
//* 05/01/2015 Forrest Bentley Added HTML list
//*
//*********************************************************************

    //***********************************
    //* Storage Variables
    //***********************************
 
    int     Xpos
    int     Ypos
    float   fXpos
    float   fYpos
    int     XposLast
    int     YposLast
    string  MouseOK = 'y'
    string  Drag
    int     DragX
    int     DragY
    int     MoveX
    int     MoveY
 
    string  Ban1 = 'GEC'
    string  Ban2 = 'Technology'
    string  Ban3 = 'System'
    string  BannerLine1 = Ban1
    string  BannerLine2 = Ban2
    string  BannerLine3 = Ban3
    //***********************************
    //* Special Actions                 
    //***********************************
    string WindowInit                                       = "call !a010_WindowInit"
    string WindowWrap                                       = "call !a010_WindowWrap"
    string WindowMouse                                      = "call !a010_WindowMouse"
    string WindowDown1                                      = "call !a010_WindowDown1"
    string WindowDown2                                      = "call !a010_WindowDown2"
    string WindowUp1                                        = "call !a010_WindowUp1"
    string WindowUp2                                        = "call !a010_WindowUp2"
    string WindowEscape                                     = "call !a010_Escape"
    string DefaultWindowProcess                             = "call !a010_Default_Window_Processing"
    string WindowTimer                                      = "call !a100_WindowTimer"


    //***********************************
    //* Window Menu Actions             
    //***********************************
    string GECTechnology_Login_Ok_PBOBJ                    = "call !a010_GECTechnology_Login_Ok_PBOBJ"
    string GECTechnology_Login_Cancel_PBOBJ                = "call !a010_GECTechnology_Login_Cancel_PBOBJ"
    string GECTechnology_Login_Guest_PBOBJ                 = "call !a010_GECTechnology_Login_Guest_PBOBJ"

    string GECTechnology_Main_Exit_MSOBJ                   = "call !a090_GECTechnology_Main_Exit_MSOBJ"
    string GECTechnology_Main_Banneron_MSOBJ               = "call !a090_GECTechnology_Main_Banneron_MSOBJ"
    string GECTechnology_Main_Banneroff_MSOBJ              = "call !a090_GECTechnology_Main_Banneroff_MSOBJ"
    string GECTechnology_Main_About_MSOBJ                  = "call !a095_GECTechnology_Main_About_MSOBJ"
    string GECTechnology_Techview_MSOBJ                    = "call !a100_GECTechnology_Techview_MSOBJ"
    string GECTechnology_Export_MSOBJ                      = "call !a110_GECTechnology_Export_MSOBJ"

    string GECTechnology_Main_Colors1_MSOBJ                = "call !a200_GECTechnology_Main_Colors1_MSOBJ"
    string GECTechnology_Main_Colors2_MSOBJ                = "call !a210_GECTechnology_Main_Colors2_MSOBJ"
    string GECTechnology_Main_Colors3_MSOBJ                = "call !a220_GECTechnology_Main_Colors3_MSOBJ"
    string GECTechnology_Main_Colors4_MSOBJ                = "call !a230_GECTechnology_Main_Colors4_MSOBJ"
    string GECTechnology_Main_Colors5_MSOBJ                = "call !a240_GECTechnology_Main_Colors5_MSOBJ"
    string GECTechnology_Main_Colors6_MSOBJ                = "call !a250_GECTechnology_Main_Colors6_MSOBJ"
    string GECTechnology_Main_Colors7_MSOBJ                = "call !a260_GECTechnology_Main_Colors7_MSOBJ"
    string GECTechnology_Main_Colors8_MSOBJ                = "call !a270_GECTechnology_Main_Colors8_MSOBJ"
    string GECTechnology_Main_Colors9_MSOBJ                = "call !a280_GECTechnology_Main_Colors9_MSOBJ"
    string GECTechnology_Main_Colors3D_MSOBJ               = "call !a290_GECTechnology_Main_Colors3D_MSOBJ"
    
    //***********************************
    //* Window Button Actions           
    //***********************************
    string GECTechnology_Techview_Archlayers_PBOBJ         = "call !b050_GECTechnology_Techview_Archlayers_PBOBJ"
    string GECTechnology_Techview_Techstacks_PBOBJ         = "call !b060_GECTechnology_Techview_Techstacks_PBOBJ"
    string GECTechnology_Techview_View_PBOBJ               = "call !b100_GECTechnology_Techview_View_PBOBJ"
    string GECTechnology_Techview_Close_PBOBJ              = "call !b200_GECTechnology_Techview_Close_PBOBJ"
    string GECTechnology_Techview_Clear_PBOBJ              = "call !b210_GECTechnology_Techview_Clear_PBOBJ"
    string GECTechnology_Techview_Filter_PBOBJ             = "call !b300_GECTechnology_Techview_Filter_PBOBJ"
    string GECTechnology_Techview_Refresh_PBOBJ            = "call !b310_GECTechnology_Techview_Refresh_PBOBJ"
    string GECTechnology_Techview_Play_PBOBJ               = "call !b400_GECTechnology_Techview_Play_PBOBJ"
    string GECTechnology_Techview_Pause_PBOBJ              = "call !b410_GECTechnology_Techview_Pause_PBOBJ"
    string GECTechnology_Techview_Stop_PBOBJ               = "call !b420_GECTechnology_Techview_Stop_PBOBJ"
    string GECTechnology_Techview_Slow_PBOBJ               = "call !b430_GECTechnology_Techview_Slow_PBOBJ"
    string GECTechnology_Techview_Fast_PBOBJ               = "call !b440_GECTechnology_Techview_Fast_PBOBJ"
    string GECTechnology_Techview_Backward_PBOBJ           = "call !b450_GECTechnology_Techview_Backward_PBOBJ"
    string GECTechnology_Techview_Forward_PBOBJ            = "call !b460_GECTechnology_Techview_Forward_PBOBJ"

    string GECTechnology_Techview_Prev_PBOBJ               = "call !b465_GECTechnology_Techview_Prev_PBOBJ"
    string GECTechnology_Techview_Next_PBOBJ               = "call !b466_GECTechnology_Techview_Next_PBOBJ"

    string GECTechnology_Techview_Minus_PBOBJ              = "call !b470_GECTechnology_Techview_Minus_PBOBJ"
    string GECTechnology_Techview_Plus_PBOBJ               = "call !b475_GECTechnology_Techview_Plus_PBOBJ"

    string GECTechnology_Techview_Zoomin_PBOBJ             = "call !b490_GECTechnology_Techview_Zoomin_PBOBJ"
    string GECTechnology_Techview_Zoomout_PBOBJ            = "call !b491_GECTechnology_Techview_Zoomout_PBOBJ"
    string GECTechnology_Techview_Zoomup_PBOBJ             = "call !b495_GECTechnology_Techview_Zoomup_PBOBJ"
    string GECTechnology_Techview_Zoomdown_PBOBJ           = "call !b496_GECTechnology_Techview_Zoomdown_PBOBJ"
    string GECTechnology_Techview_Zoomleft_PBOBJ           = "call !b497_GECTechnology_Techview_Zoomleft_PBOBJ"
    string GECTechnology_Techview_Zoomright_PBOBJ          = "call !b498_GECTechnology_Techview_Zoomright_PBOBJ"

    string GECTechnology_Techview_Legend_PBOBJ             = "call !b499_GECTechnology_Techview_Legend_PBOBJ"
    string GECTechnology_Techview_Html_PBOBJ               = "call !b499_GECTechnology_Techview_Html_PBOBJ"

    string GECTechnology_Details_Add_PBOBJ                 = "call !b500_GECTechnology_Details_Add_PBOBJ"
    string GECTechnology_Details_Change_PBOBJ              = "call !b500_GECTechnology_Details_Change_PBOBJ"
    string GECTechnology_Details_Delete_PBOBJ              = "call !b500_GECTechnology_Details_Delete_PBOBJ"
    string GECTechnology_Details_Cancel_PBOBJ              = "call !b510_GECTechnology_Details_Cancel_PBOBJ"
    string GECTechnology_Details_Applications_PBOBJ        = "call !b520_GECTechnology_Details_Applications_PBOBJ"

    string GECTechnology_Details_Archlayers_PBOBJ          = "call !b530_GECTechnology_Details_Archlayers_PBOBJ"
    string GECTechnology_Details_Techstacks_PBOBJ          = "call !b540_GECTechnology_Details_Techstacks_PBOBJ"

    string GECTechnology_Details_Type_PBOBJ                = "call !b550_GECTechnology_Details_Type_PBOBJ"
    string GECTechnology_Details_Status_PBOBJ              = "call !b560_GECTechnology_Details_Status_PBOBJ"
    string GECTechnology_Details_Strategy_PBOBJ            = "call !b570_GECTechnology_Details_Strategy_PBOBJ"

    string GECTechnology_Applications_Add_PBOBJ            = "call !b600_GECTechnology_Applications_Add_PBOBJ"
    string GECTechnology_Applications_Delete_PBOBJ         = "call !b610_GECTechnology_Applications_Delete_PBOBJ"
    string GECTechnology_Applications_Ok_PBOBJ             = "call !b620_GECTechnology_Applications_Ok_PBOBJ"
    string GECTechnology_Applications_Cancel_PBOBJ         = "call !b630_GECTechnology_Applications_Cancel_PBOBJ"

    string GECTechnology_Legend_Close_PBOBJ                = "call !b700_GECTechnology_Legend_Close_PBOBJ"


    string GECTechnology_Multiselect_Multiselect_LBOBJ     = "call !b800_GECTechnology_Multiselect_Ok_PBOBJ"
    window action GECTechnology_Multiselect_Multiselect_LBOBJ

    string GECTechnology_Multiselect_Ok_PBOBJ              = "call !b800_GECTechnology_Multiselect_Ok_PBOBJ"
    string GECTechnology_Multiselect_Cancel_PBOBJ          = "call !b810_GECTechnology_Multiselect_Cancel_PBOBJ"
    
    //***********************************
    //* Field Edits                     
    //***********************************

    //string GECTechnology_Details_Watch_CBOBJ               = "call !z999_entryaction_return"
    //window action GECTechnology_Details_Watch_CBOBJ
    //window edit GECTechnology_Details_Watch_CBOBJ upper 1

    string GECTechnology_Details_Size_EFOBJ               = "call !z999_entryaction_return"
    window action GECTechnology_Details_Size_EFOBJ
    window edit GECTechnology_Details_Size_EFOBJ numeric 12

    string GECTechnology_Details_Maintenance_EFOBJ        = "call !z999_entryaction_return"
    window action GECTechnology_Details_Maintenance_EFOBJ
    window edit GECTechnology_Details_Maintenance_EFOBJ numeric 12

    string GECTechnology_Details_Support_EFOBJ            = "call !z999_entryaction_return"
    window action GECTechnology_Details_Support_EFOBJ
    window edit GECTechnology_Details_Support_EFOBJ numeric 12

    string GECTechnology_Details_Hits_EFOBJ               = "call !z999_entryaction_return"
    window action GECTechnology_Details_Hits_EFOBJ
    window edit GECTechnology_Details_Hits_EFOBJ numeric 12

    
//*********************************************************************
//* User Defined Global Variables
//*********************************************************************
!0001_User_Defined_Globals
    string FullLine
    string HoldLeft
    string HoldRight
    string Key
    string Type
    string Name
    string Description
    string Vendor
    string Version
    string Size
    float  fSize
    string Maintenance
    float  fMaintenance
    string Support
    float  fSupport
    string Hits
    float  fHits
    string Archlayers
    string Techstacks
    string Business
    string FullBusiness
    string FullProcess
    string Process
    string Status
    string Strategy
    string ChangeDate
    string Watch
    string Age
    int    AgeCCYY
    int    AgeDiff
    string Comments

    string sCurrCCYY
    int    CurrCCYY

    string SearchString
    string SearchType
    string SearchDesc
    string SearchFound

    int    Xsize
    int    Ysize
    int    Xstart
    int    Ystart
    int    Xend
    int    Yend
    int    Xmax
    int    Ymax
    int    ObjectCount
    int    Xtest
    int    Ytest
    string ObjectName
    string ObjectText
    string ObjectVersion
    int    Xfile
    int    Yfile
    int    SizeFile
    int    Xheight
    int    Yheight

    int     ObjectX
    int     ObjectY
    int     ObjectCX
    int     ObjectCY
    string  ObjectType

    string Newline
    int    BubbleX
    int    BubbleY
    int    BubbleCX
    int    BubbleCY

    string MacroCommand

    string AlreadyOpen

    string LastBubble
    string NewBubble
    string BubbleDesc

    string TestType
    string TestName
    string TestVersion

    string OK
    string Mode

    int    iTest
    string DisplayHistory = 'n'
    string Filename
    string Paused
    int    Speed = -1
    string FileDirection = 'Forward'

    string SizeParm

    string Userid = null

    string BusinessLoaded
    string Changed

    string NoMatchApplication

    int WatchXpos
    int WatchYpos   
    int WatchXsize
    int WatchYsize

    int StrategyXpos
    int StrategyYpos
    int StrategyCX
    int StrategyCY
    int StrategyXsize
    int StrategyYsize

    string ToolsColor
    string LanguagesColor
    string PlatformsColor

    string Working

    string StrategyLines
    int    StatusX
    int    StatusY

    string DrawDirection

    int    TestX
    int    TestY
    int    TestCX
    int    TestCY

    string Average
    float  fAverage

    int    iCountAssess
    float  iTotalAssess

    int    iCountTrial
    float  iTotalTrial

    int    iCountAdopt
    float  iTotalAdopt

    int    iCountHold
    float  iTotalHold

    int    iCountMoveOff
    float  iTotalMoveOff

    int    Yaxis

    string Displayby = 'Age'
    
    string FilterDesc

    string PlayStatus = 'n'

    int    DisplayX
    int    DisplayY

    int    LabelSize
    int    KeepLabelSize

    string DisplayStyle
    string Background

    float  StartRadius
    float  Radius
    float  StartAngle
    float  Angle
    float  OrigAngle
    float  EndAngle
    float  AddAngle = 37

    int    PlatformsAngle
    int    PlatformsStartAngle
    int    PlatformsEndAngle
    int    ToolsAngle
    int    ToolsStartAngle
    int    ToolsEndAngle
    int    LanguagesAngle
    int    LanguagesStartAngle
    int    LanguagesEndAngle

    float  PlatformsRadius
    int    PlatformsCount
    float  ToolsRadius
    int    ToolsCount
    float  LanguagesRadius
    int    LanguagesCount

    float  SinDistance
    float  CosineDistance

    string BallType

    float  TempWork

    string FirstTime = 'y'
    
    int    DrawLocRetry

    int    ListXpos
    int    ListYpos
    int    ListHeight
    int    ListBoxHeight
    int    ListXBoxPos
    int    ListCount
    int    ListStartCount
    int    ListHoldXsize
    string ListColor
    int    ListMax = 35
    int    ListPage
    int    ListCurrPage

    float  Zoom = 1
    float  Zoomdir
    int    ZoomTextSize
    int    iRingSize
    float  fRingSize
    int    ZoomX
    int    ZoomY
    int    ZoomTotalX
    int    ZoomTotalY

    string Colors3D = 'n'
    int    3Dpos
    int    3DXpos
    int    3DYpos

    int    MainX
    int    MainY
    int    MainCX
    int    MainCY
    int    WinX
    int    WinY
    string LogoLine

    int    NewX
    int    NewY
    int    DistX
    int    DistY
    float  Length
    float  Work1
    float  Work2
    float  PercX
    float  PercY

    string MultiselectWindow
    string MultiselectLabel
    string MultiselectType
    string MultiselectFilename
    string MultiselectData

    string Keepit
    string HTML_R
    string HTML_G
    string HTML_B
    int    HTML_work
    int    DetailHTMLCount
    string HTMLDetailsFilename
    string HTML_href
    string HTML_search
    string HTML_text

    //***********************************
    //* Progress Variables
    //***********************************
    int    Progx            error
    int    Progy            error
    int    Progcx           error
    int    Progcy           error
    float  Progress         error
    float  ProgressShow     error
    int    ProgressCount    error
    int    ProgressMax      error
    float  ProgressWork     error
    int    Progframex       error
    int    Progframey       error
    int    Progframecx      error
    int    Progframecy      error
    int    ProgTextX        error
    int    ProgTextY        error
    
//*********************************************************************
//* Main Processing
//*********************************************************************
!0005_Main_Processing
    open WindowFile GECTechnology.win
    open MenuFile GECTechnology.mnu
 
    //*************************
    //* Main Window Loop      
    //*************************
    window start noclose
    exit
 
//*********************************************************************
//* Special Actions
//*********************************************************************
!a010_Escape
    return
 
//******************************************
//* Default Window Processing
//******************************************
!a010_Default_Window_Processing
    return
 
//******************************************
//* Main Window Initialization Routine     
//******************************************
!a010_WindowInit
    window pointer wait
    window conceal GECTechnology_Login_Password_EFOBJ
    window hwnd GECTechnology_Login_WIN status error window open GECTechnology_Login_WIN shade
    window center GECTechnology_Login_WIN
    window clear GECTechnology_Login_WIN    
    window unshade GECTechnology_Login_WIN    
    window pointer arrow
    StrategyLines = 'N'
    DrawDirection = 'Across'
    LabelSize = 8
    KeepLabelSize = 8

    window check GECTechnology_Main_Banneron_MSOBJ

    //******************************************************
    //* Position the Logo Image
    //******************************************************
    MacroCommand = |window windowpos MAIN MainX MainY MainCX MainCY| $MacroCommand
    close PaintFile error
    open PaintFile null

    WinX = MainCX / 3 - 50
    WinY = MainCY / 7

    MacroCommand = "i:/MainWindow,BitmapFit,BitmapFit,@WinX@,@WinY@,100,0,GECTechGELogo.bmp/" 
    $MacroCommand
    LogoLine = line
    window paint MainWindow

    return

//******************************************
//* Login OK    
//******************************************
!a010_GECTechnology_Login_Ok_PBOBJ
    window obtain GECTechnology_Login_WIN
    crush GECTechnology_Login_Userid_EFOBJ
    if  (GECTechnology_Login_Userid_EFOBJ = null)
+       message = 'Please enter a userid'
+       window message warning ok
+       window setfocus GECTechnology_Login_Userid_EFOBJ
+       return
+   endif
    encrypt GECTechnology_Login_Password_EFOBJ
    open UseridPWFile GECTechnology.id error message = 'Unable to open GECTechnology.id' window message warning ok return
    fs:/@GECTechnology_Login_Userid_EFOBJ@/
    if  (eof)
+       message = 'Userid not found'
+       window message warning ok
+       window setfocus GECTechnology_Login_Userid_EFOBJ
+       close UseridPWFile
+       return
+   endif
    scan:/@line/:/$/
    if  (GECTechnology_Login_Password_EFOBJ != right)
+       message = 'Invalid Password'
+       window message warning ok
+       window setfocus GECTechnology_Login_Password_EFOBJ
+       close UseridPWFile
+       return
+   endif

    close UseridPWFile
    
    Userid = GECTechnology_Login_Userid_EFOBJ
    window close GECTechnology_Login_WIN
    call !a200_GECTechnology_Main_Colors1_MSOBJ
    return

//******************************************
//* Login Cancel
//******************************************
!a010_GECTechnology_Login_Cancel_PBOBJ
    window stop
    return

//******************************************
//* Login Cancel
//******************************************
!a010_GECTechnology_Login_Guest_PBOBJ
    window close GECTechnology_Login_WIN
    Userid = 'Guest'
    call !a200_GECTechnology_Main_Colors1_MSOBJ
    return
 
//******************************************
//* Main Window Wrapup Routine     
//******************************************
!a010_WindowWrap
    return
 
//******************************************
//* Mouse Button 1 Down    
//******************************************
!a010_WindowDown1
    if  (DisplayHistory) return
    //if  (Filename != 'GECTechnology.dat') return
    window deletecontrol Bubble error
    file ObjectsFile error return
    b
    do
        if-1 (!eof)
+           scan:/@line/:/|/
+           scan:/@right/:/|/
+           ObjectX = left
+           scan:/@right/:/|/
+           ObjectY = left
+           scan:/@right/:/|/
+           ObjectCX = left
+           scan:/@right/:/|/
+           ObjectCY = left
+           if-2  (Xpos >= ObjectX) and (Xpos <= ObjectCX) and (Ypos >= ObjectY) and (Ypos <= ObjectCY)
+               scan:/@right/:/|/
+               TestType = left
+               scan:/@right/:/|/       
+               TestName = left
+               TestVersion = right
+               Mode = 'Test'
+               call !a010_find_object
+               if-3  (OK)
+                    //*****************************
+                    //* Display existing technology
+                    //*****************************
+                   window pointer wait
+                   window hwnd GECTechnology_Details_WIN status error window open GECTechnology_Details_WIN shade
+                   Drag = 'n'
+                   window center GECTechnology_Details_WIN
+                   window clear GECTechnology_Details_WIN
+                   GECTechnology_Details_Type_EFOBJ = Type
+                   window modify GECTechnology_Details_Type_EFOBJ
+                   GECTechnology_Details_Name_EFOBJ = Name
+                   window modify GECTechnology_Details_Name_EFOBJ
+                   GECTechnology_Details_Description_MLOBJ = Description
+                   window modify GECTechnology_Details_Description_MLOBJ
+                   GECTechnology_Details_Version_EFOBJ = Version
+                   window modify GECTechnology_Details_Version_EFOBJ
+                   GECTechnology_Details_Vendor_EFOBJ = Vendor
+                   window modify GECTechnology_Details_Vendor_EFOBJ
+                   GECTechnology_Details_Size_EFOBJ = Size
+                   window modify GECTechnology_Details_Size_EFOBJ
+                   GECTechnology_Details_Maintenance_EFOBJ = Maintenance
+                   window modify GECTechnology_Details_Maintenance_EFOBJ
+                   GECTechnology_Details_Support_EFOBJ = Support
+                   window modify GECTechnology_Details_Support_EFOBJ
+                   GECTechnology_Details_Hits_EFOBJ = Hits
+                   window modify GECTechnology_Details_Hits_EFOBJ
+                   GECTechnology_Details_Process_EFOBJ = Process
+                   window modify GECTechnology_Details_Process_EFOBJ
+                   GECTechnology_Details_Archlayers_EFOBJ = Archlayers
+                   window modify GECTechnology_Details_Archlayers_EFOBJ
+                   GECTechnology_Details_Techstacks_EFOBJ = Techstacks
+                   window modify GECTechnology_Details_Techstacks_EFOBJ
+                   GECTechnology_Details_Business_EFOBJ = Business
+                   window modify GECTechnology_Details_Business_EFOBJ
+                   GECTechnology_Details_Status_EFOBJ = Status
+                   window modify GECTechnology_Details_Status_EFOBJ
+                   GECTechnology_Details_Strategy_EFOBJ = Strategy
+                   window modify GECTechnology_Details_Strategy_EFOBJ
+                   GECTechnology_Details_Changed_EFOBJ = ChangeDate
+                   window modify GECTechnology_Details_Changed_EFOBJ
+                   GECTechnology_Details_Originated_EFOBJ = Age
+                   window modify GECTechnology_Details_Originated_EFOBJ
+                   GECTechnology_Details_Watch_CBOBJ = Watch
+                   window modify GECTechnology_Details_Watch_CBOBJ
+                   GECTechnology_Details_Comments_MLOBJ = Comments
+                   window modify GECTechnology_Details_Comments_MLOBJ
+                   window unshade GECTechnology_Details_WIN
+                   window pointer arrow
+                   window setfocus GECTechnology_Details_WIN
+                   window setfocus GECTechnology_Details_Type_EFOBJ
+                   window disable GECTechnology_Details_Archlayers_EFOBJ
+                   window disable GECTechnology_Details_Techstacks_EFOBJ
+                   window disable GECTechnology_Details_Type_EFOBJ
+                   window disable GECTechnology_Details_Status_EFOBJ
+                   window disable GECTechnology_Details_Strategy_EFOBJ
+                   if-4 (Filename != 'GECTechnology.dat') or (Userid = 'Guest')
+                        window disable GECTechnology_Details_Add_PBOBJ
+                        window disable GECTechnology_Details_Change_PBOBJ
+                        window disable GECTechnology_Details_Delete_PBOBJ
+                        window disable GECTechnology_Details_Archlayers_PBOBJ
+                        window disable GECTechnology_Details_Techstacks_PBOBJ
+                        window disable GECTechnology_Details_Type_PBOBJ
+                        window disable GECTechnology_Details_Status_PBOBJ
+                        window disable GECTechnology_Details_Strategy_PBOBJ
+                        return
+                   else-4
+                        window enable GECTechnology_Details_Add_PBOBJ
+                        window enable GECTechnology_Details_Change_PBOBJ
+                        window enable GECTechnology_Details_Delete_PBOBJ
+                        window enable GECTechnology_Details_Archlayers_PBOBJ
+                        window enable GECTechnology_Details_Techstacks_PBOBJ
+                        window enable GECTechnology_Details_Type_PBOBJ
+                        window enable GECTechnology_Details_Status_PBOBJ
+                        window enable GECTechnology_Details_Strategy_PBOBJ
+                        return
+               else-3
+                   return
+       endif
        f;1
    until (eof)

    //*****************************
    //* Setup Drag
    //*****************************
    window obtain GECTechnology_Techview_Polar_RBOBJ
    if  (GECTechnology_Techview_Polar_RBOBJ)
+       if  (Zoom != 1.000000)
+          Drag = 'y'
+          window mousepos DragX DragY
+          return
+   endif

    //*****************************
    //* Blank screen for new technology
    //*****************************
    if (Filename = 'GECTechnology.dat') and (Userid != 'Guest')
+       window pointer wait
+       window hwnd GECTechnology_Details_WIN status error window open GECTechnology_Details_WIN shade
+       Drag = 'n'
+       window center GECTechnology_Details_WIN
+       window clear GECTechnology_Details_WIN
+       call !a010_status
+       window modify GECTechnology_Details_Status_EFOBJ
+       GECTechnology_Details_Changed_EFOBJ = '20@date[7-8]@/@date[1-2]@/@date[4-5]@'
+       window modify GECTechnology_Details_Changed_EFOBJ
+       GECTechnology_Details_Originated_EFOBJ = '20@date[7-8]@/@date[1-2]@/@date[4-5]@'
+       window modify GECTechnology_Details_Originated_EFOBJ
+       window disable GECTechnology_Details_Change_PBOBJ
+       window disable GECTechnology_Details_Delete_PBOBJ
+       window unshade GECTechnology_Details_WIN
+       window pointer arrow
+   endif

    return

//******************************************
//* Assign the Status based on mouse loc
//******************************************
!a010_status
    window obtain GECTechnology_Techview_XY_RBOBJ
    if  (!GECTechnology_Techview_XY_RBOBJ) 
+       GECTechnology_Details_Status_EFOBJ = null
+       return
+   endif
    GECTechnology_Details_Status_EFOBJ = 'Assess'
    if  (Xpos > 155) GECTechnology_Details_Status_EFOBJ = 'Trial'
    if  (Xpos > 315) GECTechnology_Details_Status_EFOBJ = 'Adopt'
    if  (Xpos > 905) GECTechnology_Details_Status_EFOBJ = 'Hold'
    if  (Xpos > 1165) GECTechnology_Details_Status_EFOBJ = 'Move Off'
    return

//******************************************
//* Locate the object    
//******************************************
!a010_find_object
    close DataFile error
    open DataFile @Filename
    do
        f;1
        if (!eof)
+           scan:/@line/:/|/
+           Key = left pack Key
+           scan:/@right/:/|/
+           Type = left pack Type
+           scan:/@right/:/|/
+           Name = left pack Name
+           scan:/@right/:/|/
+           Description = left pack Description
+           scan:/@right/:/|/
+           Vendor = left pack Vendor
+           scan:/@right/:/|/
+           Version = left pack Version
+           scan:/@right/:/|/
+           Archlayers = left pack Archlayers
+           scan:/@right/:/|/
+           Techstacks = left pack Techstacks
+           scan:/@right/:/|/
+           Size = left pack Size
+           scan:/@right/:/|/
+           Maintenance = left pack Maintenance
+           scan:/@right/:/|/
+           Support = left pack Support
+           scan:/@right/:/|/
+           Hits = left pack Hits
+           scan:/@right/:/|/
+           Process = left pack Process
+           scan:/@right/:/|/
+           Business = left pack Business
+           scan:/@right/:/|/
+           Status = left pack Status
+           scan:/@right/:/|/
+           Strategy = left pack Strategy
+           scan:/@right/:/|/
+           ChangeDate = left pack ChangeDate
+           scan:/@right/:/|/
+           Watch = left pack Watch
+           call !a010_fix_watch
+           scan:/@right/:/|/
+           Age = left
+           Comments = right
+           scan:/@Age/:'/'
+           AgeCCYY = left
+           if  (Type = TestType) and (Name = TestName) and (Version = TestVersion)
+               OK = 'y'
+               return
+       endif
    until (eof)
    if  (Mode = 'Test')
+       message = 'Unable to locate object' 
+       window message error ok
+   endif
    OK = 'n'
    return

!a010_fix_watch
    if  (Watch != 'Y') Watch = 'N'
    return
 
//******************************************
//* Mouse Button 1 Up      
//******************************************
!a010_WindowUp1
    if  (!MouseOK) return
    Drag = 'n'
    return
 
//******************************************
//* Mouse Button 2 Down    
//******************************************
!a010_WindowDown2
    if  (!MouseOK) return
    Drag = 'y'
    return
 
//******************************************
//* Mouse Button 2 Up      
//******************************************
!a010_WindowUp2
    if  (!MouseOK) return
    Drag = 'n'
    return
 
//******************************************
//* Mouse Movement 
//******************************************
!a010_WindowMouse
    if  (!Drag) 
+       window hwnd GECTechnology_Details_WIN status error call !a010_bubble
+       return
+   endif

    window hwnd GECTechnology_Details_WIN status error goto !a010_drag
    return

!a010_drag
    window obtain GECTechnology_Techview_Polar_RBOBJ
    if  (!GECTechnology_Techview_Polar_RBOBJ) return
    window mousepos Xpos Ypos
    ZoomX = Xpos - DragX
    ZoomTotalX += ZoomX

    ZoomY = Ypos - DragY  
    ZoomTotalY += ZoomY  

    if  (ZoomX != 0) or (ZoomY != 0)
+       call !b499_polar_shift
+   endif

    DragX = Xpos
    DragY = Ypos

    return

//******************************************
//* Show Bubble Tasks
//******************************************
!a010_bubble
    window mousepos Xpos Ypos
    if (Xpos = XposLast) and (Ypos = YposLast)
+      return
+   endif
    XposLast = Xpos
    YposLast = Ypos

    file ObjectsFile error return
    b
    do
        if-1 (!eof)
+           scan:/@line/:/|/
+           scan:/@right/:/|/
+           ObjectX = left
+           scan:/@right/:/|/
+           ObjectY = left
+           scan:/@right/:/|/
+           ObjectCX = left
+           scan:/@right/:/|/
+           ObjectCY = left
+           if-2  (Xpos >= ObjectX) and (Xpos <= ObjectCX) and (Ypos >= ObjectY) and (Ypos <= ObjectCY)
+               scan:/@right/:/|/
+               Type = left 
+               scan:/@right/:/|/      
+               Name = left
+               Version = right
+               NewBubble = "@ObjectX@@ObjectY@"
+               if-3  (NewBubble != LastBubble)
+                   window deletecontrol Bubble error
+                   call !a010_bubble_desc
+                   size BubbleDesc,99
+                   call !a010_bubble_x
+                   window createcontrol GECTechnology_Techview_WIN Bubble @Xpos @Ypos 300 20 STTXT1 @BubbleDesc
+                   LastBubble = NewBubble
+                   return
+               else-3
+                   call !a010_bubble_x
+                   window size Bubble @Xpos @Ypos 300 20 error
+                   window paint Bubble error
+                   return
+       endif
        f;1
    until (eof)
    window deletecontrol Bubble error
    LastBubble = null
    return

!a010_bubble_x
    if  (Xpos > 1050)
+       Xpos -= 300
+   else
+       Xpos += 12
+   endif

    if (Xpos < 1) Xpos = 1
    if (Ypos < 1) Ypos = 1
    return

//******************************************
//* Create the Bubble Description
//******************************************
!a010_bubble_desc
    if  (Version = null)
+       //BubbleDesc = "@Type@-@Name@"
+       BubbleDesc = "@Name@"
+   else
+       //BubbleDesc = "@Type@-@Name@ (v@Version@)"
+       BubbleDesc = "@Name@ (v@Version@)"
+   endif
    return
 
//*********************************************************************
//* Build Menu Actions
//*********************************************************************
//****************************************
//* Exit Processing
//****************************************
!a090_GECTechnology_Main_Exit_MSOBJ
    message = 'Are you sure?'
    window message question yesno
    if  (message)
+       window stop
+   endif
    return
 
//****************************************
//* Banner On
//****************************************
!a090_GECTechnology_Main_Banneron_MSOBJ
    BannerLine1 = Ban1
    BannerLine2 = Ban2
    BannerLine3 = Ban3
    window paint MainWindow
    window check GECTechnology_Main_Banneron_MSOBJ
    window uncheck GECTechnology_Main_Banneroff_MSOBJ
    return
 
//****************************************
//* Banner Off
//****************************************
!a090_GECTechnology_Main_Banneroff_MSOBJ
    BannerLine1 = null
    BannerLine2 = null
    BannerLine3 = null
    window paint MainWindow
    window uncheck GECTechnology_Main_Banneron_MSOBJ
    window check GECTechnology_Main_Banneroff_MSOBJ
    return
 
//****************************************
//* About Processing
//****************************************
!a095_GECTechnology_Main_About_MSOBJ 
    message = ^This system will visually display GEC technology that's in use.^
    window message info OK
    return

//******************************************
//* Timer Module                           *
//******************************************
!a100_WindowTimer
    if (Working) return
    Working = 'y'
    if-1  (Filename != 'GECTechnology.dat')
+       file HistoryFile
+       Filename = line
+       if-2  (FileDirection = 'Forward')
+           f;1
+           if-3  (eof)
+               b
+               f;1
+       else-2
+           b;1
+           if-4  (line = 'GECTechnology.dat') // Top of File
+               f;*
+   endif
    call !v100_view
    Working = 'n'
    return
 
//****************************************
//* GECTechnology_Techview_MSOBJ Processing
//****************************************
!a100_GECTechnology_Techview_MSOBJ
    if  (Userid = null) return
    window pointer wait
    window hwnd GECTechnology_Techview_WIN status error window open GECTechnology_Techview_WIN shade
    window center GECTechnology_Techview_WIN
    ZoomTotalX = 0
    ZoomTotalY = 0
    Zoom = 1
    LabelSize = 8
    KeepLabelSize = 8
    GECTechnology_Techview_Labelsize_EFOBJ = LabelSize
    window modify GECTechnology_Techview_Labelsize_EFOBJ

    if  (!FirstTime)
+       goto !a100_bypass_setup
+   endif
    FirstTime = 'n'
    window disable GECTechnology_Techview_Zoomout_PBOBJ
    window clear GECTechnology_Techview_WIN

    ListPage = 1
    ListCurrPage = 1
    if  (Displayby = 'Age')
+       GECTechnology_Techview_Age_RBOBJ = 'Y'
+       window modify GECTechnology_Techview_Age_RBOBJ
+       GECTechnology_Techview_Size_RBOBJ = 'N'
+       window modify GECTechnology_Techview_Size_RBOBJ
+   else
+       GECTechnology_Techview_Age_RBOBJ = 'N'
+       window modify GECTechnology_Techview_Age_RBOBJ
+       GECTechnology_Techview_Size_RBOBJ = 'Y'
+       window modify GECTechnology_Techview_Size_RBOBJ
+   endif

    GECTechnology_Techview_Labels_CBOBJ = 'Y'
    window modify GECTechnology_Techview_Labels_CBOBJ

    GECTechnology_Techview_Background_CBOBJ = 'Y'
    window modify GECTechnology_Techview_Background_CBOBJ
    Background = 'y'

    GECTechnology_Techview_Strategylines_CBOBJ = 'Y'
    window modify GECTechnology_Techview_Strategylines_CBOBJ
    StrategyLines = 'Y'

    GECTechnology_Techview_Average_CBOBJ = 'Y'
    window modify GECTechnology_Techview_Average_CBOBJ
    Average = 'Y'

    GECTechnology_Techview_Lines_RBOBJ = 'Y'
    window modify GECTechnology_Techview_Lines_RBOBJ

    GECTechnology_Techview_Across_RBOBJ = 'Y'
    window modify GECTechnology_Techview_Across_RBOBJ

    GECTechnology_Techview_Polar_RBOBJ = 'Y'
    window modify GECTechnology_Techview_Polar_RBOBJ
    DisplayStyle = 'Polar'
    //GECTechnology_Techview_List_RBOBJ = 'Y'
    //window modify GECTechnology_Techview_List_RBOBJ
    //DisplayStyle = 'List'

    window disable GECTechnology_Techview_Labelsize_EFOBJ
    GECTechnology_Techview_Labelsize_EFOBJ = LabelSize
    window modify GECTechnology_Techview_Labelsize_EFOBJ

    window hide GECTechnology_Techview_Filter_GBOBJ
    window hide GECTechnology_Techview_Type_STTXT
    window hide GECTechnology_Techview_Name_STTXT
    window hide GECTechnology_Techview_Vendor_STTXT
    window hide GECTechnology_Techview_Version_STTXT
    window hide GECTechnology_Techview_Process_STTXT
    window hide GECTechnology_Techview_Business_STTXT
    window hide GECTechnology_Techview_Application_STTXT
    window hide GECTechnology_Techview_Status_STTXT
    window hide GECTechnology_Techview_Strategy_STTXT
    window hide GECTechnology_Techview_Description_STTXT
    window hide GECTechnology_Techview_Update_STTXT
    window hide GECTechnology_Techview_Type_COOBJ
    window hide GECTechnology_Techview_Name_COOBJ
    window hide GECTechnology_Techview_Vendor_COOBJ
    window hide GECTechnology_Techview_Version_COOBJ
    window hide GECTechnology_Techview_Process_COOBJ
    window hide GECTechnology_Techview_Business_COOBJ
    window hide GECTechnology_Techview_Application_COOBJ
    window hide GECTechnology_Techview_Status_COOBJ
    window hide GECTechnology_Techview_Strategy_COOBJ
    window hide GECTechnology_Techview_Description_EFOBJ
    window hide GECTechnology_Techview_Update_EFOBJ
    window hide GECTechnology_Techview_Followup_CBOBJ
    window hide GECTechnology_Techview_View_PBOBJ
    window hide GECTechnology_Techview_Archlayers_PBOBJ
    window hide GECTechnology_Techview_Techstacks_PBOBJ
    window hide GECTechnology_Techview_Archlayers_EFOBJ
    window hide GECTechnology_Techview_Techstacks_EFOBJ

    window show GECTechnology_Techview_XAxis_PBOBJ
    window show GECTechnology_Techview_YAxis_PBOBJ
    window show GECTechnology_Techview_Separator1_STTXT
    window show GECTechnology_Techview_Separator2_STTXT
    window show GECTechnology_Techview_Separator3_STTXT
    window show GECTechnology_Techview_Separator4_STTXT
    window show GECTechnology_Techview_Adopt_STTXT
    window show GECTechnology_Techview_Trial_STTXT
    window show GECTechnology_Techview_Assess_STTXT
    window show GECTechnology_Techview_Hold_STTXT
    window show GECTechnology_Techview_MoveOff_STTXT
    window show GECTechnology_Techview_Age1_STTXT
    window show GECTechnology_Techview_Age2_STTXT
    window show GECTechnology_Techview_Age3_STTXT

    window show GECTechnology_Techview_Filter_PBOBJ
    window show GECTechnology_Techview_Close_PBOBJ
    window show GECTechnology_Techview_Refresh_PBOBJ
    window hide GECTechnology_Techview_Clear_PBOBJ

    window enable GECTechnology_Techview_Play_PBOBJ
    window disable GECTechnology_Techview_Pause_PBOBJ
    window disable GECTechnology_Techview_Stop_PBOBJ
    window disable GECTechnology_Techview_Slow_PBOBJ
    window disable GECTechnology_Techview_Fast_PBOBJ

    window timer off

    SizeParm = 'Lines'

!a100_bypass_setup
    window enable GECTechnology_Techview_Filter_PBOBJ
    window enable GECTechnology_Techview_Close_PBOBJ

    Filename = 'GECTechnology.dat'
    call !v100_view

    window unshade GECTechnology_Techview_WIN
    window pointer arrow
    return

//****************************************
//* Export GECTechnology.dat to Excel
//****************************************
!a110_GECTechnology_Export_MSOBJ
    if  (Userid = null) return
    window pointer wait
    MacroCommand = 'open ExportCSV @Filename@'
    $MacroCommand
    b
    do-1
        Newline = line
        do-2
            //*********************
            //* Remove commas
            //*********************
            scan:/@Newline/:/,/
            if  (found)
+               Newline = '@left@;@right@'
+           endif
        until-2 (!found)
        do-3
            //*********************
            //* Change '|' to ','
            //*********************
            scan:/@Newline/:/|/
            if  (found)
+               Newline = '@left@,@right@'
+           endif
        until-3 (!found)
        r:/@Newline/
        f;1
    until-1 (eof)
!a110_write_loop
    write ExportCSV GECTechnology.csv error message = 'Unable to write to GECTechnology.csv, is the file already open?' window message question yesno if (message) goto !a110_write_loop else close ExportCSV window pointer arrow return

    close ExportCSV
    system:"start GECTechnology.csv"
    window pointer arrow
    return

//****************************************
//* Color Scheme 1 (Default)
//****************************************
!a200_GECTechnology_Main_Colors1_MSOBJ
    Colors3D = 'n'
    LanguagesColor = '100,255,100'
    ToolsColor = '255,100,100' 
    PlatformsColor = '100,100,255'
    call !a100_GECTechnology_Techview_MSOBJ
    window check GECTechnology_Main_Colors1_MSOBJ
    window uncheck GECTechnology_Main_Colors2_MSOBJ
    window uncheck GECTechnology_Main_Colors3_MSOBJ
    window uncheck GECTechnology_Main_Colors4_MSOBJ
    window uncheck GECTechnology_Main_Colors5_MSOBJ
    window uncheck GECTechnology_Main_Colors6_MSOBJ
    window uncheck GECTechnology_Main_Colors7_MSOBJ
    window uncheck GECTechnology_Main_Colors8_MSOBJ
    window uncheck GECTechnology_Main_Colors9_MSOBJ
    window uncheck GECTechnology_Main_Colors3D_MSOBJ
    return

//****************************************
//* Color Scheme 2 (Bold)
//****************************************
!a210_GECTechnology_Main_Colors2_MSOBJ
    Colors3D = 'n'
    LanguagesColor = '0,255,0'
    ToolsColor = '255,0,0' 
    PlatformsColor = '0,0,255'
    call !a100_GECTechnology_Techview_MSOBJ
    window uncheck GECTechnology_Main_Colors1_MSOBJ
    window check GECTechnology_Main_Colors2_MSOBJ
    window uncheck GECTechnology_Main_Colors3_MSOBJ
    window uncheck GECTechnology_Main_Colors4_MSOBJ
    window uncheck GECTechnology_Main_Colors5_MSOBJ
    window uncheck GECTechnology_Main_Colors6_MSOBJ
    window uncheck GECTechnology_Main_Colors7_MSOBJ
    window uncheck GECTechnology_Main_Colors8_MSOBJ
    window uncheck GECTechnology_Main_Colors9_MSOBJ
    window uncheck GECTechnology_Main_Colors3D_MSOBJ
    return

//****************************************
//* Color Scheme 3 (GE)
//****************************************
!a220_GECTechnology_Main_Colors3_MSOBJ
    Colors3D = 'n'
    LanguagesColor = '0,170,80'
    ToolsColor = '30,65,145' 
    PlatformsColor = '238,51,36'
    call !a100_GECTechnology_Techview_MSOBJ
    window uncheck GECTechnology_Main_Colors1_MSOBJ
    window uncheck GECTechnology_Main_Colors2_MSOBJ
    window check GECTechnology_Main_Colors3_MSOBJ
    window uncheck GECTechnology_Main_Colors4_MSOBJ
    window uncheck GECTechnology_Main_Colors5_MSOBJ
    window uncheck GECTechnology_Main_Colors6_MSOBJ
    window uncheck GECTechnology_Main_Colors7_MSOBJ
    window uncheck GECTechnology_Main_Colors8_MSOBJ
    window uncheck GECTechnology_Main_Colors9_MSOBJ
    window uncheck GECTechnology_Main_Colors3D_MSOBJ
    return

//****************************************
//* Color Scheme 4 (B&W)
//****************************************
!a230_GECTechnology_Main_Colors4_MSOBJ
    Colors3D = 'n'
    LanguagesColor = '240,240,240'
    ToolsColor = '175,175,175' 
    PlatformsColor = '100,100,100'
    call !a100_GECTechnology_Techview_MSOBJ
    window uncheck GECTechnology_Main_Colors1_MSOBJ
    window uncheck GECTechnology_Main_Colors2_MSOBJ
    window uncheck GECTechnology_Main_Colors3_MSOBJ
    window check GECTechnology_Main_Colors4_MSOBJ
    window uncheck GECTechnology_Main_Colors5_MSOBJ
    window uncheck GECTechnology_Main_Colors6_MSOBJ
    window uncheck GECTechnology_Main_Colors7_MSOBJ
    window uncheck GECTechnology_Main_Colors8_MSOBJ
    window uncheck GECTechnology_Main_Colors9_MSOBJ
    window uncheck GECTechnology_Main_Colors3D_MSOBJ
    return

//****************************************
//* Color Scheme 5 (Pastel)
//****************************************
!a240_GECTechnology_Main_Colors5_MSOBJ
    Colors3D = 'n'
    LanguagesColor = '241,255,113'
    ToolsColor = '235,133,235' 
    PlatformsColor = '168,250,178'
    call !a100_GECTechnology_Techview_MSOBJ
    window uncheck GECTechnology_Main_Colors1_MSOBJ
    window uncheck GECTechnology_Main_Colors2_MSOBJ
    window uncheck GECTechnology_Main_Colors3_MSOBJ
    window uncheck GECTechnology_Main_Colors4_MSOBJ
    window check GECTechnology_Main_Colors5_MSOBJ
    window uncheck GECTechnology_Main_Colors6_MSOBJ
    window uncheck GECTechnology_Main_Colors7_MSOBJ
    window uncheck GECTechnology_Main_Colors8_MSOBJ
    window uncheck GECTechnology_Main_Colors9_MSOBJ
    window uncheck GECTechnology_Main_Colors3D_MSOBJ
    return

//****************************************
//* Color Scheme 6 (Brown)
//****************************************
!a250_GECTechnology_Main_Colors6_MSOBJ
    Colors3D = 'n'
    LanguagesColor = '229,199,169'
    ToolsColor = '205,148,91'
    PlatformsColor = '141,92,43'
    call !a100_GECTechnology_Techview_MSOBJ
    window uncheck GECTechnology_Main_Colors1_MSOBJ
    window uncheck GECTechnology_Main_Colors2_MSOBJ
    window uncheck GECTechnology_Main_Colors3_MSOBJ
    window uncheck GECTechnology_Main_Colors4_MSOBJ
    window uncheck GECTechnology_Main_Colors5_MSOBJ
    window check GECTechnology_Main_Colors6_MSOBJ
    window uncheck GECTechnology_Main_Colors7_MSOBJ
    window uncheck GECTechnology_Main_Colors8_MSOBJ
    window uncheck GECTechnology_Main_Colors9_MSOBJ
    window uncheck GECTechnology_Main_Colors3D_MSOBJ
    return

//****************************************
//* Color Scheme 7 (Blue)
//****************************************
!a260_GECTechnology_Main_Colors7_MSOBJ
    Colors3D = 'n'
    LanguagesColor = '163,230,251'
    ToolsColor = '152,134,226'
    PlatformsColor = '9,61,209'
    call !a100_GECTechnology_Techview_MSOBJ
    window uncheck GECTechnology_Main_Colors1_MSOBJ
    window uncheck GECTechnology_Main_Colors2_MSOBJ
    window uncheck GECTechnology_Main_Colors3_MSOBJ
    window uncheck GECTechnology_Main_Colors4_MSOBJ
    window uncheck GECTechnology_Main_Colors5_MSOBJ
    window uncheck GECTechnology_Main_Colors6_MSOBJ
    window check GECTechnology_Main_Colors7_MSOBJ
    window uncheck GECTechnology_Main_Colors8_MSOBJ
    window uncheck GECTechnology_Main_Colors9_MSOBJ
    window uncheck GECTechnology_Main_Colors3D_MSOBJ
    return

//****************************************
//* Color Scheme 8 (Green)
//****************************************
!a270_GECTechnology_Main_Colors8_MSOBJ
    Colors3D = 'n'
    LanguagesColor = '192,255,183'
    ToolsColor = '0,234,45'
    PlatformsColor = '15,130,0'
    call !a100_GECTechnology_Techview_MSOBJ
    window uncheck GECTechnology_Main_Colors1_MSOBJ
    window uncheck GECTechnology_Main_Colors2_MSOBJ
    window uncheck GECTechnology_Main_Colors3_MSOBJ
    window uncheck GECTechnology_Main_Colors4_MSOBJ
    window uncheck GECTechnology_Main_Colors5_MSOBJ
    window uncheck GECTechnology_Main_Colors6_MSOBJ
    window uncheck GECTechnology_Main_Colors7_MSOBJ
    window check GECTechnology_Main_Colors8_MSOBJ
    window uncheck GECTechnology_Main_Colors9_MSOBJ
    window uncheck GECTechnology_Main_Colors3D_MSOBJ
    return

//****************************************
//* Color Scheme 9 (Red)
//****************************************
!a280_GECTechnology_Main_Colors9_MSOBJ
    Colors3D = 'n'
    LanguagesColor = '254,186,186'
    ToolsColor = '253,65,65'
    PlatformsColor = '187,1,1'
    call !a100_GECTechnology_Techview_MSOBJ
    window uncheck GECTechnology_Main_Colors1_MSOBJ
    window uncheck GECTechnology_Main_Colors2_MSOBJ
    window uncheck GECTechnology_Main_Colors3_MSOBJ
    window uncheck GECTechnology_Main_Colors4_MSOBJ
    window uncheck GECTechnology_Main_Colors5_MSOBJ
    window uncheck GECTechnology_Main_Colors6_MSOBJ
    window uncheck GECTechnology_Main_Colors7_MSOBJ
    window uncheck GECTechnology_Main_Colors8_MSOBJ
    window check GECTechnology_Main_Colors9_MSOBJ
    window uncheck GECTechnology_Main_Colors3D_MSOBJ
    return

//****************************************
//* Color Scheme 3D
//****************************************
!a290_GECTechnology_Main_Colors3D_MSOBJ
    Colors3D = 'y'
    LanguagesColor = '0,255,0'
    ToolsColor = '255,0,0'
    PlatformsColor = '0,0,255'
    call !a100_GECTechnology_Techview_MSOBJ
    window uncheck GECTechnology_Main_Colors1_MSOBJ
    window uncheck GECTechnology_Main_Colors2_MSOBJ
    window uncheck GECTechnology_Main_Colors3_MSOBJ
    window uncheck GECTechnology_Main_Colors4_MSOBJ
    window uncheck GECTechnology_Main_Colors5_MSOBJ
    window uncheck GECTechnology_Main_Colors6_MSOBJ
    window uncheck GECTechnology_Main_Colors7_MSOBJ
    window uncheck GECTechnology_Main_Colors8_MSOBJ
    window uncheck GECTechnology_Main_Colors9_MSOBJ
    window check GECTechnology_Main_Colors3D_MSOBJ
    return
 
//*********************************************************************
//* Build Window Button Actions
//*********************************************************************

//****************************************
//* GECTechnology_Techview_Archlayers_PBOBJ Processing
//****************************************
!b050_GECTechnology_Techview_Archlayers_PBOBJ
    MultiselectWindow = 'Techview'
    MultiselectLabel = 'Architecture Layers'
    MultiselectType = 'Archlayers'
    call !m100_open_multiselect
    return

//****************************************
//* GECTechnology_Techview_Techstacks_PBOBJ Processing
//****************************************
!b060_GECTechnology_Techview_Techstacks_PBOBJ
    MultiselectWindow = 'Techview'
    MultiselectLabel = 'Tech Stacks'
    MultiselectType = 'Techstacks'
    call !m100_open_multiselect
    return
 
//****************************************
//* GECTechnology_Techview_View_PBOBJ Processing
//****************************************
!b100_GECTechnology_Techview_View_PBOBJ
    window obtain GECTechnology_Techview_WIN

    //**********************************
    //* Validate the Update Date
    //**********************************
    pack GECTechnology_Techview_Update_EFOBJ
    if  (GECTechnology_Techview_Update_EFOBJ = null)
+       goto !b100_edits_done
+   endif
    split:/@GECTechnology_Techview_Update_EFOBJ@/;4
    iTest = left
    if  (iTest < 1900) or (iTest > 2100)
+      message = "Invalid Year, must be > 1900 and < 2100"
+      window message warning ok
+      window setfocus GECTechnology_Techview_Update_EFOBJ
+      return
+   endif      
    split:/@right/;1
    if (left != '/')
+      message = "Invalid date separator 1, must be '/'"
+      window message warning ok
+      window setfocus GECTechnology_Techview_Update_EFOBJ
+      return
+   endif
    split:/@right/;2
    iTest = left
    if  (iTest < 1) or (iTest > 12)
+      message = "Invalid Month"
+      window message warning ok
+      window setfocus GECTechnology_Techview_Update_EFOBJ
+      return
+   endif  
    split:/@right/;1
    if (left != '/')
+      message = "Invalid date separator 2, must be '/'"
+      window message warning ok
+      window setfocus GECTechnology_Techview_Update_EFOBJ
+      return
+   endif
    split:/@right/;2
    iTest = left
    if  (iTest < 1) or (iTest > 31)
+      message = "Invalid Day"
+      window message warning ok
+      window setfocus GECTechnology_Techview_Update_EFOBJ
+      return
+   endif
    if (right != null)
+      message = "Invalid Date, remaining characters"
+      window message warning ok
+      window setfocus GECTechnology_Techview_Update_EFOBJ
+      return
+   endif    

!b100_edits_done
    window hide GECTechnology_Techview_Filter_GBOBJ
    window hide GECTechnology_Techview_Type_STTXT
    window hide GECTechnology_Techview_Name_STTXT
    window hide GECTechnology_Techview_Vendor_STTXT
    window hide GECTechnology_Techview_Version_STTXT
    window hide GECTechnology_Techview_Process_STTXT
    window hide GECTechnology_Techview_Business_STTXT
    window hide GECTechnology_Techview_Application_STTXT
    window hide GECTechnology_Techview_Status_STTXT
    window hide GECTechnology_Techview_Strategy_STTXT
    window hide GECTechnology_Techview_Description_STTXT
    window hide GECTechnology_Techview_Update_STTXT
    window hide GECTechnology_Techview_Type_COOBJ
    window hide GECTechnology_Techview_Name_COOBJ
    window hide GECTechnology_Techview_Vendor_COOBJ
    window hide GECTechnology_Techview_Version_COOBJ
    window hide GECTechnology_Techview_Process_COOBJ
    window hide GECTechnology_Techview_Business_COOBJ
    window hide GECTechnology_Techview_Application_COOBJ
    window hide GECTechnology_Techview_Status_COOBJ
    window hide GECTechnology_Techview_Strategy_COOBJ
    window hide GECTechnology_Techview_Description_EFOBJ
    window hide GECTechnology_Techview_Update_EFOBJ
    window hide GECTechnology_Techview_Followup_CBOBJ
    window hide GECTechnology_Techview_View_PBOBJ
    window hide GECTechnology_Techview_Archlayers_PBOBJ
    window hide GECTechnology_Techview_Techstacks_PBOBJ
    window hide GECTechnology_Techview_Archlayers_EFOBJ
    window hide GECTechnology_Techview_Techstacks_EFOBJ

    window show GECTechnology_Techview_XAxis_PBOBJ
    window show GECTechnology_Techview_YAxis_PBOBJ
    window show GECTechnology_Techview_Separator1_STTXT
    window show GECTechnology_Techview_Separator2_STTXT
    window show GECTechnology_Techview_Separator3_STTXT
    window show GECTechnology_Techview_Separator4_STTXT
    window show GECTechnology_Techview_Adopt_STTXT
    window show GECTechnology_Techview_Trial_STTXT
    window show GECTechnology_Techview_Assess_STTXT
    window show GECTechnology_Techview_Hold_STTXT
    window show GECTechnology_Techview_MoveOff_STTXT
    window show GECTechnology_Techview_Age1_STTXT
    window show GECTechnology_Techview_Age2_STTXT
    window show GECTechnology_Techview_Age3_STTXT

    window show GECTechnology_Techview_Close_PBOBJ
    window show GECTechnology_Techview_Refresh_PBOBJ
    window hide GECTechnology_Techview_Clear_PBOBJ

    window show GECTechnology_Techview_History_GBOBJ
    window show GECTechnology_Techview_History_GBOBJ
    window show GECTechnology_Techview_Play_PBOBJ
    window show GECTechnology_Techview_Pause_PBOBJ
    window show GECTechnology_Techview_Stop_PBOBJ
    window show GECTechnology_Techview_Slow_PBOBJ
    window show GECTechnology_Techview_Fast_PBOBJ
    window show GECTechnology_Techview_Backward_PBOBJ
    window show GECTechnology_Techview_Forward_PBOBJ

    window show GECTechnology_Techview_Filter_PBOBJ

    window timer off

    if  (Displayby = 'Age')
+       GECTechnology_Techview_Age_RBOBJ = 'Y'
+       window modify GECTechnology_Techview_Age_RBOBJ
+       GECTechnology_Techview_Size_RBOBJ = 'N'
+       window modify GECTechnology_Techview_Size_RBOBJ
+   else
+       GECTechnology_Techview_Age_RBOBJ = 'N'
+       window modify GECTechnology_Techview_Age_RBOBJ
+       GECTechnology_Techview_Size_RBOBJ = 'Y'
+       window modify GECTechnology_Techview_Size_RBOBJ
+   endif

    FilterDesc = 'Filtered by '
    if  (GECTechnology_Techview_Type_COOBJ != null) and (GECTechnology_Techview_Type_COOBJ != 'ALL')
+       FilterDesc = '@FilterDesc@ Type=@GECTechnology_Techview_Type_COOBJ@'
+   endif
    if-1  (GECTechnology_Techview_Name_COOBJ != null) and (GECTechnology_Techview_Name_COOBJ != 'ALL')
+       if-2  (FilterDesc = 'Filtered by ')
+           FilterDesc = '@FilterDesc@ Name=@GECTechnology_Techview_Name_COOBJ@'
+       else-2
+           FilterDesc = '@FilterDesc@ and Name=@GECTechnology_Techview_Name_COOBJ@'
+   endif
    if-1  (GECTechnology_Techview_Vendor_COOBJ != null) and (GECTechnology_Techview_Vendor_COOBJ != 'ALL')
+       if-2  (FilterDesc = 'Filtered by ')
+           FilterDesc = '@FilterDesc@ Vendor=@GECTechnology_Techview_Vendor_COOBJ@'
+       else-2
+           FilterDesc = '@FilterDesc@ and Vendor=@GECTechnology_Techview_Vendor_COOBJ@'
+   endif
    if-1  (GECTechnology_Techview_Version_COOBJ != null) and (GECTechnology_Techview_Version_COOBJ != 'ALL')
+       if-2  (FilterDesc = 'Filtered by ')
+           FilterDesc = '@FilterDesc@ Version=@GECTechnology_Techview_Version_COOBJ@'
+       else-2
+           FilterDesc = '@FilterDesc@ and Version=@GECTechnology_Techview_Version_COOBJ@'
+   endif
    if-1  (GECTechnology_Techview_Archlayers_EFOBJ != null)
+       if-2  (FilterDesc = 'Filtered by ')
+           FilterDesc = '@FilterDesc@ Arch Layers=@GECTechnology_Techview_Archlayers_EFOBJ@'
+       else-2
+           FilterDesc = '@FilterDesc@ and Arch Layers=@GECTechnology_Techview_Archlayers_EFOBJ@'
+   endif
    if-1  (GECTechnology_Techview_Techstacks_EFOBJ != null)
+       if-2  (FilterDesc = 'Filtered by ')
+           FilterDesc = '@FilterDesc@ Tech Stacks=@GECTechnology_Techview_Techstacks_EFOBJ@'
+       else-2
+           FilterDesc = '@FilterDesc@ and Tech Stacks=@GECTechnology_Techview_Techstacks_EFOBJ@'
+   endif
    if-1  (GECTechnology_Techview_Process_COOBJ != null) and (GECTechnology_Techview_Process_COOBJ != 'ALL')
+       if-2  (FilterDesc = 'Filtered by ')
+           FilterDesc = '@FilterDesc@ Processess=@GECTechnology_Techview_Process_COOBJ@'
+       else-2
+           FilterDesc = '@FilterDesc@ and Processess=@GECTechnology_Techview_Process_COOBJ@'
+   endif
    if-1  (GECTechnology_Techview_Business_COOBJ != null) and (GECTechnology_Techview_Business_COOBJ != 'ALL')
+       if-2  (FilterDesc = 'Filtered by ')
+           FilterDesc = '@FilterDesc@ Business=@GECTechnology_Techview_Business_COOBJ@'
+       else-2
+           FilterDesc = '@FilterDesc@ and Business=@GECTechnology_Techview_Business_COOBJ@'
+   endif
    if-1  (GECTechnology_Techview_Application_COOBJ != null) and (GECTechnology_Techview_Application_COOBJ != 'ALL')
+       if-2  (FilterDesc = 'Filtered by ')
+           FilterDesc = '@FilterDesc@ Application=@GECTechnology_Techview_Application_COOBJ@'
+       else-2
+           FilterDesc = '@FilterDesc@ and Application=@GECTechnology_Techview_Application_COOBJ@'
+   endif
    if-1  (GECTechnology_Techview_Status_COOBJ != null) and (GECTechnology_Techview_Status_COOBJ != 'ALL')
+       if-2  (FilterDesc = 'Filtered by ')
+           FilterDesc = '@FilterDesc@ Status=@GECTechnology_Techview_Status_COOBJ@'
+       else-2
+           FilterDesc = '@FilterDesc@ and Status=@GECTechnology_Techview_Status_COOBJ@'
+   endif
    if-1  (GECTechnology_Techview_Strategy_COOBJ != null) and (GECTechnology_Techview_Strategy_COOBJ != 'ALL')
+       if-2  (FilterDesc = 'Filtered by ') 
+           FilterDesc = '@FilterDesc@ Strategy=@GECTechnology_Techview_Strategy_COOBJ@'
+       else-2
+           FilterDesc = '@FilterDesc@ and Strategy=@GECTechnology_Techview_Strategy_COOBJ@'
+   endif
    if-1  (GECTechnology_Techview_Description_EFOBJ != null) and (GECTechnology_Techview_Description_EFOBJ != 'ALL')
+       if-2  (FilterDesc = 'Filtered by ') 
+           FilterDesc = '@FilterDesc@ Search For=@GECTechnology_Techview_Description_EFOBJ@'
+       else-2
+           FilterDesc = '@FilterDesc@ and Search For=@GECTechnology_Techview_Description_EFOBJ@'
+   endif
    if-1  (GECTechnology_Techview_Update_EFOBJ != null) and (GECTechnology_Techview_Update_EFOBJ != 'ALL')
+       if-2  (FilterDesc = 'Filtered by ') 
+           FilterDesc = '@FilterDesc@ Update=@GECTechnology_Techview_Update_EFOBJ@'
+       else-2
+           FilterDesc = '@FilterDesc@ and Update=@GECTechnology_Techview_Update_EFOBJ@'
+   endif
    if-1  (GECTechnology_Techview_Followup_CBOBJ)
+       if-2  (FilterDesc = 'Filtered by ') 
+           FilterDesc = '@FilterDesc@ Follow-Up'
+       else-2
+           FilterDesc = '@FilterDesc@ and Follow-Up'
+   endif

    if  (FilterDesc = 'Filtered by ')
+       FilterDesc = null
+   endif

    call !v100_view

    return
 
//****************************************
//* GECTechnology_Techview_Close_PBOBJ Processing
//****************************************
!b200_GECTechnology_Techview_Close_PBOBJ
    window close GECTechnology_Techview_WIN
    window close GECTechnology_Details_WIN error
    Drag = 'n'

    FilterDesc = null

    window timer off

    return

//****************************************
//* GECTechnology_Techview_Clear_PBOBJ Processing
//****************************************
!b210_GECTechnology_Techview_Clear_PBOBJ
    window close GECTechnology_Details_WIN error
    Drag = 'n'
    window timer off
    window clear GECTechnology_Techview_WIN
    if  (Displayby = 'Age')
+       GECTechnology_Techview_Age_RBOBJ = 'Y'
+       window modify GECTechnology_Techview_Age_RBOBJ
+       GECTechnology_Techview_Size_RBOBJ = 'N'
+       window modify GECTechnology_Techview_Size_RBOBJ
+   else
+       GECTechnology_Techview_Age_RBOBJ = 'N'
+       window modify GECTechnology_Techview_Age_RBOBJ
+       GECTechnology_Techview_Size_RBOBJ = 'Y'
+       window modify GECTechnology_Techview_Size_RBOBJ
+   endif
    call !b300_GECTechnology_Techview_Filter_PBOBJ
    return

//****************************************
//* GECTechnology_Techview_Filter_PBOBJ Processing
//****************************************
!b300_GECTechnology_Techview_Filter_PBOBJ
    ZoomTotalX = 0
    ZoomTotalY = 0
    Zoom = 1
    LabelSize = 8
    KeepLabelSize = 8
    GECTechnology_Techview_Labelsize_EFOBJ = LabelSize
    window modify GECTechnology_Techview_Labelsize_EFOBJ
    ListPage = 1
    ListCurrPage = 1
    close PaintFile error
    open PaintFile null
    i:/@LogoLine@/
    window paint GECTechnology_Techview_WIN
    window close GECTechnology_Details_WIN error
    Drag = 'n'
    window show GECTechnology_Techview_Filter_GBOBJ
    window show GECTechnology_Techview_Type_STTXT
    window show GECTechnology_Techview_Name_STTXT
    window show GECTechnology_Techview_Vendor_STTXT
    window show GECTechnology_Techview_Version_STTXT
    window show GECTechnology_Techview_Process_STTXT
    window show GECTechnology_Techview_Business_STTXT
    window show GECTechnology_Techview_Application_STTXT
    window show GECTechnology_Techview_Status_STTXT
    window show GECTechnology_Techview_Strategy_STTXT
    window show GECTechnology_Techview_Description_STTXT
    window show GECTechnology_Techview_Update_STTXT
    window show GECTechnology_Techview_Type_COOBJ
    window show GECTechnology_Techview_Name_COOBJ
    window show GECTechnology_Techview_Vendor_COOBJ
    window show GECTechnology_Techview_Version_COOBJ
    window show GECTechnology_Techview_Process_COOBJ
    window show GECTechnology_Techview_Business_COOBJ
    window show GECTechnology_Techview_Application_COOBJ
    window show GECTechnology_Techview_Status_COOBJ
    window show GECTechnology_Techview_Strategy_COOBJ
    window show GECTechnology_Techview_Description_EFOBJ
    window show GECTechnology_Techview_Update_EFOBJ
    window show GECTechnology_Techview_Followup_CBOBJ
    window show GECTechnology_Techview_View_PBOBJ
    window show GECTechnology_Techview_Archlayers_PBOBJ
    window show GECTechnology_Techview_Techstacks_PBOBJ
    window show GECTechnology_Techview_Archlayers_EFOBJ
    window show GECTechnology_Techview_Techstacks_EFOBJ
    window disable GECTechnology_Techview_Archlayers_EFOBJ
    window disable GECTechnology_Techview_Techstacks_EFOBJ

    window hide GECTechnology_Techview_Separator1_STTXT
    window hide GECTechnology_Techview_Separator2_STTXT
    window hide GECTechnology_Techview_Separator3_STTXT
    window hide GECTechnology_Techview_Separator4_STTXT

    window hide GECTechnology_Techview_History_GBOBJ
    window hide GECTechnology_Techview_History_GBOBJ
    window hide GECTechnology_Techview_Play_PBOBJ
    window hide GECTechnology_Techview_Pause_PBOBJ
    window hide GECTechnology_Techview_Stop_PBOBJ
    window hide GECTechnology_Techview_Slow_PBOBJ
    window hide GECTechnology_Techview_Fast_PBOBJ
    window hide GECTechnology_Techview_Backward_PBOBJ
    window hide GECTechnology_Techview_Forward_PBOBJ

    window hide GECTechnology_Techview_Close_PBOBJ
    window hide GECTechnology_Techview_Refresh_PBOBJ
    window show GECTechnology_Techview_Clear_PBOBJ

    window hide GECTechnology_Techview_Filter_PBOBJ

    window timer off

    call !t100_data_file

    return

//****************************************
//* Refresh the screen
//****************************************
!b310_GECTechnology_Techview_Refresh_PBOBJ
    ListPage = 1
    ListCurrPage = 1
    call !v100_view
    return

//****************************************
//* Show the history of changes
//****************************************
!b400_GECTechnology_Techview_Play_PBOBJ
    Working = 'n'
    PlayStatus = 'y'

    window close GECTechnology_Details_WIN error
    Drag = 'n'

    window disable GECTechnology_Techview_Filter_PBOBJ
    window disable GECTechnology_Techview_Close_PBOBJ

    window enable GECTechnology_Techview_Pause_PBOBJ
    window enable GECTechnology_Techview_Stop_PBOBJ
    window enable GECTechnology_Techview_Slow_PBOBJ
    window enable GECTechnology_Techview_Fast_PBOBJ

    if  (Paused)
+       MacroCommand = 'window timer on @Speed@' $MacroCommand
+       DisplayHistory = 'y'
+       Paused = 'n'
+       return
+   endif
    FileDirection = 'Forward'
    window disable GECTechnology_Techview_Forward_PBOBJ
    window enable GECTechnology_Techview_Backward_PBOBJ
    close HistoryFile error
    open HistoryFile null
    i:/GECTechnology.dat/
    open Temp null
    systemcurr:"dir GECTech-History"
    b d;7
    f;* b;1 d;* b
    do
        if  (!eof)
+           scan:/@line/:word
+           scan:/@right/:word
+           scan:/@right/:word
+           scan:/@right/:word
+           Newline = 'GECTech-History\@right@'
+           scan:/@Newline/:/.dat/
+           if  (found)
+               file HistoryFile
+               i:/@Newline/
+               file Temp
+       endif
        f;1
    until (eof)
    close Temp
    file HistoryFile
    b
    f;1
    Filename = line
    DisplayHistory = 'y'
    MacroCommand = 'window timer on @Speed@' $MacroCommand
    return

//****************************************
//* Pause the history of changes
//****************************************
!b410_GECTechnology_Techview_Pause_PBOBJ
    window close GECTechnology_Details_WIN error
    Drag = 'n'
    window timer off
    DisplayHistory = 'n'
    Paused = 'y'

    window disable GECTechnology_Techview_Pause_PBOBJ
    window disable GECTechnology_Techview_Slow_PBOBJ
    window disable GECTechnology_Techview_Fast_PBOBJ

    return

//****************************************
//* Stop the history of changes
//****************************************
!b420_GECTechnology_Techview_Stop_PBOBJ
    PlayStatus = 'n'
    window close GECTechnology_Details_WIN error
    Drag = 'n'
    window timer off
    DisplayHistory = 'n'
    Filename = 'GECTechnology.dat'
    call !v100_view

    window disable GECTechnology_Techview_Stop_PBOBJ
    window disable GECTechnology_Techview_Pause_PBOBJ
    window disable GECTechnology_Techview_Slow_PBOBJ
    window disable GECTechnology_Techview_Fast_PBOBJ

    window enable GECTechnology_Techview_Filter_PBOBJ
    window enable GECTechnology_Techview_Close_PBOBJ

    return

//****************************************
//* Slow down the history of changes
//****************************************
!b430_GECTechnology_Techview_Slow_PBOBJ
    window close GECTechnology_Details_WIN error
    Drag = 'n'

    if-1  (Speed = 0)
+       Speed = -1
+   else-1
+       if-2  (Speed = -1)
+           Speed = 1
+           window disable GECTechnology_Techview_Slow_PBOBJ
+   endif

    MacroCommand = "window timer on @Speed@" $MacroCommand
    
    window enable GECTechnology_Techview_Fast_PBOBJ

    return

//****************************************
//* Speed Up the history of changes
//****************************************
!b440_GECTechnology_Techview_Fast_PBOBJ
    window close GECTechnology_Details_WIN error
    Drag = 'n'

    if-1  (Speed = 1)
+       Speed = -1
+   else-1
+       if-2  (Speed = -1)
+           Speed = 0
+           window disable GECTechnology_Techview_Fast_PBOBJ
+   endif

    MacroCommand = "window timer on @Speed@" $MacroCommand
    
    window enable GECTechnology_Techview_Slow_PBOBJ

    return

//****************************************
//* Move backwards through history
//****************************************
!b450_GECTechnology_Techview_Backward_PBOBJ
    window close GECTechnology_Details_WIN error
    Drag = 'n'
    FileDirection = 'Backward'
    window disable GECTechnology_Techview_Backward_PBOBJ
    window enable GECTechnology_Techview_Forward_PBOBJ
    return

//****************************************
//* Move Forwards through history
//****************************************
!b460_GECTechnology_Techview_Forward_PBOBJ
    window close GECTechnology_Details_WIN error
    Drag = 'n'
    FileDirection = 'Forward'
    window disable GECTechnology_Techview_Forward_PBOBJ
    window enable GECTechnology_Techview_Backward_PBOBJ
    return

//****************************************
//* Move backwards 1 list page
//****************************************
!b465_GECTechnology_Techview_Prev_PBOBJ
    ListPage --
    ListCurrPage = 1
    call !v100_view
    return

//****************************************
//* Move forwards 1 list page
//****************************************
!b466_GECTechnology_Techview_Next_PBOBJ
    ListPage ++
    if  (ListPage < 1) ListPage = 1
    ListCurrPage = 1
    call !v100_view
    return

//****************************************
//* Reduce Label Size
//****************************************
!b470_GECTechnology_Techview_Minus_PBOBJ
    window obtain GECTechnology_Techview_Labels_CBOBJ
    if  (!GECTechnology_Techview_Labels_CBOBJ) return
    KeepLabelSize -= 1
    if  (KeepLabelSize < 6) KeepLabelSize = 6
    LabelSize = KeepLabelSize
    GECTechnology_Techview_Labelsize_EFOBJ = LabelSize
    window modify GECTechnology_Techview_Labelsize_EFOBJ
    call !b480_adjust_label_size
    return

//****************************************
//* Increase Label Size
//****************************************
!b475_GECTechnology_Techview_Plus_PBOBJ
    window obtain GECTechnology_Techview_Labels_CBOBJ
    if  (!GECTechnology_Techview_Labels_CBOBJ) return
    KeepLabelSize += 1
    LabelSize = KeepLabelSize
    GECTechnology_Techview_Labelsize_EFOBJ = LabelSize
    window modify GECTechnology_Techview_Labelsize_EFOBJ
    call !b480_adjust_label_size
    return    

//****************************************
//* Adjust the Label Size and repaint
//****************************************
!b480_adjust_label_size
    if  (!LabelSize) return
    file PaintFile error return
    b
    f;1
    do
        fs:/,TextTilt,/
        if  (!eof)
+           scan:/@line/:/,/ HoldLeft = left
+           scan:/@right/:/,/ HoldLeft = '@HoldLeft@,@left@'
+           scan:/@right/:/,/ HoldLeft = '@HoldLeft@,@left@'
+           scan:/@right/:/,/ HoldLeft = '@HoldLeft@,@left@'
+           scan:/@right/:/,/ HoldLeft = '@HoldLeft@,@left@'
+           scan:/@right/:/,/
+           Newline = '@HoldLeft@,@LabelSize@,@right@'
+           r:/@Newline/
+           f;1
+       endif
    until (eof)
    window paint GECTechnology_Techview_WIN
    return


//****************************************
//* Zoom in on Polar View
//****************************************
!b490_GECTechnology_Techview_Zoomin_PBOBJ
    if  (Zoom = 1)
+       file PaintFile
+       clear
+       b
+       copy;*
+       close Zoomin error
+       open Zoomin null
+       paste
+       file ObjectsFile
+       b
+       copy;*
+       close Objectszoom error
+       open Objectszoom null
+       paste
+   endif
    Zoom = Zoom + 1
    Zoomdir = 1
    ZoomTextSize = 5
    file PaintFile
    b
    window enable GECTechnology_Techview_Zoomout_PBOBJ
    call !b499_polar_zoom
    return

    call !v100_view
    call !b475_GECTechnology_Techview_Plus_PBOBJ
    call !b475_GECTechnology_Techview_Plus_PBOBJ
    window enable GECTechnology_Techview_Zoomout_PBOBJ
    if  (ZoomTotalX != 0) or (ZoomTotalY != 0)
+       ZoomX = ZoomTotalX
+       ZoomY = ZoomTotalY
+       call !b499_polar_shift
    return

//****************************************
//* Zoom out on Polar View
//****************************************
!b491_GECTechnology_Techview_Zoomout_PBOBJ
    Zoom = 1
    file Zoomin error goto !b491_GECTechnology_Techview_Zoomout_refresh
    clear
    b
    copy;*
    file PaintFile
    b
    d;*
    paste
    b
    file Objectszoom
    b
    copy;*
    file ObjectsFile
    b
    d;*
    paste
    b
    window paint GECTechnology_Techview_WIN
    if  (Zoom = 1) return
    Zoom = Zoom - 1
    Zoomdir = -1
    ZoomTextSize = -5
    if  (Zoom < 1) Zoom = 1 return
    if  (Zoom = 1)
+        //window disable GECTechnology_Techview_Zoomout_PBOBJ
+   endif

    call !b499_polar_zoom
    return

!b491_GECTechnology_Techview_Zoomout_refresh
    call !v100_view
    call !b470_GECTechnology_Techview_Minus_PBOBJ
    call !b470_GECTechnology_Techview_Minus_PBOBJ
    if  (ZoomTotalX != 0) or (ZoomTotalY != 0)
+       ZoomX = ZoomTotalX
+       ZoomY = ZoomTotalY
+       call !b499_polar_shift
    return

//****************************************
//* Move Polar View Up
//****************************************
!b495_GECTechnology_Techview_Zoomup_PBOBJ
    ZoomX = 0
    ZoomY = 100
    ZoomTotalY += 100
    call !b499_polar_shift
    return

//****************************************
//* Move Polar View Down
//****************************************
!b496_GECTechnology_Techview_Zoomdown_PBOBJ
    ZoomX = 0
    ZoomY = -100
    ZoomTotalY -= 100
    call !b499_polar_shift
    return

//****************************************
//* Move Polar View Left
//****************************************
!b497_GECTechnology_Techview_Zoomleft_PBOBJ
    ZoomX = 100
    ZoomY = 0
    ZoomTotalX += 100
    call !b499_polar_shift
    return

//****************************************
//* Move Polar View Right
//****************************************
!b498_GECTechnology_Techview_Zoomright_PBOBJ
    ZoomX = -100
    ZoomY = 0
    ZoomTotalX -= 100
    call !b499_polar_shift
    return

//****************************************
//* Move the Polar View
//****************************************
!b499_polar_shift
    //****************************
    //* Update Paint File
    //****************************
    file PaintFile
    b
    f;1
    do
        if  (!eof)
+           scan:/@line/:/BitmapFit,1224/
+           if (!found)
+               scan:/@line/:/,Ellipse,/
+               if (!found)
+                   scan:/@line/:/,Circle,/
+                   if (!found)
+                      scan:/@line/:/,Arrow,/
+                      if  (!found)
+                          scan:/@line/:/,TextTilt,/
+                          if  (!found)
+                              scan:/@line/:/,Line,/
+                              if  (!found)
+                                  scan:/@line/:/,Text,/
+                                  if  (!found)
+                                      scan:/@line/:/,BitmapFit,/
+       endif
        if-1  (found) and (mid != 'BitmapFit,1224')
+           if-2  (mid = ',Line,') or (mid = ',Arrow,')
+               scan:/@line/:/,/
+               HoldLeft = left
+               scan:/@right/:/,/
+               HoldLeft = '@HoldLeft@,@left@'
+               scan:/@right/:/,/
+               HoldLeft = '@HoldLeft@,@left@'
+               scan:/@right/:/,/
+               ObjectX = left
+               scan:/@right/:/,/
+               ObjectY = left
+               scan:/@right/:/,/
+               ObjectCX = left
+               scan:/@right/:/,/
+               ObjectCY = left
+               ObjectX += ZoomX
+               ObjectY += ZoomY
+               ObjectCX += ZoomX
+               ObjectCY += ZoomY
+               Newline = '@HoldLeft@,@ObjectX@,@ObjectY@,@ObjectCX@,@ObjectCY@,@right@'
+               r:/@Newline@/
+           else-2
+               scan:/@line/:/,Default,/
+               if-3 (!found)
+                   scan:/@line/:/,/
+                   HoldLeft = left
+                   scan:/@right/:/,/
+                   HoldLeft = '@HoldLeft@,@left@'
+                   scan:/@right/:/,/
+                   HoldLeft = '@HoldLeft@,@left@'
+                   scan:/@right/:/,/
+                   ObjectX = left
+                   scan:/@right/:/,/
+                   ObjectY = left
+                   ObjectX += ZoomX
+                   ObjectY += ZoomY
+                   Newline = '@HoldLeft@,@ObjectX@,@ObjectY@,@right@'
+                   r:/@Newline@/
+       endif
        f;1
    until (eof)
    window paint GECTechnology_Techview_WIN

    //****************************
    //* Update Objects File
    //****************************
    file ObjectsFile
    b
    do
        if  (!eof)
+           scan:/@line/:/|/
+           HoldLeft = left
+           scan:/@right/:/|/
+           ObjectX = left
+           scan:/@right/:/|/
+           ObjectY = left
+           scan:/@right/:/|/
+           ObjectCX = left
+           scan:/@right/:/|/
+           ObjectCY = left
+           ObjectX += ZoomX
+           ObjectY += ZoomY
+           ObjectCX += ZoomX
+           ObjectCY += ZoomY
+           Newline = '@HoldLeft@|@ObjectX@|@ObjectY@|@ObjectCX@|@ObjectCY@|@right@'
+           r:/@Newline@/
+       endif
        f;1
    until (eof)
    return

//****************************************
//* Zoom the Polar View
//****************************************
!b499_polar_zoom

    //****************************
    //* Update Paint File
    //****************************
    file PaintFile
    b
    f;1
    do
        if  (!eof)
+           scan:/@line/:/BitmapFit,1224/
+           if (!found)
+               scan:/@line/:/,Ellipse,/
+               if (!found)
+                   scan:/@line/:/,Circle,/
+                   if (!found)
+                      scan:/@line/:/,Arrow,/
+                      if  (!found)
+                          scan:/@line/:/,TextTilt,/
+                          if  (!found)
+                              scan:/@line/:/,Line,/
+                              if  (!found)
+                                  scan:/@line/:/,Text,/
+                                  if  (!found)
+                                      scan:/@line/:/,BitmapFit,/
+       endif
        if-1  (found) and (mid != 'BitmapFit,1224')
+           if-2  (mid = ',Line,') or (mid = ',Arrow,')
+               scan:/@line/:/,/
+               HoldLeft = left
+               scan:/@right/:/,/
+               HoldLeft = '@HoldLeft@,@left@'
+               scan:/@right/:/,/
+               HoldLeft = '@HoldLeft@,@left@'
+               scan:/@right/:/,/
+               ObjectX = left
+               scan:/@right/:/,/
+               ObjectY = left
+               scan:/@right/:/,/
+               ObjectCX = left
+               scan:/@right/:/,/
+               ObjectCY = left
+               TestX = ObjectX TestY = ObjectY call !b499_polar_zoom_new_xy ObjectX = NewX ObjectY = NewY
+               TestX = ObjectCX TestY = ObjectCY call !b499_polar_zoom_new_xy ObjectCX = NewX ObjectCY = NewY
+               Newline = '@HoldLeft@,@ObjectX@,@ObjectY@,@ObjectCX@,@ObjectCY@,@right@'
+               r:/@Newline@/
+           else-2
+               scan:/@line/:/,Default,/
+               if-3 (!found)
+                   scan:/@line/:/,/
+                   HoldLeft = left
+                   scan:/@right/:/,/
+                   HoldLeft = '@HoldLeft@,@left@'
+                   scan:/@right/:/,/
+                   HoldLeft = '@HoldLeft@,@left@'
+                   scan:/@right/:/,/
+                   ObjectX = left
+                   scan:/@right/:/,/
+                   ObjectY = left
+                   scan:/@right/:/,/
+                   ObjectCX = left
+                   scan:/@right/:/,/
+                   ObjectCY = left
+                   TestX = ObjectX TestY = ObjectY call !b499_polar_zoom_new_xy ObjectX = NewX ObjectY = NewY
+                   HoldRight = right
+                   scan:/@line/:/TextTilt/
+                   if-4 (!found)
+                      ObjectCX *= Zoom
+                      ObjectCY *= Zoom
+                      Newline = '@HoldLeft@,@ObjectX@,@ObjectY@,@ObjectCX@,@ObjectCY@,@HoldRight@'
+                      r:/@Newline@/
+                   else-4
+                      ObjectCX += ZoomTextSize
+                      Newline = '@HoldLeft@,@ObjectX@,@ObjectY@,@ObjectCX@,@ObjectCY@,@HoldRight@'
+                      r:/@Newline@/
+       endif
        f;1
    until (eof)
    window paint GECTechnology_Techview_WIN

    //****************************
    //* Update Objects File
    //****************************
    file ObjectsFile
    b
    do
        if  (!eof)
+           scan:/@line/:/|/
+           HoldLeft = left
+           scan:/@right/:/|/
+           ObjectX = left
+           scan:/@right/:/|/
+           ObjectY = left
+           scan:/@right/:/|/
+           ObjectCX = left
+           scan:/@right/:/|/
+           ObjectCY = left
+           ObjectCX = ObjectCX - ObjectX
+           ObjectCY = ObjectCY - ObjectY
+           TestX = ObjectX TestY = ObjectY call !b499_polar_zoom_new_xy ObjectX = NewX ObjectY = NewY
+           ObjectCX *= Zoom
+           ObjectCX += ObjectX
+           ObjectCY *= Zoom
+           ObjectCY += ObjectY
+           Newline = '@HoldLeft@|@ObjectX@|@ObjectY@|@ObjectCX@|@ObjectCY@|@right@'
+           //message = 'line[@line@] Newline[@Newline@]' window message info ok
+           r:/@Newline@/
+       endif
        f;1
    until (eof)
    return

//****************************************
//* Zoom the Polar View
//****************************************
!b499_polar_zoom_new_xy
    
    DistX = TestX - 625
    DistY = TestY - 325
    Work1 = TestX * TestX
    Work2 = TestY * TestY
    //message = 'DistX[@DistX@] DistY[@DistY@] TestX[@TestX@] TestY[@TestY@] Work1[@Work1@] Work2[@Work2@]' window message info ok
    Work1 = Work1 + Work2
    Length = sqrt(Work1)
    PercX = DistX / Length
    PercY = DistY / Length

    Length = Length * Zoom
//    if  (Zoomdir > 0)
//+       Length = Length * Zoom
//+   else
//+       Work1 = Zoom + Zoomdir + 2
//+       Length = Length / Work1
//+   endif

    //message = 'Length[@Length@] Work1[@Work1@] PercX[@PercX@] PercY[@PercY@] NewX[@NewX@] NewY[@NewY@]' window message info ok

    Work1 = Length * PercX
    NewX = 625 + Work1

    Work2 = Length * PercY
    NewY = 325 + Work2

    //message = 'Work1[@Work1@] Work2[@Work2@]NewX[@NewX@] NewY[@NewY@]' window message info ok

    return

//****************************************
//* Show the Legend Screen
//****************************************
!b499_GECTechnology_Techview_Legend_PBOBJ
    file PaintFile error open PaintFile null
    b
    do
        fs:/GECTechnology_Legend_WIN/
        if  (!eof) d
    until (eof)

    Newline = 'GECTechnology_Legend_WIN,Box,Box,10,50,850,30,213,255,214' i:/@Newline@/ 
    Newline = 'GECTechnology_Legend_WIN,Box,Box,10,80,850,30,213,239,255,' i:/@Newline@/
    Newline = 'GECTechnology_Legend_WIN,Box,Box,10,110,850,30,224,213,255' i:/@Newline@/ 
    Newline = 'GECTechnology_Legend_WIN,Box,Box,10,140,850,30,252,255,213' i:/@Newline@/ 
    Newline = 'GECTechnology_Legend_WIN,Box,Box,10,170,850,30,255,213,213' i:/@Newline@/ 

    Newline = 'GECTechnology_Legend_WIN,Text,Text,350,10,25,25,0,0,0,Times New Roman,Legend' i:/@Newline@/ 

    Newline = 'GECTechnology_Legend_WIN,Text,Text,15,50,15,15,0,0,0,Times New Roman,Adopt' i:/@Newline@/ 
    Newline = 'GECTechnology_Legend_WIN,Text,Text,115,50,15,15,0,0,0,Times New Roman,In use in the organization. Teams can and should use.' i:/@Newline@/ 

    Newline = 'GECTechnology_Legend_WIN,Text,Text,15,80,15,15,0,0,0,Times New Roman,Trial' i:/@Newline@/
    Newline = 'GECTechnology_Legend_WIN,Text,Text,115,80,15,15,0,0,0,Times New Roman,In limited pilot and should not be used unless approved.' i:/@Newline@/

    Newline = 'GECTechnology_Legend_WIN,Text,Text,15,110,15,15,0,0,0,Times New Roman,Assess' i:/@Newline@/ 
    Newline = 'GECTechnology_Legend_WIN,Text,Text,115,110,15,15,0,0,0,Times New Roman,Preliminary analysis being done as to the potential viability in the organization.' i:/@Newline@/ 

    Newline = 'GECTechnology_Legend_WIN,Text,Text,15,140,15,15,0,0,0,Times New Roman,Hold' i:/@Newline@/ 
    Newline = 'GECTechnology_Legend_WIN,Text,Text,115,140,15,15,0,0,0,Times New Roman,Should not be adopted for new work unless necessary. Not adopted as a standard. Proceed with caution.' i:/@Newline@/ 

    Newline = 'GECTechnology_Legend_WIN,Text,Text,15,170,15,15,0,0,0,Times New Roman,Move Off' i:/@Newline@/ 
    Newline = 'GECTechnology_Legend_WIN,Text,Text,115,170,15,15,0,0,0,Times New Roman,Do not use. Plan to migrate off if currently using.' i:/@Newline@/ 

    window pointer wait
    window hwnd GECTechnology_Legend_WIN status error window open GECTechnology_Legend_WIN shade
    window center GECTechnology_Legend_WIN
    window clear GECTechnology_Legend_WIN    
    window unshade GECTechnology_Legend_WIN    
    window pointer arrow
    return

//****************************************
//* Show the HTML screen
//****************************************
!b499_GECTechnology_Techview_Html_PBOBJ
    system:"start GECTechnology_details_html/GECTechnology.html"
    return

//****************************************
//* Details Add Button
//****************************************
!b500_GECTechnology_Details_Add_PBOBJ
    Mode = 'Add'
    call !b500_GECTechnology_Details_AddChange
    return

//****************************************
//* Details Change Button
//****************************************
!b500_GECTechnology_Details_Change_PBOBJ
    Mode = 'Change'
!b500_GECTechnology_Details_AddChange
    window obtain GECTechnology_Details_WIN

    if  (Mode = 'Add')
+       TestType = GECTechnology_Details_Type_EFOBJ
+       TestName = GECTechnology_Details_Name_EFOBJ
+       TestVersion = GECTechnology_Details_Version_EFOBJ
+       call !a010_find_object
+       if  (OK)
+           message = "Can't add an already existing technology!'
+           window message error ok
+           return
+   endif
   
    if  (Mode = 'Add')
+       window obtain GECTechnology_Details_WIN
+       Key = "20@date[7-8]@@date[1-2]@@date[4-5]@@time[1-2]@@time[4-5]@@time[7-8]@"
+   endif

    Type = GECTechnology_Details_Type_EFOBJ
    Name = GECTechnology_Details_Name_EFOBJ
    Description = GECTechnology_Details_Description_MLOBJ
    Version = GECTechnology_Details_Version_EFOBJ
    Vendor = GECTechnology_Details_Vendor_EFOBJ
    Size = GECTechnology_Details_Size_EFOBJ
    Maintenance = GECTechnology_Details_Maintenance_EFOBJ
    Support = GECTechnology_Details_Support_EFOBJ
    Hits = GECTechnology_Details_Hits_EFOBJ
    Archlayers = GECTechnology_Details_Archlayers_EFOBJ
    Techstacks = GECTechnology_Details_Techstacks_EFOBJ
    Process = GECTechnology_Details_Process_EFOBJ
    Business = GECTechnology_Details_Business_EFOBJ
    Status = GECTechnology_Details_Status_EFOBJ
    Strategy = GECTechnology_Details_Strategy_EFOBJ
    GECTechnology_Details_Changed_EFOBJ = '20@date[7-8]@/@date[1-2]@/@date[4-5]@'
    ChangeDate = GECTechnology_Details_Changed_EFOBJ
    Age = GECTechnology_Details_Originated_EFOBJ
    Watch = GECTechnology_Details_Watch_CBOBJ
    Comments = GECTechnology_Details_Comments_MLOBJ
    //******************************
    //* Remove '|'s
    //******************************
    do
        scan:/@Name/:/|/
        if  (found)
+           Name = '@left@~@right@'
+       endif
+   until (!found)
    do
        scan:/@Description/:/|/
        if  (found)
+           Description = '@left@~@right@'
+       endif
+   until (!found)
    do
        scan:/@Version/:/|/
        if  (found)
+           Version = '@left@~@right@'
+       endif
+   until (!found)
    do
        scan:/@Process/:/|/
        if  (found)
+           Process = '@left@~@right@'
+       endif
+   until (!found)
    do
        scan:/@Business/:/|/
        if  (found)
+           Business = '@left@~@right@'
+       endif
+   until (!found)
    do
        scan:/@Comments/:/|/
        if  (found)
+           Comments = '@left@~@right@'
+       endif
+   until (!found)
    do
        scan:/@Archlayers/:/|/
        if  (found)
+           Archlayers = '@left@~@right@'
+       endif
+   until (!found)
    do
        scan:/@Techstacks/:/|/
        if  (found)
+           Techstacks = '@left@~@right@'
+       endif
+   until (!found)

    //******************************
    //* Input Validation
    //******************************
    if  (Type != 'Languages') and (Type != 'Platforms') and (Type != 'Tools')
+       message = 'Invalid Type, must be "Languages", "Platforms", or "Tools"'
+       window message warning ok
+       window setfocus GECTechnology_Details_Type_EFOBJ
+       return
+   endif
    if  (Status != 'Assess') and (Status != 'Trial') and (Status != 'Adopt') and (Status != 'Hold') and (Status != 'Move Off')
+       message = 'Invalid Status, must be "Assess", "Trial", "Adopt", "Hold", or "Move Off"'
+       window message warning ok
+       window setfocus GECTechnology_Details_Status_EFOBJ
+       return
+   endif
    if  (Strategy != 'Assess') and (Strategy != 'Trial') and (Strategy != 'Adopt') and (Strategy != 'Hold') and (Strategy != 'Move Off') and (Strategy != null)
+       message = 'Invalid Strategy, must be "Assess", "Trial", "Adopt", "Hold", "Move Off", or blank'
+       window message warning ok
+       window setfocus GECTechnology_Details_Strategy_EFOBJ
+       return
+   endif
//    if  (Watch != 'Y') and (Watch != 'N') and (Watch != null)
//+       message = 'Invalid Watch, must be "Y", "N", or blank'
//+       window message warning ok
//+       window setfocus GECTechnology_Details_Watch_CBOBJ
//+       return
//+   endif

    split:/@GECTechnology_Details_Originated_EFOBJ@/;4
    iTest = left
    if  (iTest < 1900) or (iTest > 2100)
+      message = "Invalid Year, must be > 1900 and < 2100"
+      window message warning ok
+      window setfocus GECTechnology_Details_Originated_EFOBJ
+      return
+   endif      
    split:/@right/;1
    if (left != '/')
+      message = "Invalid date separator 1, must be '/'"
+      window message warning ok
+      window setfocus GECTechnology_Details_Originated_EFOBJ
+      return
+   endif
    split:/@right/;2
    iTest = left
    if  (iTest < 1) or (iTest > 12)
+      message = "Invalid Month"
+      window message warning ok
+      window setfocus GECTechnology_Details_Originated_EFOBJ
+      return
+   endif  
    split:/@right/;1
    if (left != '/')
+      message = "Invalid date separator 2, must be '/'"
+      window message warning ok
+      window setfocus GECTechnology_Details_Originated_EFOBJ
+      return
+   endif
    split:/@right/;2
    iTest = left
    if  (iTest < 1) or (iTest > 31)
+      message = "Invalid Day"
+      window message warning ok
+      window setfocus GECTechnology_Details_Originated_EFOBJ
+      return
+   endif
    if (right != null)
+      message = "Invalid Date, remaining characters"
+      window message warning ok
+      window setfocus GECTechnology_Details_Originated_EFOBJ
+      return
+   endif    
    

    Newline = '@Key@|@Type@|@Name@|@Description@|@Vendor@|@Version@|@Archlayers@|@Techstacks@|@Size@|@Maintenance@|@Support@|@Hits@|@Process@|@Business@|@Status@|@Strategy@|@ChangeDate@|@Watch@|@Age@|@Comments@'
    file DataFile
    if  (Mode = 'Change')
+       r:/@Newline@/
+   else
+       f;*
+       i:/@Newline@/
+   endif
    write DataFile GECTechnology.dat
    call !b505_history
    //call !b100_GECTechnology_Techview_View_PBOBJ

    window close GECTechnology_Details_WIN
    Drag = 'n'
    return

//****************************************
//* Details Delete Button
//****************************************
!b500_GECTechnology_Details_Delete_PBOBJ
    message = 'Are you sure you want to delete this technology?'
    window message question yesno
    if  (message)
+       file DataFile
+       d;1
+       write DataFile GECTechnology.dat
+       call !b505_history
+       //call !b100_GECTechnology_Techview_View_PBOBJ
+       window close GECTechnology_Details_WIN
+       Drag = 'n'
+   endif
    return

//****************************************
//* Create History
//****************************************
!b505_history
    system:"md GECTech-History"
    Filename = 'GECTech-History\20@date[7-8]@@date[1-2]@@date[4-5]@-@time[1-2]@@time[4-5]@@time[7-8]@.dat'
    write DataFile @Filename
    Filename = 'GECTechnology.dat'
    return

//****************************************
//* Details Cancel Button
//****************************************
!b510_GECTechnology_Details_Cancel_PBOBJ
    window close GECTechnology_Details_WIN
    Drag = 'n'
    return

//****************************************
//* Applications Button
//****************************************
!b520_GECTechnology_Details_Applications_PBOBJ
    window obtain GECTechnology_Details_WIN

    window pointer wait
    window hwnd GECTechnology_Applications_WIN status error window open GECTechnology_Applications_WIN shade
    window center GECTechnology_Applications_WIN
    window clear GECTechnology_Applications_WIN

    GECTechnology_Applications_Type_EFOBJ = GECTechnology_Details_Type_EFOBJ
    window modify GECTechnology_Applications_Type_EFOBJ
    window disable GECTechnology_Applications_Type_EFOBJ
    GECTechnology_Applications_Name_EFOBJ = GECTechnology_Details_Name_EFOBJ
    window modify GECTechnology_Applications_Name_EFOBJ
    window disable GECTechnology_Applications_Name_EFOBJ
    GECTechnology_Applications_Version_EFOBJ = GECTechnology_Details_Version_EFOBJ
    window modify GECTechnology_Applications_Version_EFOBJ
    window disable GECTechnology_Applications_Version_EFOBJ
    GECTechnology_Applications_Description_MLOBJ = GECTechnology_Details_Description_MLOBJ
    window modify GECTechnology_Applications_Description_MLOBJ
    window disable GECTechnology_Applications_Description_MLOBJ

    close Applications error
    open Applications GECTechnology.app error open Applications null
    BusinessLoaded = 'n'
    Changed = 'n'
    call !b700_load_applications_list

    window setfocus GECTechnology_Applications_Business_COOBJ

    if (Filename != 'GECTechnology.dat') or (Userid = 'Guest')
+      window disable GECTechnology_Applications_Add_PBOBJ
+      window disable GECTechnology_Applications_Delete_PBOBJ
+      window disable GECTechnology_Applications_Ok_PBOBJ
+   else
+      window enable GECTechnology_Applications_Add_PBOBJ
+      window enable GECTechnology_Applications_Delete_PBOBJ
+      window enable GECTechnology_Applications_Ok_PBOBJ
+   endif

    window unshade GECTechnology_Applications_WIN
    window pointer arrow
    return

//****************************************
//* Archlayers select
//****************************************
!b530_GECTechnology_Details_Archlayers_PBOBJ
    MultiselectWindow = 'Details'
    MultiselectLabel = 'Architecture Layers'
    MultiselectType = 'Archlayers'
    call !m100_open_multiselect
    return

//****************************************
//* Techstacks select
//****************************************
!b540_GECTechnology_Details_Techstacks_PBOBJ
    MultiselectWindow = 'Details'
    MultiselectLabel = 'Tech Stacks'
    MultiselectType = 'Techstacks'
    call !m100_open_multiselect
    return

//****************************************
//* Type select
//****************************************
!b550_GECTechnology_Details_Type_PBOBJ
    MultiselectWindow = 'Details'
    MultiselectLabel = 'Type'
    MultiselectType = 'Type'
    call !m100_open_multiselect
    return

//****************************************
//* Status select
//****************************************
!b560_GECTechnology_Details_Status_PBOBJ
    MultiselectWindow = 'Details'
    MultiselectLabel = 'Status'
    MultiselectType = 'Status'
    call !m100_open_multiselect
    return

//****************************************
//* Strategy select
//****************************************
!b570_GECTechnology_Details_Strategy_PBOBJ
    MultiselectWindow = 'Details'
    MultiselectLabel = 'Strategy'
    MultiselectType = 'Strategy'
    call !m100_open_multiselect
    return

//****************************************
//* Appliations Add Button
//****************************************
!b600_GECTechnology_Applications_Add_PBOBJ
    window obtain GECTechnology_Applications_WIN

    pack GECTechnology_Applications_Business_COOBJ
    if  (GECTechnology_Applications_Business_COOBJ = null)
+       message = 'Please enter a Business'
+       window message warning ok
+       window setfocus GECTechnology_Applications_Business_COOBJ
+       return
+   endif
    pack GECTechnology_Applications_Application_EFOBJ
    if  (GECTechnology_Applications_Application_EFOBJ = null)
+       message = 'Please enter an Application Name'
+       window message warning ok
+       window setfocus GECTechnology_Applications_Application_EFOBJ
+       return
+   endif

    SearchString = '@GECTechnology_Applications_Business_COOBJ@|@GECTechnology_Applications_Application_EFOBJ@|@GECTechnology_Applications_Name_EFOBJ@|@GECTechnology_Applications_Version_EFOBJ@'
    file Applications
    b
    fs:/@SearchString@/
    if  (!eof)
+       message = 'Business Application already exists for @GECTechnology_Applications_Name_EFOBJ@ v@GECTechnology_Applications_Version_EFOBJ@'
+       window message warning ok
+       window setfocus GECTechnology_Applications_Application_EFOBJ
+       return
+   endif    
    b
    SearchString = '@GECTechnology_Applications_Business_COOBJ@|@GECTechnology_Applications_Application_EFOBJ@|'
    fs:/@SearchString@/
    Newline = '@GECTechnology_Applications_Business_COOBJ@|@GECTechnology_Applications_Application_EFOBJ@|@GECTechnology_Applications_Name_EFOBJ@|@GECTechnology_Applications_Version_EFOBJ@'
    i:/@Newline/
    call !b700_load_applications_list
    GECTechnology_Applications_Application_EFOBJ = null
    window modify GECTechnology_Applications_Application_EFOBJ
    window setfocus GECTechnology_Applications_Application_EFOBJ
    Changed = 'y'
    return

//****************************************
//* Applications Delete Button 
//****************************************
!b610_GECTechnology_Applications_Delete_PBOBJ
    GECTechnology_Applications_Applications_LBOBJ = null
    window obtain GECTechnology_Applications_Applications_LBOBJ
    if  (GECTechnology_Applications_Applications_LBOBJ = null)
+       message = 'Please select an Application'
+       window message warning ok
+       window setfocus GECTechnology_Applications_Applications_LBOBJ
+       return
+   endif

    scan:/@GECTechnology_Applications_Applications_LBOBJ@/:/:/
    SearchString = '@left@|@right@|'
    file Applications
    b
    fs:/@SearchString/
    if  (eof)
+       message = 'Unable to locate Application'
+       window message error ok
+       return
+   endif
    d;1
    call !b700_load_applications_list
    Changed = 'y'
    return

//****************************************
//* Applications OK Button 
//****************************************
!b620_GECTechnology_Applications_Ok_PBOBJ
    window close GECTechnology_Applications_WIN
    write Applications GECTechnology.app
    close Applications
    return

//****************************************
//* Applications Cancel Button 
//****************************************
!b630_GECTechnology_Applications_Cancel_PBOBJ
    if  (Changed)
+       message = 'Are you Sure?'
+       window message question yesno
+       if (!message)
+          return
+   endif
    window close GECTechnology_Applications_WIN
    close Applications
    return

//****************************************
//* Close the Legend window
//****************************************
!b700_GECTechnology_Legend_Close_PBOBJ
    window close GECTechnology_Legend_WIN
    return

//****************************************
//* Load the Applications List
//****************************************
!b700_load_applications_list
    GECTechnology_Applications_Applications_LBOBJ = 'ALL'
    window delete GECTechnology_Applications_Applications_LBOBJ

    SearchString = '|@GECTechnology_Applications_Name_EFOBJ@|@GECTechnology_Applications_Version_EFOBJ@'
    file Applications
    b
    do
        fs:/@SearchString@/
        if  (!eof)
+           scan:/@line/:/|/
+           GECTechnology_Applications_Applications_LBOBJ = left
+           scan:/@right/:/|/
+           GECTechnology_Applications_Applications_LBOBJ = '@GECTechnology_Applications_Applications_LBOBJ@:@left@'
+           window insert end default GECTechnology_Applications_Applications_LBOBJ
+       endif
        f;1
        fs:/@SearchString@/
    until (eof)

    if  (BusinessLoaded) return
    BusinessLoaded = 'y'
    window obtain GECTechnology_Details_Business_EFOBJ
    GECTechnology_Applications_Business_COOBJ = 'ALL'
    window delete GECTechnology_Applications_Business_COOBJ
    do
        scan:/@GECTechnology_Details_Business_EFOBJ@/:/,/
        GECTechnology_Applications_Business_COOBJ = left
        pack GECTechnology_Applications_Business_COOBJ
        if  (GECTechnology_Applications_Business_COOBJ != null)
+           window insert end default GECTechnology_Applications_Business_COOBJ
+       endif
        if  (found)
+           GECTechnology_Details_Business_EFOBJ = right
+       else
+           GECTechnology_Details_Business_EFOBJ = null
+       endif 
        pack GECTechnology_Details_Business_EFOBJ
    until (GECTechnology_Details_Business_EFOBJ = null)

    return

//******************************
//* Process the Multiselect Window
//******************************
!b800_GECTechnology_Multiselect_Ok_PBOBJ
    window obtain GECTechnology_Multiselect_WIN
    MultiselectData = null
    GECTechnology_Multiselect_Multiselect_LBOBJ = 'FIRST'
!b800_next
    window obtain GECTechnology_Multiselect_Multiselect_LBOBJ
    pack GECTechnology_Multiselect_Multiselect_LBOBJ
    if  (GECTechnology_Multiselect_Multiselect_LBOBJ = null) goto !b800_done
    if  (MultiselectData = null)
+       MultiselectData = GECTechnology_Multiselect_Multiselect_LBOBJ
+   else
+       MultiselectData = '@MultiselectData@,@GECTechnology_Multiselect_Multiselect_LBOBJ@'
+   endif
    GECTechnology_Multiselect_Multiselect_LBOBJ = 'NEXT'
    goto !b800_next
!b800_done    
    MacroCommand = 'GECTechnology_@MultiselectWindow@_@MultiselectType@_EFOBJ = MultiselectData' $MacroCommand
    MacroCommand = 'window modify GECTechnology_@MultiselectWindow@_@MultiselectType@_EFOBJ' $MacroCommand

    window close GECTechnology_Multiselect_WIN
    return

//******************************
//* Process the Multiselect Window
//******************************
!b810_GECTechnology_Multiselect_Cancel_PBOBJ
    window close GECTechnology_Multiselect_WIN
    return

//******************************
//* Open the Multiselect Window
//******************************
!m100_open_multiselect
    window hwnd GECTechnology_Multiselect_WIN status error window open GECTechnology_Multiselect_WIN shade
    window center GECTechnology_Multiselect_WIN

    GECTechnology_Multiselect_Multiselect_LBOBJ = 'ALL'
    window delete GECTechnology_Multiselect_Multiselect_LBOBJ

    MultiselectFilename = 'GECTech-@MultiselectType@.dat'
    close Multiselect error
    open Multiselect @MultiselectFilename error message = 'Unable to open @MultiselectFilename@' window message warning ok goto !m100_done

    GECTechnology_Multiselect_Multiselect_STTXT = MultiselectLabel
    window modify GECTechnology_Multiselect_Multiselect_STTXT

    b
    do
        if  (!eof)
+           GECTechnology_Multiselect_Multiselect_LBOBJ = line
+           window insert end default GECTechnology_Multiselect_Multiselect_LBOBJ
+       endif
        f;1
    until (eof)
    close Multiselect

!m100_done
    window unshade GECTechnology_Multiselect_WIN
    return

//******************************
//* Setup the Progress Window 
//* -initialize ProgressCount before calling
//******************************
!p100_open_progress
    if  (GECTechnology_Techview_List_RBOBJ) return
    if  (PlayStatus) 
+       return
+   endif
    window hwnd GECTechnology_Progress_WIN status error window open GECTechnology_Progress_WIN shade
    window center GECTechnology_Progress_WIN
    //window windowpos GECTechnology_Progress_Progressframe_STTXT Progframex Progframey Progframecx Progframecy
    window windowpos GECTechnology_Progress_Progressframe_STTXT Progx Progy Progcx Progcy

    ProgressMax = Progcx - 4

    if (ProgressCount) 
+      Progress = Progcx / ProgressCount
+   else
+      Progress = 1
+   endif
    //message = 'ProgressCount[@ProgressCount@] Progress[@Progress@] Progcx[@Progcx@]' window message info ok    
    b

    Progx += 2
    Progy += 2
    Progcx = 1
    Progcy -= 4

    ProgressShow = Progcx
    window unshade GECTechnology_Progress_WIN

    ProgTextX = Progx + 2
    ProgTextY = Progy

    return

//******************************
//* Show Progress
//******************************
!p200_show_progress
    if  (GECTechnology_Techview_List_RBOBJ) return
    if  (PlayStatus) return
    ProgressWork = ProgressShow + Progress
    Progcx = ProgressWork
    if  (Progcx > ProgressMax) 
+       Progcx = ProgressMax
+   endif
    ProgressShow = ProgressWork
    file PaintFile
    b fs:/GECTechnology_Progress_WIN/ if  (!eof) d 
    b fs:/Rendering.../ if (!eof) d
    Newline = 'GECTechnology_Progress_WIN,Box,Box,@Progx@,@Progy@,@Progcx@,@Progcy@,109,88,238' i:/@Newline@/
    Newline = 'GECTechnology_Progress_WIN,Text,Text,@ProgTextX@,@ProgTextY@,12,12,230,230,230,Default,Rendering...' i:/@Newline@/ 
    //message = Newline window message info ok
    b
    window paint GECTechnology_Progress_WIN
    return

//******************************
//* Close the Progress Window
//******************************
!p300_close_progress
    if  (GECTechnology_Techview_List_RBOBJ) return
    if  (PlayStatus) return
    window close GECTechnology_Progress_WIN error
    return

//****************************************
//* Read and load the GECTechnology.dat file
//****************************************
!t100_data_file
    GECTechnology_Techview_Type_COOBJ = 'ALL'
    window delete GECTechnology_Techview_Type_COOBJ
    window insert end default GECTechnology_Techview_Type_COOBJ
    GECTechnology_Techview_Name_COOBJ = 'ALL'
    window delete GECTechnology_Techview_Name_COOBJ
    window insert end default GECTechnology_Techview_Name_COOBJ
    GECTechnology_Techview_Vendor_COOBJ = 'ALL'
    window delete GECTechnology_Techview_Vendor_COOBJ
    window insert end default GECTechnology_Techview_Vendor_COOBJ
    GECTechnology_Techview_Version_COOBJ = 'ALL'
    window delete GECTechnology_Techview_Version_COOBJ
    window insert end default GECTechnology_Techview_Version_COOBJ
    GECTechnology_Techview_Process_COOBJ = 'ALL'
    window delete GECTechnology_Techview_Process_COOBJ
    window insert end default GECTechnology_Techview_Process_COOBJ
    GECTechnology_Techview_Business_COOBJ = 'ALL'
    window delete GECTechnology_Techview_Business_COOBJ
    window insert end default GECTechnology_Techview_Business_COOBJ
    GECTechnology_Techview_Status_COOBJ = 'ALL'
    window delete GECTechnology_Techview_Status_COOBJ
    window insert end default GECTechnology_Techview_Status_COOBJ
    GECTechnology_Techview_Strategy_COOBJ = 'ALL'
    window delete GECTechnology_Techview_Strategy_COOBJ
    window insert end default GECTechnology_Techview_Strategy_COOBJ

    if  (AlreadyOpen) goto !t100_opened
    AlreadyOpen = 'y'
    open TypeData null
    open NameData null
    open VendorData null
    open VersionData null
    open BusinessData null
    open ProcessData null
    open StatusData null
    open StrategyData null

    close DataFile error
    open DataFile @Filename
    do
        f;1
        if (!eof)
+           scan:/@line/:/|/
+           Key = left pack Key
+           scan:/@right/:/|/
+           Type = left pack Type
+           scan:/@right/:/|/
+           Name = left pack Name
+           scan:/@right/:/|/
+           Description = left pack Description
+           scan:/@right/:/|/
+           Vendor = left pack Vendor
+           scan:/@right/:/|/
+           Version = left pack Version
+           scan:/@right/:/|/
+           Archlayers = left pack Archlayers
+           scan:/@right/:/|/
+           Techstacks = left pack Techstacks
+           scan:/@right/:/|/
+           Size = left pack Size
+           scan:/@right/:/|/
+           Maintenance = left pack Maintenance
+           scan:/@right/:/|/
+           Support = left pack Support
+           scan:/@right/:/|/
+           Hits = left pack Hits
+           scan:/@right/:/|/
+           Process = left pack Process
+           scan:/@right/:/|/
+           Business = left pack Business
+           scan:/@right/:/|/
+           Status = left pack Status
+           scan:/@right/:/|/
+           Strategy = left pack Strategy
+           scan:/@right/:/|/
+           ChangeDate = left pack ChangeDate
+           scan:/@right/:/|/
+           Watch = left pack Watch
+           scan:/@right/:/|/
+           Age = left
+           Comments = right
+           scan:/@Age/:'/'
+           AgeCCYY = left
+           call !t200_dropdown
+       endif
    until (eof)

    sort TypeData,A,1
    sort NameData,A,1
    sort VendorData,A,1
    sort VersionData,A,1
    sort ProcessData,A,1
    sort BusinessData,A,1
    sort StatusData,A,1
    sort StrategyData,A,1

!t100_opened
    file TypeData
    b
    do
        if  (!eof)
+           scan:/@line/:/|/
+           GECTechnology_Techview_Type_COOBJ = left
+           window insert end default GECTechnology_Techview_Type_COOBJ
+       endif
        f;1
    until (eof)
    file NameData
    b
    do
        if  (!eof)
+           scan:/@line/:/|/
+           GECTechnology_Techview_Name_COOBJ = left
+           window insert end default GECTechnology_Techview_Name_COOBJ
+       endif
        f;1
    until (eof)
    file VendorData
    b
    do
        if  (!eof)
+           scan:/@line/:/|/
+           GECTechnology_Techview_Vendor_COOBJ = left
+           window insert end default GECTechnology_Techview_Vendor_COOBJ
+       endif
        f;1
    until (eof)
    file VersionData
    b
    do
        if  (!eof)
+           scan:/@line/:/|/
+           GECTechnology_Techview_Version_COOBJ = left
+           window insert end default GECTechnology_Techview_Version_COOBJ
+       endif
        f;1
    until (eof)
    file ProcessData
    b
    do
        if  (!eof)
+           scan:/@line/:/|/
+           GECTechnology_Techview_Process_COOBJ = left
+           window insert end default GECTechnology_Techview_Process_COOBJ
+       endif
        f;1
    until (eof)
    file BusinessData
    b
    do
        if  (!eof)
+           scan:/@line/:/|/
+           GECTechnology_Techview_Business_COOBJ = left
+           window insert end default GECTechnology_Techview_Business_COOBJ
+       endif
        f;1
    until (eof)
    file StatusData
    b
    do
        if  (!eof)
+           scan:/@line/:/|/
+           GECTechnology_Techview_Status_COOBJ = left
+           window insert end default GECTechnology_Techview_Status_COOBJ
+       endif
        f;1
    until (eof)
    file StrategyData
    b
    do
        if  (!eof)
+           scan:/@line/:/|/
+           GECTechnology_Techview_Strategy_COOBJ = left
+           window insert end default GECTechnology_Techview_Strategy_COOBJ
+       endif
        f;1
    until (eof)
    

    //close TypeData
    //close NameData
    //close VendorData
    //close VersionData
    //close BusinessData 
    //close StatusData
    //close StrategyData
    close DataFile error

    //********************************
    //* Load the Application Dropdown
    //********************************
    GECTechnology_Techview_Application_COOBJ = 'ALL'
    window delete GECTechnology_Techview_Application_COOBJ
    close ApplicationsSorted error
    open ApplicationsSorted null
    close Applications error
    open Applications GECTechnology.app error open Applications null
    b
    do
        if  (!eof)
+           scan:/@line/:/|/
+           SearchString = left
+           scan:/@right/:/|/
+           SearchString = '@SearchString@|@left@'
+           file ApplicationsSorted
+           b
+               fs:/@SearchString@/
+               if (eof)
+                  i:/@SearchString@/
+       endif
        file Applications
        f;1
    until (eof)
    sort ApplicationsSorted,A,1
    file ApplicationsSorted
    b
    do

        if  (!eof)
+           GECTechnology_Techview_Application_COOBJ = line
+           window insert end default GECTechnology_Techview_Application_COOBJ
+       endif
        f;1
    until (eof)
    close ApplicationsSorted
    close Applications

    call !v400_delete_objects
    return

//****************************************
//* Load the Dropdowns
//****************************************
!t200_dropdown
    //*********************
    //* Type
    //*********************
    if  (Type != null)
+       file TypeData
+       b
+       SearchString = '@Type@|'
+       b
+       fs:/@SearchString@/
+       if (eof)
+           i:/@SearchString@/
+           GECTechnology_Techview_Type_COOBJ = '@Type@'
+   endif
    //*********************
    //* Name
    //*********************
    if  (Name != null)
+       file NameData
+       b
+       SearchString = '@Name@|'
+       b
+       fs:/@SearchString@/
+       if (eof)
+           i:/@SearchString@/
+           GECTechnology_Techview_Name_COOBJ = '@Name@'
+   endif
    //*********************
    //* Vendor
    //*********************
    if  (Vendor != null)
+       file VendorData
+       b
+       SearchString = '@Vendor@|'
+       b
+       fs:/@SearchString@/
+       if (eof)
+           i:/@SearchString@/
+           GECTechnology_Techview_Vendor_COOBJ = '@Vendor@'
+   endif
    //*********************
    //* Version
    //*********************
    if  (Version != null)
+       file VersionData
+       b
+       SearchString = '@Version@|'
+       b
+       fs:/@SearchString@/
+       if (eof)
+           i:/@SearchString@/
+           GECTechnology_Techview_Version_COOBJ = '@Version@'
+   endif
    //*********************
    //* Process
    //*********************
    FullProcess = Process
    do
        scan:/@FullProcess@/:/,/
        if  (!found)
+           Process = FullProcess
+           FullProcess = null
+       else
+           Process = left
+           FullProcess = right
+       endif
 
        if  (Process != null)
+           file ProcessData
+           b
+           SearchString = '@Process@|'
+           b
+           fs:/@SearchString@/
+           if (eof)
+               i:/@SearchString@/
+               GECTechnology_Techview_Process_COOBJ = '@Process@'
+       endif
    until (FullProcess = null)
    //*********************
    //* Business
    //*********************
    FullBusiness = Business
    do
        scan:/@FullBusiness@/:/,/
        if  (!found)
+           Business = FullBusiness
+           FullBusiness = null
+       else
+           Business = left
+           FullBusiness = right
+       endif
 
        if  (Business != null)
+           file BusinessData
+           b
+           SearchString = '@Business@|'
+           b
+           fs:/@SearchString@/
+           if (eof)
+               i:/@SearchString@/
+               GECTechnology_Techview_Business_COOBJ = '@Business@'
+       endif
    until (FullBusiness = null)
    //*********************
    //* Status
    //*********************
    if  (Status != null)
+       file StatusData
+       b
+       SearchString = '@Status@|'
+       b
+       fs:/@SearchString@/
+       if (eof)
+           i:/@SearchString@/
+           GECTechnology_Techview_Status_COOBJ = '@Status@'
+   endif
    //*********************
    //* Strategy
    //*********************
    if  (Strategy != null)
+       file StrategyData
+       b
+       SearchString = '@Strategy@|'
+       b
+       fs:/@SearchString@/
+       if (eof)
+           i:/@SearchString@/
+           GECTechnology_Techview_Strategy_COOBJ = '@Strategy@'
+   endif

    file DataFile
    return

//****************************************
//* Display the View
//****************************************
!v100_view
    //close DebugFile error
    //open DebugFile null

    iCountAssess = 0
    iTotalAssess = 0

    iCountTrial = 0
    iTotalTrial = 0

    iCountAdopt = 0
    iTotalAdopt = 0

    iCountHold = 0
    iTotalHold = 0

    iCountMoveOff = 0
    iTotalMoveOff = 0

    DrawLocRetry = 0

    PlatformsRadius = 0
    PlatformsCount = 0
    ToolsRadius = 0
    ToolsCount = 0
    LanguagesRadius = 0
    LanguagesCount = 0

    AddAngle = 37

    ListXpos = 100
    ListYpos = 100
    ListHeight = 12
    ListXBoxPos = ListXpos + 200
    ListCount = 0
    ListStartCount = 0

    close ListFile error
    open ListFile null

    if  (GECTechnology_Techview_Type_COOBJ = 'Platforms')
+       PlatformsAngle = 0
+       PlatformsStartAngle = 0
+       PlatformsEndAngle = 360
+   else
+       PlatformsAngle = 180
+       PlatformsStartAngle = 135
+       PlatformsEndAngle = 265
+   endif

    if  (GECTechnology_Techview_Type_COOBJ = 'Tools')
+       ToolsAngle = 0
+       ToolsStartAngle = 0
+       ToolsEndAngle = 360
+   else
+       ToolsAngle = 45
+       ToolsStartAngle = 5
+       ToolsEndAngle = 125
+   endif

    if  (GECTechnology_Techview_Type_COOBJ = 'Languages')
+       LanguagesAngle = 0
+       LanguagesStartAngle = 0
+       LanguagesEndAngle = 360
+   else
+       LanguagesAngle = 315
+       LanguagesStartAngle = 275
+       LanguagesEndAngle = 355
+   endif

    PlatformsAngle = PlatformsStartAngle
    ToolsAngle = ToolsStartAngle
    LanguagesAngle = LanguagesStartAngle

    window obtain GECTechnology_Techview_WIN

    if-1  (GECTechnology_Techview_Labels_CBOBJ)
+       LabelSize = KeepLabelSize
+   else-1
+       if-2  (LabelSize != 0)
+           KeepLabelSize = LabelSize
+           LabelSize = 0
+       else-2
+           LabelSize = 0
+   endif

    if  (GECTechnology_Techview_List_RBOBJ)
+       Zoom = 1
+       window show GECTechnology_Techview_Prev_PBOBJ
+       window show GECTechnology_Techview_Next_PBOBJ
+   else
+       window hide GECTechnology_Techview_Prev_PBOBJ
+       window hide GECTechnology_Techview_Next_PBOBJ
+   endif

    if  (GECTechnology_Techview_Polar_RBOBJ)
+       window size GECTechnology_Techview_Labels_CBOBJ 786 1 76 15
+       window size GECTechnology_Techview_Minus_PBOBJ 862 1 17 16
+       window size GECTechnology_Techview_Plus_PBOBJ 880 1 17 16
+       window size GECTechnology_Techview_Labelsize_EFOBJ 900 1 20 20
+       window size GECTechnology_Techview_Strategylines_CBOBJ 786 15 76 15
+       window size GECTechnology_Techview_Average_CBOBJ 786 30 76 15
+       window show GECTechnology_Techview_Zoom_GBOBJ
+       window show GECTechnology_Techview_Zoomup_PBOBJ
+       window show GECTechnology_Techview_Zoomleft_PBOBJ
+       window show GECTechnology_Techview_Zoomout_PBOBJ
+       window show GECTechnology_Techview_Zoomin_PBOBJ
+       window show GECTechnology_Techview_Zoomright_PBOBJ
+       window show GECTechnology_Techview_Zoomdown_PBOBJ
+       window size GECTechnology_Techview_Refresh_PBOBJ 1154 110 60 24
+       window show GECTechnology_Techview_Legend_PBOBJ
+   else
+       Zoom = 1
+       window size GECTechnology_Techview_Labels_CBOBJ 636 1 76 15
+       window size GECTechnology_Techview_Minus_PBOBJ 712 1 17 16
+       window size GECTechnology_Techview_Plus_PBOBJ 730 1 17 16
+       window size GECTechnology_Techview_Labelsize_EFOBJ 750 1 20 20
+       window size GECTechnology_Techview_Strategylines_CBOBJ 636 15 76 15
+       window size GECTechnology_Techview_Average_CBOBJ 636 30 76 15
+       window hide GECTechnology_Techview_Zoom_GBOBJ
+       window hide GECTechnology_Techview_Zoomup_PBOBJ
+       window hide GECTechnology_Techview_Zoomleft_PBOBJ
+       window hide GECTechnology_Techview_Zoomout_PBOBJ
+       window hide GECTechnology_Techview_Zoomin_PBOBJ
+       window hide GECTechnology_Techview_Zoomright_PBOBJ
+       window hide GECTechnology_Techview_Zoomdown_PBOBJ
+       window size GECTechnology_Techview_Refresh_PBOBJ 1154 25 60 24
+       window hide GECTechnology_Techview_Legend_PBOBJ
+   endif

    if  (GECTechnology_Techview_Strategylines_CBOBJ)
+       StrategyLines = 'Y'
+   else
+       StrategyLines = 'N'
+   endif

    if  (GECTechnology_Techview_Average_CBOBJ)
+       Average = 'Y'
+   else
+       Average = 'N'
+   endif

    if  (GECTechnology_Techview_Lines_RBOBJ)
+       SizeParm = 'Lines'
+   endif
    if  (GECTechnology_Techview_Maintenance_RBOBJ)
+       SizeParm = 'Maintenance'
+   endif
    if  (GECTechnology_Techview_Support_RBOBJ)
+       SizeParm = 'Support'
+   endif
    if  (GECTechnology_Techview_Hits_RBOBJ)
+       SizeParm = 'Hits'
+   endif

    if  (GECTechnology_Techview_Polar_RBOBJ)
+       //************************************
+       //* Polar View
+       //************************************
+       close PaintFile error
+       open PaintFile null
+       i:/@LogoLine@/
+       fRingSize = 640 * Zoom iRingSize = fRingSize Newline = 'GECTechnology_Techview_WIN,Ellipse,Ellipse,625,325,@iRingSize@,@iRingSize@,255,213,213' i:/@Newline@/       // Move Off
+       fRingSize = 550 * Zoom iRingSize = fRingSize Newline = 'GECTechnology_Techview_WIN,Ellipse,Ellipse,625,325,@iRingSize@,@iRingSize@,252,255,213' i:/@Newline@/       // Hold
+       fRingSize = 450 * Zoom iRingSize = fRingSize Newline = 'GECTechnology_Techview_WIN,Ellipse,Ellipse,625,325,@iRingSize@,@iRingSize@,224,213,255' i:/@Newline@/       // Assess
+       fRingSize = 350 * Zoom iRingSize = fRingSize Newline = 'GECTechnology_Techview_WIN,Ellipse,Ellipse,625,325,@iRingSize@,@iRingSize@,213,239,255' i:/@Newline@/       // Trial
+       fRingSize = 250 * Zoom iRingSize = fRingSize Newline = 'GECTechnology_Techview_WIN,Ellipse,Ellipse,625,325,@iRingSize@,@iRingSize@,213,255,214' i:/@Newline@/       // Adopt
+       call !v105_Polar_separators   
+       //window hide GECTechnology_Techview_Average_CBOBJ
+       window hide GECTechnology_Techview_Background_CBOBJ
+       window hide GECTechnology_Techview_Yaxis_GBOBJ
+       window hide GECTechnology_Techview_Age_RBOBJ
+       window hide GECTechnology_Techview_Size_RBOBJ
+       window hide GECTechnology_Techview_Draw_GBOBJ
+       window hide GECTechnology_Techview_Across_RBOBJ
+       window hide GECTechnology_Techview_Down_RBOBJ
+       window hide GECTechnology_Techview_Age1_STTXT
+       window hide GECTechnology_Techview_Age2_STTXT
+       window hide GECTechnology_Techview_Age3_STTXT
+       window hide GECTechnology_Techview_Age-10Plus_STTXT
+       window hide GECTechnology_Techview_Age-10+_STTXT
+       window hide GECTechnology_Techview_Age-6-9_STTXT
+       window hide GECTechnology_Techview_Age-4-6_STTXT
+       window hide GECTechnology_Techview_Age-2-3_STTXT
+       window hide GECTechnology_Techview_Age-0-1_STTXT
+       window hide GECTechnology_Techview_Separator1_STTXT
+       window hide GECTechnology_Techview_Separator2_STTXT
+       window hide GECTechnology_Techview_Separator3_STTXT
+       window hide GECTechnology_Techview_Separator4_STTXT
+       window hide GECTechnology_Techview_XAxis_PBOBJ
+       window hide GECTechnology_Techview_YAxis_PBOBJ
+       window hide GECTechnology_Techview_Assess_STTXT
+       window hide GECTechnology_Techview_Trial_STTXT
+       window hide GECTechnology_Techview_Adopt_STTXT
+       window hide GECTechnology_Techview_Hold_STTXT
+       window hide GECTechnology_Techview_MoveOff_STTXT
+       goto !V100_begin
+   endif

    if-1  (GECTechnology_Techview_List_RBOBJ)
+       if-2  (ListPage = 1)
+           window disable GECTechnology_Techview_Prev_PBOBJ
+       else-2
+           window enable GECTechnology_Techview_Prev_PBOBJ
+   endif

    if  (GECTechnology_Techview_List_RBOBJ)
+       //************************************
+       //* List View
+       //************************************
+       close PaintFile error
+       open PaintFile null
+       i:/@LogoLine@/
+       window hide GECTechnology_Techview_Background_CBOBJ
+       window hide GECTechnology_Techview_Yaxis_GBOBJ
+       window hide GECTechnology_Techview_Age_RBOBJ
+       window hide GECTechnology_Techview_Size_RBOBJ
+       window hide GECTechnology_Techview_Draw_GBOBJ
+       window hide GECTechnology_Techview_Across_RBOBJ
+       window hide GECTechnology_Techview_Down_RBOBJ
+       window hide GECTechnology_Techview_Age1_STTXT
+       window hide GECTechnology_Techview_Age2_STTXT
+       window hide GECTechnology_Techview_Age3_STTXT
+       window hide GECTechnology_Techview_Age-10Plus_STTXT
+       window hide GECTechnology_Techview_Age-10+_STTXT
+       window hide GECTechnology_Techview_Age-6-9_STTXT
+       window hide GECTechnology_Techview_Age-4-6_STTXT
+       window hide GECTechnology_Techview_Age-2-3_STTXT
+       window hide GECTechnology_Techview_Age-0-1_STTXT
+       window hide GECTechnology_Techview_Separator1_STTXT
+       window hide GECTechnology_Techview_Separator2_STTXT
+       window hide GECTechnology_Techview_Separator3_STTXT
+       window hide GECTechnology_Techview_Separator4_STTXT
+       window hide GECTechnology_Techview_XAxis_PBOBJ
+       window hide GECTechnology_Techview_YAxis_PBOBJ
+       window hide GECTechnology_Techview_Assess_STTXT
+       window hide GECTechnology_Techview_Trial_STTXT
+       window hide GECTechnology_Techview_Adopt_STTXT
+       window hide GECTechnology_Techview_Hold_STTXT
+       window hide GECTechnology_Techview_MoveOff_STTXT
+       goto !V100_begin
+   endif

    window show GECTechnology_Techview_Average_CBOBJ
    window show GECTechnology_Techview_Background_CBOBJ
    window show GECTechnology_Techview_Yaxis_GBOBJ
    window show GECTechnology_Techview_Age_RBOBJ
    window show GECTechnology_Techview_Size_RBOBJ
    window show GECTechnology_Techview_Draw_GBOBJ
    window show GECTechnology_Techview_Across_RBOBJ
    window show GECTechnology_Techview_Down_RBOBJ
    window show GECTechnology_Techview_Age1_STTXT
    window show GECTechnology_Techview_Age2_STTXT
    window show GECTechnology_Techview_Age3_STTXT
    window show GECTechnology_Techview_Age-10Plus_STTXT
    window show GECTechnology_Techview_Age-10+_STTXT
    window show GECTechnology_Techview_Age-6-9_STTXT
    window show GECTechnology_Techview_Age-4-6_STTXT
    window show GECTechnology_Techview_Age-2-3_STTXT
    window show GECTechnology_Techview_Age-0-1_STTXT
    window show GECTechnology_Techview_Separator1_STTXT
    window show GECTechnology_Techview_Separator2_STTXT
    window show GECTechnology_Techview_Separator3_STTXT
    window show GECTechnology_Techview_Separator4_STTXT
    window show GECTechnology_Techview_XAxis_PBOBJ
    window show GECTechnology_Techview_YAxis_PBOBJ
    window show GECTechnology_Techview_Assess_STTXT
    window show GECTechnology_Techview_Trial_STTXT
    window show GECTechnology_Techview_Adopt_STTXT
    window show GECTechnology_Techview_Hold_STTXT
    window show GECTechnology_Techview_MoveOff_STTXT

    if  (GECTechnology_Techview_Age_RBOBJ)
+       Displayby = 'Age'
+   else
+       Displayby = 'Size'
+   endif

    if  (GECTechnology_Techview_Background_CBOBJ)
+       Background = 'Y'
+   else
+       Background = 'N'
+   endif
    if  (GECTechnology_Techview_Across_RBOBJ)
+       DrawDirection = 'Across'
+   else
+       DrawDirection = 'Down'
+   endif

    close PaintFile error
    open PaintFile null
    i:/@LogoLine@/

    //**********************
    //* Background
    //**********************
    if  (Background)
+       Newline = 'GECTechnology_Techview_WIN,Box,Box,0,0,1500,1000,239,239,239' i:/@Newline@/ 
+   endif

    //**********************
    //* Color Panels
    //**********************
    if  (Background)
+       Newline = 'GECTechnology_Techview_WIN,Box,Box,25,60,155,550,224,213,255' i:/@Newline@/      //Assess   
+       Newline = 'GECTechnology_Techview_WIN,Box,Box,155,60,315,550,213,239,255' i:/@Newline@/     //Trial
+       Newline = 'GECTechnology_Techview_WIN,Box,Box,315,60,905,550,213,255,214' i:/@Newline@/     //Adopt
+       Newline = 'GECTechnology_Techview_WIN,Box,Box,905,60,1165,550,252,255,213' i:/@Newline@/    //Hold
+       Newline = 'GECTechnology_Techview_WIN,Box,Box,1165,60,1300,550,255,213,213' i:/@Newline@/   //Move Off
+   endif
   
!V100_begin
    //**********************
    //* Index Balls
    //**********************
    if  (Colors3D)    
+       Newline = 'GECTechnology_Techview_WIN,BitmapFit,BitmapFit,1224,4,15,15,GECTechBallGreen.bmp' i:/@Newline@/
+       Newline = 'GECTechnology_Techview_WIN,BitmapFit,BitmapFit,1224,22,15,15,GECTechBallBlue.bmp' i:/@Newline@/       
+       Newline = 'GECTechnology_Techview_WIN,BitmapFit,BitmapFit,1224,39,15,15,GECTechBallOrange.bmp' i:/@Newline@/
+   else
+       Newline = 'GECTechnology_Techview_WIN,Ellipse3D,Ellipse3D,1232,12,15,15,@LanguagesColor@' i:/@Newline@/     
+       Newline = 'GECTechnology_Techview_WIN,Ellipse3D,Ellipse3D,1232,30,15,15,@ToolsColor@' i:/@Newline@/       
+       Newline = 'GECTechnology_Techview_WIN,Ellipse3D,Ellipse3D,1232,47,15,15,@PlatformsColor@' i:/@Newline@/
+   endif

    //**********************
    //* Index Text
    //**********************
    Newline = 'GECTechnology_Techview_WIN,Text,Text,1250,5,12,12,0,0,0,Default,Languages' i:/@Newline@/ 
    Newline = 'GECTechnology_Techview_WIN,Text,Text,1250,22,12,12,0,0,0,Default,Tools' i:/@Newline@/  
    Newline = 'GECTechnology_Techview_WIN,Text,Text,1250,39,12,12,0,0,0,Default,Platforms' i:/@Newline@/ 

    //**********************
    //* List View Titles
    //**********************
    if  (GECTechnology_Techview_List_RBOBJ)  
+       Newline = 'GECTechnology_Techview_WIN,Text,Text,100,75,18,18,0,0,0,Times New Roman,Technology' i:/@Newline@/ 
+       Newline = 'GECTechnology_Techview_WIN,Text,Text,300,80,18,18,0,0,0,Times New Roman,0' i:/@Newline@/
+       Newline = 'GECTechnology_Techview_WIN,Text,Text,537,80,18,18,0,0,0,Times New Roman,125K' i:/@Newline@/ 
+       Newline = 'GECTechnology_Techview_WIN,Text,Text,775,80,18,18,0,0,0,Times New Roman,1M' i:/@Newline@/ 
+       Newline = 'GECTechnology_Techview_WIN,Text,Text,1012,80,18,18,0,0,0,Times New Roman,3.5M' i:/@Newline@/ 
+       Newline = 'GECTechnology_Techview_WIN,Text,Text,1250,80,18,18,0,0,0,Times New Roman,5M+' i:/@Newline@/ 
+   endif

    call !v400_delete_objects
    window obtain GECTechnology_Techview_WIN
    if  (GECTechnology_Techview_Application_COOBJ != null)
+       close Applications error
+       open Applications GECTechnology.app error open Applications null
+   endif
    close ObjectsFile error
    open ObjectsFile null
    close DataFile error
    //Filename = 'GECTechnology.dat'

    open DataFile @Filename error message = 'Unable to read @Filename@' window message warning ok open DataFile GECTechnology.dat Filename = 'GECTechnology'
    b

    if  (GECTechnology_Techview_List_RBOBJ)
+       call !v102_sort_list
+   endif

    if-1  (Filename = 'GECTechnology.dat')
+       GECTechnology_Techview_WIN = 'GEC Technology'
+       if-2  (FilterDesc != null)
+           GECTechnology_Techview_WIN = '@GECTechnology_Techview_WIN@ - @FilterDesc@'
+   else-1
+       GECTechnology_Techview_WIN = 'GEC Technology on @Filename[22-23]@/@Filename[24-25]@/@Filename[18-21]@ at @Filename[27-28]@:@Filename[29-30]@:@Filename[31-32]@'
+   endif

    window title GECTechnology_Techview_WIN

    //Xpos = 40
    //Ypos = 70
    Ymax = 0
    Xstart = Xpos
    Xend = 280 
    ObjectCount = 0


    file DataFile
    b
    f;*
    ProgressCount = pcount
    call !p100_open_progress
    file DataFile
    b
    
    ListCurrPage = 1

    window enable GECTechnology_Techview_Next_PBOBJ
    do
        file DataFile
        f;1
        if  (eof)
+           window disable GECTechnology_Techview_Next_PBOBJ
+       endif
        if-1 (!eof)
+           FullLine = line
+           scan:/@line/:/|/
+           Key = left pack Key
+           scan:/@right/:/|/
+           Type = left pack Type
+           scan:/@right/:/|/
+           Name = left pack Name
+           scan:/@right/:/|/
+           Description = left pack Description
+           scan:/@right/:/|/
+           Vendor = left pack Vendor
+           scan:/@right/:/|/
+           Version = left pack Version
+           scan:/@right/:/|/
+           Archlayers = left pack Archlayers
+           scan:/@right/:/|/
+           Techstacks = left pack Techstacks
+           scan:/@right/:/|/
+           Size = left pack Size
+           fSize = Size
+           scan:/@right/:/|/
+           Maintenance = left pack Maintenance
+           fMaintenance = Maintenance
+           scan:/@right/:/|/
+           Support = left pack Support
+           fSupport = Support
+           scan:/@right/:/|/
+           Hits = left pack Hits
+           fHits = Hits
+           scan:/@right/:/|/
+           Process = left pack Process
+           scan:/@right/:/|/
+           Business = left pack Business
+           scan:/@right/:/|/
+           Status = left pack Status
+           scan:/@right/:/|/
+           Strategy = left pack Strategy
+           scan:/@right/:/|/
+           ChangeDate = left pack ChangeDate
+           scan:/@right/:/|/
+           Watch = left pack Watch
+           scan:/@right/:/|/
+           Age = left
+           Comments = right
+           scan:/@Age/:'/'
+           AgeCCYY = left
+           call !v200_filter
+           call !p200_show_progress
+           file DataFile
+           if-2  (GECTechnology_Techview_List_RBOBJ)
+               if-3 (ListCount >= ListMax)
+                   if-4  (ListPage <= ListCurrPage)
+                       f;*
+                   else-4
+                       ListCount = 0
+                       ListCurrPage ++
+       endif
    until (eof)

    ListPage = ListCurrPage 

    if  (GECTechnology_Techview_List_RBOBJ)
+       //sort ListFile,A,1
+       call !v260_paint_list
+   endif
    close DataFile
 
    call !p300_close_progress
    //write PaintFile fgb.dat

    //**********************
    //* Size by Groupbox Background
    //**********************
    file PaintFile
    if  (Background)
+       Newline = 'GECTechnology_Techview_WIN,Box,Box,931,9,131,62,239,239,239' i:/@Newline@/ 
+       Newline = 'GECTechnology_Techview_WIN,Box,Box,1064,9,84,62,239,239,239' i:/@Newline@/ 
+   else
+       Newline = 'GECTechnology_Techview_WIN,Box,Box,931,9,131,62,255,255,255' i:/@Newline@/ 
+       Newline = 'GECTechnology_Techview_WIN,Box,Box,1064,9,84,62,255,255,255' i:/@Newline@/ 
+   endif

    if  (GECTechnology_Techview_Polar_RBOBJ)
+       Newline = 'GECTechnology_Techview_WIN,Box,Box,1150,9,66,90,239,239,239' i:/@Newline@/ 
+   endif

    if-1  (GECTechnology_Techview_XY_RBOBJ)
+       //**********************
+       //* Axis Hilights
+       //**********************
+       file PaintFile
+       Newline = 'GECTechnology_Techview_WIN,Line,Line,23,60,23,552,255,255,255' i:/@Newline@/ 
+       Newline = 'GECTechnology_Techview_WIN,Line,Line,24,60,24,552,255,255,255' i:/@Newline@/ 
+       Newline = 'GECTechnology_Techview_WIN,Box,Box,35,60,2,540,0,0,0' i:/@Newline@/ 
+       Newline = 'GECTechnology_Techview_WIN,Line,Line,37,598,1400,598,255,255,255' i:/@Newline@/ 
+       Newline = 'GECTechnology_Techview_WIN,Line,Line,37,599,1400,599,255,255,255' i:/@Newline@/ 
+       Newline = 'GECTechnology_Techview_WIN,Box,Box,25,610,1400,2,0,0,0' i:/@Newline@/ 
+   else-1
+       if  (GECTechnology_Techview_Polar_RBOBJ)
+           file PaintFile
+           f;*
+           fRingSize = 300 * Zoom iRingSize = fRingSize + 325 Newline = 'GECTechnology_Techview_WIN,Text,Text,600,@iRingSize@,15,15,255,50,50,Times New Roman,Move Off' i:/@Newline@/ 
+           fRingSize = 255 * Zoom iRingSize = fRingSize + 325 Newline = 'GECTechnology_Techview_WIN,Text,Text,610,@iRingSize@,15,15,255,50,50,Times New Roman,Hold' i:/@Newline@/ 
+           fRingSize = 205 * Zoom iRingSize = fRingSize + 325 Newline = 'GECTechnology_Techview_WIN,Text,Text,600,@iRingSize@,15,15,255,50,50,Times New Roman,Assess' i:/@Newline@/ 
+           fRingSize = 155 * Zoom iRingSize = fRingSize + 325 Newline = 'GECTechnology_Techview_WIN,Text,Text,610,@iRingSize@,15,15,255,50,50,Times New Roman,Trial' i:/@Newline@/ 
+           fRingSize = 105 * Zoom iRingSize = fRingSize + 325 Newline = 'GECTechnology_Techview_WIN,Text,Text,605,@iRingSize@,15,15,255,50,50,Times New Roman,Adopt' i:/@Newline@/ 
+   endif

    //************************************
    //* Ball position retry count
    //************************************
    //file PaintFile
    //f;*
    //Newline = 'GECTechnology_Techview_WIN,Text,Text,1,1,15,15,0,0,0,Times New Roman,Retry=@DrawLocRetry@' i:/@Newline@/
    
    //write PaintFile fgbpaint.dat

    //write DebugFile fgbdebug.dat

    //************************************
    //* Polar Titles
    //************************************
    if  (GECTechnology_Techview_Polar_RBOBJ)
+       if  (GECTechnology_Techview_Type_COOBJ = 'Platforms') or (GECTechnology_Techview_Type_COOBJ = 'ALL') or (GECTechnology_Techview_Type_COOBJ = null)
+           Newline = 'GECTechnology_Techview_WIN,Text,Text,151,311,25,25,0,0,0,Times New Roman,Platforms' i:/@Newline@/ 
+           Newline = 'GECTechnology_Techview_WIN,Text,Text,150,310,25,25,@PlatformsColor@,Times New Roman,Platforms' i:/@Newline@/ 
+   endif

    if  (GECTechnology_Techview_Polar_RBOBJ)
+       if  (GECTechnology_Techview_Type_COOBJ = 'Tools') or (GECTechnology_Techview_Type_COOBJ = 'ALL') or (GECTechnology_Techview_Type_COOBJ = null)
+           Newline = 'GECTechnology_Techview_WIN,Text,Text,901,101,25,25,0,0,0,Times New Roman,Tools' i:/@Newline@/ 
+           Newline = 'GECTechnology_Techview_WIN,Text,Text,900,100,25,25,@ToolsColor@,Times New Roman,Tools' i:/@Newline@/ 
+   endif

    if  (GECTechnology_Techview_Polar_RBOBJ)
+       if  (GECTechnology_Techview_Type_COOBJ = 'Languages') or (GECTechnology_Techview_Type_COOBJ = 'ALL') or (GECTechnology_Techview_Type_COOBJ = null)
+           Newline = 'GECTechnology_Techview_WIN,Text,Text,901,541,25,25,0,0,0,Times New Roman,Languages' i:/@Newline@/ 
+           Newline = 'GECTechnology_Techview_WIN,Text,Text,900,540,25,25,@LanguagesColor@,Times New Roman,Languages' i:/@Newline@/ 
+   endif

    //************************************
    //* Averages
    //************************************
    if  (!Average)
+       window paint GECTechnology_Techview_WIN
+       return
+   endif

    if  (GECTechnology_Techview_List_RBOBJ)
+       window paint GECTechnology_Techview_WIN
+       return
+   endif

    //write PaintFile fgbpaint.dat
    file PaintFile
    f;*

    if  (GECTechnology_Techview_Polar_RBOBJ)
+       call !v101_Polar_averages
+       call !v900_html
+       window paint GECTechnology_Techview_WIN
+       return
+   endif

    //**************** Assess to Trial
    if  (iCountAssess = 0) 
+       Ypos = 596
+   else
+       fAverage = iTotalAssess / iCountAssess
+       Ypos = fAverage
+   endif

    window windowpos GECTechnology_Techview_Assess_STTXT Xpos StrategyCY StatusX StatusY
    window windowpos GECTechnology_Techview_Trial_STTXT StrategyCX StrategyCY StatusX StatusY
    Xpos += 15

    if  (iCountTrial = 0) 
+       StrategyCY = 596
+   else
+       fAverage = iTotalTrial / iCountTrial
+       StrategyCY = fAverage
+   endif

    Newline = 'GECTechnology_Techview_WIN,Line,Line,@Xpos@,@Ypos@,@StrategyCX@,@StrategyCY@,255,0,0'
    i:/@Newline@/
    Newline = 'GECTechnology_Techview_WIN,Line,Line,@StrategyCX@,@StrategyCY@,@Xpos@,@Ypos@,255,0,0'
    i:/@Newline@/
    Ypos = StrategyCY

    //**************** Trial to Adopt
    window windowpos GECTechnology_Techview_Trial_STTXT Xpos StrategyCY StatusX StatusY
    window windowpos GECTechnology_Techview_Adopt_STTXT StrategyCX StrategyCY StatusX StatusY

    if  (iCountAdopt = 0) 
+       StrategyCY = 596
+   else
+       fAverage = iTotalAdopt / iCountAdopt
+       StrategyCY = fAverage
+   endif

    Newline = 'GECTechnology_Techview_WIN,Line,Line,@Xpos@,@Ypos@,@StrategyCX@,@StrategyCY@,255,0,0'
    i:/@Newline@/
    Ypos = StrategyCY

    //**************** Adopt to Hold
    window windowpos GECTechnology_Techview_Adopt_STTXT Xpos StrategyCY StatusX StatusY
    window windowpos GECTechnology_Techview_Hold_STTXT StrategyCX StrategyCY StatusX StatusY

    if  (iCountHold = 0) 
+       StrategyCY = 596
+   else
+       fAverage = iTotalHold / iCountHold
+       StrategyCY = fAverage
+   endif

    Newline = 'GECTechnology_Techview_WIN,Line,Line,@Xpos@,@Ypos@,@StrategyCX@,@StrategyCY@,255,0,0'
    i:/@Newline@/
    Ypos = StrategyCY

    //**************** Hold to MoveOff
    window windowpos GECTechnology_Techview_Hold_STTXT Xpos StrategyCY StatusX StatusY
    window windowpos GECTechnology_Techview_MoveOff_STTXT StrategyCX StrategyCY StatusX StatusY

    if  (iCountMoveOff = 0) 
+       StrategyCY = 596
+   else
+       fAverage = iTotalMoveOff / iCountMoveOff
+       StrategyCY = fAverage
+   endif

    Newline = 'GECTechnology_Techview_WIN,Line,Line,@Xpos@,@Ypos@,@StrategyCX@,@StrategyCY@,255,0,0'
    i:/@Newline@/
    Ypos = StrategyCY
 
    //write PaintFile fgb.dat
    window paint GECTechnology_Techview_WIN
    return

//****************************************
//* Create the Polar Average Lines
//****************************************
!v101_Polar_averages
    float ToolsAvg error
    float PlatformsAvg error
    float LanguagesAvg error

    if  (ToolsCount < 1)
+       ToolsAvg = 1
+   else
+       ToolsAvg = ToolsRadius / ToolsCount
+   endif
    if  (PlatformsCount < 1)
+       PlatformsAvg = 1
+   else
+       PlatformsAvg = PlatformsRadius / PlatformsCount
+   endif
    if  (LanguagesCount < 1)
+       LanguagesAvg = 1
+   else
+       LanguagesAvg = LanguagesRadius / LanguagesCount
+   endif

    //message = 'ToolsAvg[@ToolsAvg@] PlatformsAvg[@PlatformsAvg@] LanguagesAvg[@LanguagesAvg@]' window message info ok

    file PaintFile
    f;*    

    //*********************************
    //* Draw from Platforms to Tools
    //*********************************
    Xpos = 625 - PlatformsAvg
    Ypos = 325

    Angle = 65
    CosineDistance = cos(Angle)
    fXpos = ToolsAvg * CosineDistance
    StrategyCX = fXpos
    StrategyCX += 625
    SinDistance = sin(Angle)
    fYpos = ToolsAvg * SinDistance
    StrategyCY = fYpos * -1
    StrategyCY += 325
    Newline = 'GECTechnology_Techview_WIN,Line,Line,@Xpos@,@Ypos@,@StrategyCX@,@StrategyCY@,255,0,0' i:/@Newline@/

    //*********************************
    //* Draw from Tools to Languages
    //*********************************
    Xpos = StrategyCX
    Ypos = StrategyCY

    Angle = 315
    CosineDistance = cos(Angle)
    fXpos = LanguagesAvg * CosineDistance
    StrategyCX = fXpos
    StrategyCX += 625
    SinDistance = sin(Angle)
    fYpos = LanguagesAvg * SinDistance
    StrategyCY = fYpos * -1
    StrategyCY += 325
    Newline = 'GECTechnology_Techview_WIN,Line,Line,@Xpos@,@Ypos@,@StrategyCX@,@StrategyCY@,255,0,0' i:/@Newline@/

    //*********************************
    //* Draw from Languages to Platforms
    //*********************************
    Xpos = StrategyCX
    Ypos = StrategyCY

    StrategyCX = 625 - PlatformsAvg
    StrategyCY = 325
    Newline = 'GECTechnology_Techview_WIN,Line,Line,@Xpos@,@Ypos@,@StrategyCX@,@StrategyCY@,255,0,0' i:/@Newline@/

    return

//****************************************
//* Sort the DataFile for List View
//****************************************
!v102_sort_list
    file DataFile
    b
    Newline = '0000|@line@' r:/@Newline@/
    do
        f;1
        if  (!eof)
+           scan:/@line/:/|/
+           scan:/@right/:/|/
+           scan:/@right/:/|/
+           Newline = '@left@|@line@'
+           r:/@Newline@/
+       endif
    until (eof)
    sort DataFile,A,1
    do
        if  (!eof)
+           scan:/@line/:/|/
+           Newline = right
+           r:/@Newline@/
+       endif
        f;1
    until (eof)
    b
    return

//****************************************
//* Create the Polar separator lines
//****************************************
!v105_Polar_separators
    if  (GECTechnology_Techview_Type_COOBJ = 'Platforms') or (GECTechnology_Techview_Type_COOBJ = 'Tools') or (GECTechnology_Techview_Type_COOBJ = 'Languages') 
+       return
+   endif

    //****************************
    //* Line Center to upper left
    //****************************
    Angle = 130
    CosineDistance = cos(Angle)
    fRingSize = 320 * Zoom
    fXpos = fRingSize * CosineDistance
    Xpos = fXpos + 625
    SinDistance = sin(Angle)
    fYpos = fRingSize * SinDistance
    Ypos = fYpos * -1
    Ypos += 325
    Newline = 'GECTechnology_Techview_WIN,Line,Line,625,325,@Xpos@,@Ypos@,100,100,100' i:/@Newline@/ 

    //****************************
    //* Line Center downwards
    //****************************
    fRingSize = 640 * Zoom
    fRingSize = fRingSize / 2
    iRingSize = 325 - fRingSize 
    Newline = 'GECTechnology_Techview_WIN,Line,Line,625,325'
    iRingSize = 325 + fRingSize Newline = '@Newline@,625,@iRingSize@,100,100,100' i:/@Newline@/ 

    //****************************
    //* Line Center to right
    //****************************
    fRingSize = 320 * Zoom iRingSize = fRingSize + 625 Newline = 'GECTechnology_Techview_WIN,Line,Line,625,325,@iRingSize@,325,100,100,100' i:/@Newline@/
    return

//****************************************
//* Filter the Data
//****************************************
!v200_filter
    if  (GECTechnology_Techview_Type_COOBJ = 'ALL') or (GECTechnology_Techview_Type_COOBJ = null)
+   else
+       if  (GECTechnology_Techview_Type_COOBJ != Type)
+           return
+   endif
    if  (GECTechnology_Techview_Name_COOBJ = 'ALL') or (GECTechnology_Techview_Name_COOBJ = null)
+   else
+       if  (GECTechnology_Techview_Name_COOBJ != Name)
+           return
+   endif
    if  (GECTechnology_Techview_Vendor_COOBJ = 'ALL') or (GECTechnology_Techview_Vendor_COOBJ = null)
+   else
+       if  (GECTechnology_Techview_Vendor_COOBJ != Vendor)
+           return
+   endif
    if  (GECTechnology_Techview_Version_COOBJ = 'ALL') or (GECTechnology_Techview_Version_COOBJ = null)
+   else
+       if  (GECTechnology_Techview_Version_COOBJ != Version)
+           return
+   endif
    if  (GECTechnology_Techview_Archlayers_EFOBJ != null)
+       call !w100_archlayers_filter
+       if  (!Keepit)
+           return
+   endif
    if  (GECTechnology_Techview_Techstacks_EFOBJ != null)
+       call !w200_techstacks_filter
+       if  (!Keepit)
+           return
+   endif

    if  (GECTechnology_Techview_Process_COOBJ = 'ALL') or (GECTechnology_Techview_Process_COOBJ = null)
+   else
+       scan:/@Process@/:/@GECTechnology_Techview_Process_COOBJ@/
+       if  (!found)
+           return
+   endif

    if  (GECTechnology_Techview_Followup_CBOBJ)
+       if  (!Watch)
+           return
+   endif

    if (GECTechnology_Techview_Application_COOBJ = null)
+      goto !v200_business
+   else
+       call !v210_application
+       if   (NoMatchApplication)
+            return
+   endif

!v200_business
    if  (GECTechnology_Techview_Business_COOBJ = 'ALL') or (GECTechnology_Techview_Business_COOBJ = null)
+   else
+       scan:/@Business@/:/@GECTechnology_Techview_Business_COOBJ@/
+       if  (!found)
+           return
+   endif

!v200_status
    if  (GECTechnology_Techview_Status_COOBJ = 'ALL') or (GECTechnology_Techview_Status_COOBJ = null)
+   else
+       if  (GECTechnology_Techview_Status_COOBJ != Status)
+           return
+   endif
    if  (GECTechnology_Techview_Strategy_COOBJ = 'ALL') or (GECTechnology_Techview_Strategy_COOBJ = null)
+   else
+       if  (GECTechnology_Techview_Strategy_COOBJ != Strategy)
+           return
+   endif

    //***********************
    //* Search And/Or
    //***********************
    pack GECTechnology_Techview_Description_EFOBJ
    if  (GECTechnology_Techview_Description_EFOBJ = null) goto !v200_no_search_andor
    SearchDesc = GECTechnology_Techview_Description_EFOBJ
    SearchType = 'and'
    scan:/@SearchDesc/:/ or /
    if  (found)
+       SearchType = 'or'
+   endif
    do
        scan:/@SearchDesc/:/ and /
        if  (found) SearchDesc = '@left@ @right@'
    until (!found)
    do
        scan:/@SearchDesc/:/ or /
        if  (found) SearchDesc = '@left@ @right@'
    until (!found)

    SearchFound = 'n'
    do   
        scan:/@SearchDesc/:word     
        SearchDesc = right  
        if-1  (left != null)
+           SearchString = left
+           pattern on
+           case off
+           scan:/@FullLine@/:/@SearchString@/
+           case on
+           pattern off
+           if-2  (found)
+               SearchFound = 'y'
+           else-2
+               if-3  (SearchType = 'and')
+                   return
+       endif
    until (SearchDesc = null)
    if  (!SearchFound)
+       return
+   endif

!v200_no_search_andor
    if  (GECTechnology_Techview_Update_EFOBJ != null)
+       if  (ChangeDate >= GECTechnology_Techview_Update_EFOBJ)
+           return
+   endif

    //*****************************************
    //* Filtering Complete
    //*****************************************

    //message = 'keep @line@' window message info ok
    ObjectCount ++
    ObjectName = "Object-@ObjectCount@"
    ObjectText = null
    if  (Type = "Languages")
+       ObjectText = "L"
+   endif
    if  (Type = "Platforms")
+       ObjectText = "P"
+   endif
    if  (Type = "Tools")
+       ObjectText = "T"
+   endif
    split:/@Strategy/;1
    ObjectText = left

    Xsize = 10
    Ysize = 10

    //*****************************************
    //* Set the size of the Ball
    //*****************************************
    if  (SizeParm = 'Maintenance') fSize = fMaintenance
    if  (SizeParm = 'Support') fSize = fSupport
    if  (SizeParm = 'Hits') fSize = fHits

    if  (GECTechnology_Techview_Polar_RBOBJ)
+       goto !v200_Polar_size
+   endif

    if-1  (GECTechnology_Techview_List_RBOBJ) 
+       if-2  (fSize < 5000) 
+           //message = 'fSize < 5000' window message info ok
+           Xsize = 1 
+           Ysize = 1
+       else-2
+           if-3  (fSize < 20000) 
+               Xsize = 5 
+               Ysize = 5
+   endif

    if  (fSize > 50000)
+       Xsize += 5
+       Ysize += 5
+   endif
    if  (fSize > 125000)
+       Xsize += 5
+       Ysize += 5
+   endif
    if  (fSize > 250000)
+       Xsize += 5
+       Ysize += 5
+   endif
    if  (fSize > 500000)
+       Xsize += 5
+       Ysize += 5
+   endif
    if  (fSize > 1000000)
+       Xsize += 10
+       Ysize += 10
+   endif    
    if  (fSize > 3000000)
+       Xsize += 10
+       Ysize += 10
+   endif
    if  (fSize > 5000000)
+       Xsize += 10
+       Ysize += 10
+   endif
    goto !v200_size_set

!v200_Polar_size
    if  (fSize > 50000)
+       Xsize += 2
+       Ysize += 2
+   endif
    if  (fSize > 125000)
+       Xsize += 2
+       Ysize += 2
+   endif
    if  (fSize > 250000)
+       Xsize += 2
+       Ysize += 2
+   endif
    if  (fSize > 500000)
+       Xsize += 2
+       Ysize += 2
+   endif
    if  (fSize > 1000000)
+       Xsize += 2
+       Ysize += 2
+   endif    
    if  (fSize > 3000000)
+       Xsize += 2
+       Ysize += 2
+   endif
    if  (fSize > 5000000)
+       Xsize += 2
+       Ysize += 2
+   endif

    fRingSize = Xsize * Zoom
    Xsize = fRingSize
    Ysize = fRingSize

    if  (Type = 'Platforms')
+       Angle = PlatformsAngle
+       StartAngle = PlatformsStartAngle
+       EndAngle = PlatformsEndAngle
+   endif
    if  (Type = 'Tools')
+       Angle = ToolsAngle
+       StartAngle = ToolsStartAngle
+       EndAngle = ToolsEndAngle
+   endif
    if  (Type = 'Languages')
+       Angle = LanguagesAngle
+       StartAngle = LanguagesStartAngle
+       EndAngle = LanguagesEndAngle
+   endif
    if  (Status = 'Adopt')
+       Radius = 1
+   endif
    if  (Status = 'Trial')
+       Radius = 125
+   endif
    if  (Status = 'Assess')
+       Radius = 175
+   endif
    if  (Status = 'Hold')
+       Radius = 225
+   endif
    if  (Status = 'Move Off')
+       Radius = 275
+   endif

//    if  (Angle > 30) and (Angle < 240)
//+       Radius += Xsize
//+   else
//+       TempWork = Xsize / 2
//+       Radius += TempWork
//+   endif

    TempWork = Xsize / 2
    Radius += TempWork

    fRingSize = Radius * Zoom
    Radius = fRingSize

    CosineDistance = cos(Angle)
    fXpos = Radius * CosineDistance
    Xpos = fXpos
    Xpos += 625
    SinDistance = sin(Angle)
    fYpos = Radius * SinDistance
    Ypos = fYpos
    Ypos += 325

    goto !v200_pos_ready

!v200_size_set
    //*****************************************
    //* Setup X positions start and end
    //*****************************************
    if  (Status = 'Assess') 
+       Xpos = 40
+       Xend = 150
+   endif
    if  (Status = 'Trial') 
+       Xpos = 160
+       Xend = 310
+   endif
    if  (Status = 'Adopt') 
+       Xpos = 320
+       Xend = 900
+   endif
    if  (Status = 'Hold') 
+       Xpos = 910
+       Xend = 1160
+   endif
    if  (Status = 'Move Off') 
+       Xpos = 1170
+       Xend = 1310
+   endif

    TempWork = Xsize / 2
    Xpos += TempWork

    Xstart = Xpos 

!v200_pos_ready
    //*******************************
    //* Set the Object Type
    //*******************************
    if-1  (Watch)
+       ObjectType = 'STTXTR'
+   else-1
+       if-2  (Strategy != "")
+           ObjectType = 'STTXT1'
+       else-2
+           ObjectType = 'STTXTF'
+   endif
    if  (Type = 'Tools') ObjectType = 'STTXTR'
    if  (Type = 'Languages') ObjectType = 'STTXT1'
    if  (Type = 'Platforms') ObjectType = 'STTXTF'

    sCurrCCYY = '20@date[7-8]@'
    CurrCCYY = sCurrCCYY
    AgeDiff = CurrCCYY - Age

    if  (GECTechnology_Techview_Polar_RBOBJ)
+       goto !v200_size_done
+   endif

    Ypos = 70

    //message = 'CurrCCYY[@CurrCCYY@] Age[@Age@] AgeDiff[@AgeDiff@]' window message info ok

    Yaxis = 1
    Ypos += 430

    //***************************************
    //* Shift upwards for older
    //***************************************
    if  (Displayby = 'Size')
+       goto !v200_size
+   endif
    if  (AgeDiff > 0)
+       Ypos -= 50
+       Yaxis = 2
+       if  (AgeDiff > 2) 
+           Ypos -= 50
+           Yaxis = 2
+           if  (AgeDiff > 3) 
+               Ypos -= 50
+               Yaxis = 3
+               if  (AgeDiff > 4) 
+                   Ypos -= 50
+                   Yaxis = 3
+                   if  (AgeDiff > 6) 
+                       Ypos -= 50
+                       Yaxis = 4
+                       if  (AgeDiff > 8) 
+                           Ypos -= 50
+                           Yaxis = 4
+                           if  (AgeDiff >= 10) 
+                               Ypos -= 50
+                               Yaxis = 5
+                               if  (AgeDiff >= 12) 
+                                   Ypos -= 50
+                                   Yaxis = 5
+   endif

    Ystart = Ypos

    if  (!GECTechnology_Techview_List_RBOBJ)
+       window show GECTechnology_Techview_Age-10Plus_STTXT
+       GECTechnology_Techview_Age-10+_STTXT = '10' window modify GECTechnology_Techview_Age-10+_STTXT
+       GECTechnology_Techview_Age-6-9_STTXT = ' 9' window modify GECTechnology_Techview_Age-6-9_STTXT window show GECTechnology_Techview_Age-6-9_STTXT
+       GECTechnology_Techview_Age-4-6_STTXT = ' 6' window modify GECTechnology_Techview_Age-4-6_STTXT
+       GECTechnology_Techview_Age-2-3_STTXT = ' 3' window modify GECTechnology_Techview_Age-2-3_STTXT window show GECTechnology_Techview_Age-2-3_STTXT
+       GECTechnology_Techview_Age-0-1_STTXT = ' 1' window modify GECTechnology_Techview_Age-0-1_STTXT
+       window show GECTechnology_Techview_Age1_STTXT
+       window show GECTechnology_Techview_Age2_STTXT
+       window show GECTechnology_Techview_Age3_STTXT
+   endif
    goto !v200_size_done

!v200_size
    window hide GECTechnology_Techview_Age-10Plus_STTXT
    GECTechnology_Techview_Age-10+_STTXT = 'L' window modify GECTechnology_Techview_Age-10+_STTXT
    GECTechnology_Techview_Age-6-9_STTXT = null window modify GECTechnology_Techview_Age-6-9_STTXT window hide GECTechnology_Techview_Age-6-9_STTXT
    GECTechnology_Techview_Age-4-6_STTXT = 'M' window modify GECTechnology_Techview_Age-4-6_STTXT
    GECTechnology_Techview_Age-2-3_STTXT = null window modify GECTechnology_Techview_Age-2-3_STTXT window hide GECTechnology_Techview_Age-2-3_STTXT
    GECTechnology_Techview_Age-0-1_STTXT = 'S' window modify GECTechnology_Techview_Age-0-1_STTXT
    window hide GECTechnology_Techview_Age1_STTXT
    window hide GECTechnology_Techview_Age2_STTXT
    window hide GECTechnology_Techview_Age3_STTXT
    Yaxis = 1
    //***************************************
    //* Shift upwards for bigger
    //***************************************
    if  (fSize > 99999)                               //100,000
+       Ypos -= 50
+       Yaxis = 1
+       if  (fSize > 199999)                          //200,000
+           Ypos -= 50
+           Yaxis = 2
+           if  (fSize > 249999)                      //250,000
+               Ypos -= 50
+               Yaxis = 3
+               if  (fSize > 499999)                  //500,000 
+                   Ypos -= 50
+                   Yaxis = 3
+                   if  (fSize > 749999)              //750,000
+                       Ypos -= 50
+                       Yaxis = 4
+                       if  (fSize > 999999)          //1 Million 
+                           Ypos -= 50
+                           Yaxis = 4
+                           if  (fSize > 1999999)     //2 Million
+                               Ypos -= 50
+                               Yaxis = 5
+                               if  (fSize > 4999999) //5 Million
+                                   Ypos -= 50
+                                   Yaxis = 5
+   endif

    Ystart = Ypos

!v200_size_done
    if  (Status = 'Assess')
+       iCountAssess += 1
+       iTotalAssess += Ypos
+   endif
    if  (Status = 'Trial')
+       iCountTrial += 1
+       iTotalTrial += Ypos
+   endif
    if  (Status = 'Adopt')
+       iCountAdopt += 1
+       iTotalAdopt += Ypos
+   endif
    if  (Status = 'Hold')
+       iCountHold += 1
+       iTotalHold += Ypos
+   endif
    if  (Status = 'Move Off')
+       iCountMoveOff += 1
+       iTotalMoveOff += Ypos
+   endif

    if  (GECTechnology_Techview_Polar_RBOBJ)
+       call !v215_Polar
+       return
+   endif

    if  (GECTechnology_Techview_List_RBOBJ)
+       call !v250_list
+       return
+   endif

    Yend = Ypos + 100
    if  (DrawDirection = 'Down')
+       call !v205_down
+       return
+   endif
    Ymax = 0
    do
        Xtest = Xpos + Xsize + 5
        OK = 'n'
        if-1  (Xtest > Xend)
+           //*************************
+           //* Past the barrier
+           //*************************
+           Xpos = Xstart
+           Ypos = Ypos + Ymax + 5
+           Ymax = 0
+           call !v500_check_ok
+           if-2  (OK)
+               call !v600_paintfile
+               call !v300_objectsfile
+       else-1
+           call !v500_check_ok
+           if-3  (OK)
+               call !v600_paintfile
+               call !v300_objectsfile
+       endif

        if-1  (OK)
+           Xpos = Xpos + Xsize + 5
+       else-1
+           if-2 (OK = 'X')
+               Xpos = Xpos + SizeFile + 5
+               if-3  (Yheight > Ymax)
+                   Ymax = Yheight
+       endif 
    until (OK)
    //write ObjectsFile fgbobjects.dat
    return

//****************************************
//* Draw Downwards
//****************************************
!v205_down
    Xmax = 0
    do
        Ytest = Ypos + Ysize + 5
        OK = 'n'
        if-1  (Ytest > Yend)
+           //*************************
+           //* Past the barrier
+           //*************************
+           Ypos = Ystart
+           Xpos = Xpos + Xmax + 5
+           Xmax = 0
+           call !v500_check_ok
+           if-2  (OK)
+               call !v600_paintfile
+               call !v300_objectsfile
+                    
+       else-1
+           call !v500_check_ok
+           if-3  (OK)
+               call !v600_paintfile
+               call !v300_objectsfile
+       endif

        if-1  (OK)
+           Ypos = Ypos + Ysize + 5
+       else-1
+           if-2 (OK = 'X')
+               Ypos = Ypos + SizeFile + 5
+               if-3  (Xheight > Xmax)
+                   Xmax = Xheight
+       endif 
    until (OK)
    return

//****************************************
//* Check the Application
//****************************************
!v210_application

    NoMatchApplication = 'n'
    file Applications
    b
    SearchString = '@GECTechnology_Techview_Application_COOBJ@|'
!v210_loop
    fs:/@SearchString@/
    if  (eof) 
+       NoMatchApplication = 'y'
+       return
+   endif
    scan:/@line/:/|/
    scan:/@right/:/|/
    scan:/@right/:/|/
    if  (Name != left) or (Version != right)
+       f;1
+       goto !v210_loop
+   endif
    return

//****************************************
//* Draw Polar Data
//****************************************
!v215_Polar
    Ymax = 0
    AddAngle = 37
    //message = 'v215_Polar Angle[@Angle@] StartAngle[@StartAngle@] EndAngle[@EndAngle@] Radius[@Radius@] CosinDistance[@CosineDistance@] SinDistance[@SinDistance@] Type[@Type@] Name[@Name@] Xpos[@Xpos@] Ypos[@Ypos@]' window message info ok
    do
        OK = 'n'
        if  (Angle > EndAngle)
+            Angle = Angle - EndAngle 
+            Angle = Angle + StartAngle
+            Radius = Radius + Xsize
+       endif
        CosineDistance = cos(Angle)
        fXpos = Radius * CosineDistance
        Xpos = fXpos
        Xpos += 625
        SinDistance = sin(Angle)
        fYpos = Radius * SinDistance
        Ypos = fYpos * -1
        Ypos += 325
        OrigAngle = Angle
        Angle += AddAngle
        //AddAngle -= 7
        if  (AddAngle < 7) AddAngle = 7
        call !v500_check_ok
        if  (OK)
+           call !v600_paintfile
+           call !v300_objectsfile
+       endif
        if  (Angle > EndAngle)
+            Angle = Angle - EndAngle 
+            Angle = Angle + StartAngle
+            Radius = Radius + Xsize
+       endif 
        if  (!OK)
+           CosineDistance = cos(Angle)
+           fXpos = Radius * CosineDistance
+           Xpos = fXpos
+           Xpos += 625
+           SinDistance = sin(Angle)
+           fYpos = Radius * SinDistance
+           Ypos = fYpos * -1
+           Ypos += 325
+           //message = 'new test Angle[@Angle@] Radius[@Radius@] CosinDistance[@CosineDistance@] SinDistance[@SinDistance@] Type[@Type@] Name[@Name@] Xpos[@Xpos@] Ypos[@Ypos@]' window message info ok
+       endif
        if  (Type = 'Platforms')
+           PlatformsAngle = Angle
+       endif
        if  (Type = 'Tools')
+           ToolsAngle = Angle
+       endif
        if  (Type = 'Languages')
+           LanguagesAngle = Angle
+       endif
    until (OK)
    //message = 'Polar Object Painted' window message info ok
    return

//****************************************
//* Create the List File
//****************************************
!v250_list
    ListCount ++
    if  (ListCurrPage != ListPage) return
    file ListFile
    TempWork = Xsize * 1.67
    Xsize = TempWork
    Newline = '@Name@|@Type@|@Xsize@|@Version@'
    i:/@Newline@/
    //message = Newline window message info ok
    return


//****************************************
//* Draw the List View
//****************************************
!v260_paint_list  
    ObjectCount = 0 
    file ListFile
    b
    if (eof) return
    do
        scan:/@line/:/|/
        Name = left
        scan:/@right/:/|/
        Type = left
        scan:/@right/:/|/
        Xsize = left
        Version = right

        //********************
        //* Text
        //********************
        file PaintFile
        b fs:/,Box,/
        b;1
        Newline = 'GECTechnology_Techview_WIN,Text,Text,@ListXpos@,@ListYpos@,@ListHeight@,@ListHeight@,0,0,0,Courior,@Name@............................................................................' i:/@Newline@/
        Xpos = ListXpos
        Ypos = ListYpos
        ListHoldXsize = Xsize
        Xsize = 100
        Ysize = ListHeight

        Xpos = ListXpos
        Ypos = ListYpos
        Ysize = ListHeight
        ObjectCount ++
        ObjectName = "Object-@ObjectCount@"
        BubbleX = Xpos
        BubbleY = Ypos
        BubbleCX = Xpos + 200
        BubbleCY = Ypos + ListHeight
        Newline = '@ObjectName@|@BubbleX@|@BubbleY@|@BubbleCX@|@BubbleCY@|@Type@|@Name@|@Version@'
        file ObjectsFile
        f;*
        i:/@Newline@/        

        //********************
        //* Bar
        //********************
        Xsize = ListHoldXsize
        Xsize = Xsize * 10
        file PaintFile

        if  (Type = "Languages") ListColor = LanguagesColor
        if  (Type = "Tools") ListColor = ToolsColor
        if  (Type = "Platforms") ListColor = PlatformsColor

        f;*
        ListBoxHeight = ListHeight - 2
        Newline = 'GECTechnology_Techview_WIN,Box,Box,@ListXBoxPos@,@ListYpos@,@Xsize@,@ListHeight@,@ListColor@' i:/@Newline@/ 
        Xpos = ListXBoxPos
        Ypos = ListYpos
        Ysize = ListHeight
        ObjectCount ++
        ObjectName = "Object-@ObjectCount@"
        BubbleX = Xpos
        BubbleY = Ypos
        BubbleCX = Xpos + Xsize
        BubbleCY = Ypos + ListHeight
        Newline = '@ObjectName@|@BubbleX@|@BubbleY@|@BubbleCX@|@BubbleCY@|@Type@|@Name@|@Version@'
        file ObjectsFile
        f;*
        i:/@Newline@/

        ListYpos = ListYpos + ListHeight + 2
        file ListFile
        f;1
    until (eof)

    //*************************
    //* Cover leftover Dots...
    //*************************
    file PaintFile
    b
    ListYpos -= 100
    Newline = 'GECTechnology_Techview_WIN,Box,Box,98,100,@ListXBoxPos@,@ListYpos@,255,255,255' ib:/@Newline@/ 
    f;1
    fs:/,Box,/
    b;1
    Newline = 'GECTechnology_Techview_WIN,Box,Box,@ListXBoxPos@,100,1000,@ListYpos@,255,255,255' i:/@Newline@/ 
    Newline = 'GECTechnology_Techview_WIN,Text,Text,230,611,18,18,0,0,0,Times New Roman,Page @ListPage@' i:/@Newline@/ 
    return

//****************************************
//* Create Object File Data
//****************************************
!v300_objectsfile
    TempWork = Xsize / 2
    BubbleX = Xpos - TempWork
    BubbleY = Ypos - TempWork
    BubbleCX = Xpos + TempWork
    BubbleCY = Ypos + TempWork
    Newline = '@ObjectName@|@BubbleX@|@BubbleY@|@BubbleCX@|@BubbleCY@|@Type@|@Name@|@Version@'
    file ObjectsFile
    f;*
    i:/@Newline@/
    return

//****************************************
//* Delete Objects
//****************************************
!v400_delete_objects
    file ObjectsFile error return
    b
    do
        if  (!eof)
+           scan:/@line/:/|/
+           ObjectName = left
+           MacroCommand = "window deletecontrol @ObjectName@" $MacroCommand error
+       endif
        f;1
    until (eof)
    b
    d;*
    return

//****************************************
//* Check the ObjectsFile to see if it's OK
//* to create an object at this location
//****************************************
!v500_check_ok
    OK = 'n'
    file ObjectsFile
    b
    do
        if-1  (eof)
+           OK = 'y'
+           return
+       else-1
+           scan:/@line/:/|/
+           scan:/@right/:/|/
+           Xfile = left
+           scan:/@right/:/|/
+           Yfile = left 
+           scan:/@right/:/|/
+           SizeFile = left
+           Xheight = left
+           TestCX = left
+           Xheight -= Xfile
+           SizeFile -= Xfile
+           scan:/@right/:/|/
+           Yheight = left
+           TestCY = left
+           Yheight -= Yfile
+           scan:/@right/:/|/
+           scan:/@right/:/|/
+           call !v510_check_overlap
+           if-2  (OK = 'X') 
+               DrawLocRetry ++          
+               return
+       endif
        f;1
    until (eof)
    OK = 'y'
    return

!v510_check_overlap
    int OverlapXpos error
    int OverlapYpos error
    float fSizeFile error
    float fXsize error
    int OrigXfile error
    int OrigYfile error
    OrigXfile = Xfile
    OrigYfile = Yfile

    fSizeFile = Xheight
    //TempWork = fSizeFile / 2
    //Xfile = Xfile - TempWork
    //Yfile = Yfile - TempWork
    //TestCX = TestCX - TempWork
    //TestCY = TestCY - TempWork
    //TestCX = Xfile + TestCX
    //TestCY = Yfile + TestCY

    fXsize = Xsize
    TempWork = fXsize / 2
    OverlapXpos = Xpos - TempWork
    OverlapYpos = Ypos - TempWork
    //OverlapXpos = Xpos
    //OverlapYpos = Ypos

    //Newline = 'Debug: Name[@Name@] FileName[@left@] Xpos[@Xpos@] OverlapXpos[@OverlapXpos@] Ypos[@Ypos@] OverlapYpos[@OverlapYpos@] Xsize[@Xsize@] Xfile[@Xfile@] OrigXfile[@OrigXfile@] Yfile[@Yfile@] OrigYfile[@OrigYfile@] SizeFile[@SizeFile@]'
    //file DebugFile
    //i:/@Newline/
    //file ObjectsFile

    if-1  (OverlapXpos >= Xfile) and (OverlapXpos <= TestCX) and (OverlapYpos >= Yfile) and (OverlapYpos <= TestCY) OK = 'X' return      
+   else-1 
+       TestX = OverlapXpos + Xsize 
+       TestY = OverlapYpos + Xsize      
+       if-2 (TestX >= Xfile) and (TestX <= TestCX) and (TestY >= Yfile) and (TestY <= TestCY) OK = 'X' return   
+       else-2
+           TestX = OverlapXpos TestY = OverlapYpos + Ysize
+           if-3 (TestX >= Xfile) and (TestX <= TestCX) and (TestY >= Yfile) and (TestY <= TestCY) OK = 'X' return
+           else-3
+               TestX = OverlapXpos + Xsize  TestY = OverlapYpos
+               if-4 (TestX >= Xfile) and (TestX <= TestCX) and (TestY >= Yfile) and (TestY <= TestCY) OK = 'X' return    
+   endif
    TestX = OverlapXpos + Xsize
    TestY = OverlapYpos + Xsize
    if  (OverlapXpos < Xfile) and (TestX > TestCX) and (OverlapYpos < Yfile) and (TestY > TestCY) OK = 'X' return
    if  (OverlapXpos < Xfile) and (TestX > TestCX) and (OverlapYpos >= Yfile) and (OverlapYpos <= TestCY) OK = 'X' return
    if  (OverlapXpos < Xfile) and (TestX > TestCX) and (TestY >= Yfile) and (TestY <= TestCY) OK = 'X' return

    if  (OverlapYpos < Yfile) and (TestY > TestCY) and (OverlapXpos >= Xfile) and (OverlapXpos <= TestCX) OK = 'X' return
    if  (OverlapYpos < Yfile) and (TestY > TestCY) and (TestX >= Xfile) and (TestX <= TestCX) OK = 'X' return
    return

//****************************************
//* Setup the PaintFile data
//****************************************
!v600_paintfile
    if  (GECTechnology_Techview_Polar_RBOBJ)
+       BallType = 'Ellipse'
+   else
+       BallType = 'Ellipse3D'
+   endif

    file PaintFile
    b
    fs:/,Text,/
    b;1
    if  (Watch) and (!Colors3D)
+       WatchXpos = Xpos
+       WatchYpos = Ypos
+       WatchXsize = Xsize + 4
+       WatchYsize = Ysize + 4
+       Newline = 'GECTechnology_Techview_WIN,Ellipse,Ellipse,@WatchXpos@,@WatchYpos@,@WatchXsize@,@WatchYsize@,0,0,0'
+       i:/@Newline@/
+   endif
    if  (Watch) and (Colors3D)
+       WatchXpos = Xpos
+       WatchYpos = Ypos
+       WatchXsize = Xsize + 6
+       WatchYsize = Ysize + 6
+       Newline = 'GECTechnology_Techview_WIN,Circle,Circle,@WatchXpos@,@WatchYpos@,@WatchXsize@,@WatchYsize@,0,0,0'
+       i:/@Newline@/
+   endif

    if  (!GECTechnology_Techview_Polar_RBOBJ) goto !v600_not_polar

    Radius = 2 * Xsize
    if  (Status = 'Adopt')
+       Radius = 75 - Radius
+   endif
    if  (Status = 'Trial')
+       Radius = Radius + 125
+   endif
    if  (Status = 'Assess')
+       Radius = Radius + 175
+   endif
    if  (Status = 'Hold')
+       Radius = Radius + 225
+   endif
    if  (Status = 'Move Off')
+       Radius = Radius + 275
+   endif
    if  (Radius < 1) Radius = 1
    fRingSize = Radius * Zoom
    Radius = fRingSize

!v600_not_polar
    if-1  (ObjectType = 'STTXTR') //**** Tools
+       if-2 (Colors3D)
+           TempWork = Xsize / 2
+           3DXpos = Xpos - TempWork
+           3DYpos = Ypos - TempWork
+           Newline = 'GECTechnology_Techview_WIN,BitmapFit,BitmapFit,@3DXpos@,@3DYpos@,@Xsize@,@Ysize@,GECTechBallOrange.bmp'  
+       else-2
+           Newline = 'GECTechnology_Techview_WIN,Ball,@BallType@,@Xpos@,@Ypos@,@Xsize@,@Ysize@,@ToolsColor@'  
+   endif

    if-1  (ObjectType = 'STTXT1') //**** Languages
+       if-2 (Colors3D)
+           TempWork = Xsize / 2
+           3DXpos = Xpos - TempWork
+           3DYpos = Ypos - TempWork
+           Newline = 'GECTechnology_Techview_WIN,BitmapFit,BitmapFit,@3DXpos@,@3DYpos@,@Xsize@,@Ysize@,GECTechBallGreen.bmp'  
+       else-2
+           Newline = 'GECTechnology_Techview_WIN,Ball,@BallType@,@Xpos@,@Ypos@,@Xsize@,@Ysize@,@LanguagesColor@'  
+   endif

    if-1  (ObjectType = 'STTXTF') //**** Platforms
+       if-2 (Colors3D)
+           TempWork = Xsize / 2
+           3DXpos = Xpos - TempWork
+           3DYpos = Ypos - TempWork
+           Newline = 'GECTechnology_Techview_WIN,BitmapFit,BitmapFit,@3DXpos@,@3DYpos@,@Xsize@,@Ysize@,GECTechBallBlue.bmp'  
+       else-2
+           Newline = 'GECTechnology_Techview_WIN,Ball,@BallType@,@Xpos@,@Ypos@,@Xsize@,@Ysize@,@PlatformsColor@'  
+   endif

    if-1  (ObjectType = 'STTXTF') //**** Platforms
+         if  (GECTechnology_Techview_Polar_RBOBJ)
+             PlatformsRadius += Radius
+             PlatformsCount ++
+   endif

    if-1  (ObjectType = 'STTXT1') //**** Languages
+         if  (GECTechnology_Techview_Polar_RBOBJ)
+             LanguagesRadius += Radius
+             LanguagesCount ++
+   endif

    if-1  (ObjectType = 'STTXTR') //**** Tools
+         if  (GECTechnology_Techview_Polar_RBOBJ)
+             ToolsRadius += Radius
+             ToolsCount ++
+   endif

    i:/@Newline@/

!v600_Strategy
    //****************************
    //* Strategy Line
    //****************************
    if  (!StrategyLines) 
+       call !v620_labels
+       return
+   endif
    if  (Strategy = null) 
+       call !v620_labels
+       return
+   return

    if  (GECTechnology_Techview_Polar_RBOBJ)
+       call !v610_polar_Strategy
+       call !v620_labels
+       return
+   endif

    //StrategyXsize = Xsize 
    StrategyXpos = Xpos
    //StrategyYsize = Ysize 
    StrategyYpos = Ypos


    if  (Strategy = 'Assess')
+       window windowpos GECTechnology_Techview_Assess_STTXT StrategyCX StrategyCY StatusX StatusY
+       StrategyCX += 25
+   endif
    if  (Strategy = 'Trial')
+       window windowpos GECTechnology_Techview_Trial_STTXT StrategyCX StrategyCY StatusX StatusY
+       StrategyCX += 17
+   endif
    if  (Strategy = 'Adopt')
+       window windowpos GECTechnology_Techview_Adopt_STTXT StrategyCX StrategyCY StatusX StatusY
+       StrategyCX += 17
+   endif
    if  (Strategy = 'Hold')
+       window windowpos GECTechnology_Techview_Hold_STTXT StrategyCX StrategyCY StatusX StatusY
+       StrategyCX += 15
+   endif
    if  (Strategy = 'Move Off')
+       window windowpos GECTechnology_Techview_MoveOff_STTXT StrategyCX StrategyCY StatusX StatusY
+       StrategyCX += 31
+   endif
    StrategyCY -= 5 
    Newline = 'GECTechnology_Techview_WIN,Arrow,Arrow,@StrategyXpos@,@StrategyYpos@,@StrategyCX@,@StrategyCY@,255,0,0' 
    b;2
    i:/@Newline/
    f;*
    if  (Filename = 'GECTechnology.dat')
+       //window paint GECTechnology_Techview_WIN
+   endif

    call !v620_labels

    return

//****************************************
//* Show Strategy Lines for Polar View
//****************************************
!v610_polar_Strategy
    float StrategyCos error
    float StrategySin error
    int   StrategyRadius error
    float StrategyX error
    float StrategyY error
    int   StrategyStartX error
    int   StrategyStartY error

    if  (Strategy = 'Adopt') StrategyRadius = 100
    if  (Strategy = 'Trial') StrategyRadius = 150
    if  (Strategy = 'Assess') StrategyRadius = 200
    if  (Strategy = 'Hold') StrategyRadius = 250
    if  (Strategy = 'Move Off') StrategyRadius = 300

    fRingSize = StrategyRadius * Zoom
    StrategyRadius = fRingSize

    StrategyCos = cos(OrigAngle)
    StrategyX = StrategyRadius * StrategyCos
    StrategyXpos = StrategyX
    StrategyXpos += 625
    StrategySin = sin(OrigAngle)
    StrategyY = StrategyRadius * StrategySin
    StrategyYpos = StrategyY * -1
    StrategyYpos += 325

    //StrategyStartX = Xsize / 2
    //StrategyStartX = StrategyStartX + Xpos
    //StrategyStartY = Ysize / 2
    //StrategyStartY = StrategyStartY + Xpos
    StrategyStartX = Xpos
    StrategyStartY = Ypos
    
    Newline = 'GECTechnology_Techview_WIN,Arrow,Arrow,@StrategyStartX@,@StrategyStartY@,@StrategyXpos@,@StrategyYpos@,255,0,0'

    //message = 'OrigAngle[@OrigAngle@] StrategyRadius[@StrategyRadius@] StrategyCos[@StrategyCos@] StrategySin[@StrategySin@] StrategyXpos[@StrategyXpos@] StrategyYpos[@StrategyYpos@]' window message info ok
    b;2
    i:/@Newline/
    f;*

    return

//****************************************
//* Show Labels
//****************************************
!v620_labels
    if  (LabelSize = 0)
+       return
+   endif
    TempWork = LabelSize / 2
    DisplayX = Xpos - TempWork
    //DisplayY = Ypos + TempWork
    //DisplayX = Xpos
    DisplayY = Ypos - TempWork

    Newline = 'GECTechnology_Techview_WIN,TextTilt,TextTilt,@DisplayX@,@DisplayY@,@LabelSize@,35,0,0,0,Times New Roman,@Name@'
    f;*
    i:/@Newline@/
    if  (Colors3D)
+       DisplayX --
+       DisplayY --
+       Newline = 'GECTechnology_Techview_WIN,TextTilt,TextTilt,@DisplayX@,@DisplayY@,@LabelSize@,35,255,255,255,Times New Roman,@Name@'
+       f;*
+       i:/@Newline/
+   endif

    if  (Filename = 'GECTechnology.dat')
+       //window paint GECTechnology_Techview_WIN
+   endif
    return

//****************************************
//* Convert PaintFile to HTML
//****************************************
!v900_html

    call !v910_html_details

    open HTMLFile null
    i:|<!-- GECTechnology.html -->|
    i:|<!DOCTYPE html PUBLIC "-W3C//DTD XHTML 1.0 Trasitional//EN"|
    i:|"http://ww.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">|
    i:|<htlm lang="en">|
    i:|<head>|
    i:|    <meta charset="utf-8">|
    i:|    <title>GECTechnology</title>|
    i:|    <link rel="stylesheet" type="text/css" href="GECTechnology-hover.css">|
    i:|</head>|
    i:|<body>|
    i:|    <div id="hoverdiv"></div>|
    i:|    <a href="GECTechnology_list.html"><input type="button" value="List" id="list_html"/></a>|
    i:|    <svg style="width:3000px; height:3000px;">|

    file PaintFile
    b

    do
        if  (!eof)
+           scan:/@line/:/GECTechnology_Techview_WIN,/
+           if (found)
+              call !v901_convert
+       endif
        file PaintFile
        f;1
    until (eof)

    file HTMLFile
    i:|    </svg>|
    i:|    <script type = "text/javascript" src="GECTechnology-jquery.js"></script>|
    i:|    <script type = "text/javascript" src="GECTechnology-hover.js"></script>|
    i:|</body>|
    i:|</html>|

    write HTMLFile GECTechnology.html
    write HTMLFile GECTechnology_Details_html/GECTechnology.html
    sort HTMLtabledata,a,1
    file HTMLtabledata
    b 
    clear
    copy;*
    file HTMLlist
    b
    fs:|</table>|
    b;1
    paste
    write HTMLlist GECTechnology_Details_html/GECTechnology_list.html
    close HTMLlist
    close HTMLFile
    close HTMLtabledata
    file PaintFile
    b
    return


//****************************************
//* Convert 1 PaintFile line to HTML
//****************************************
!v901_convert
    scan:/@right/:/,/
    scan:/@right/:/,/ ObjectType = left
    scan:/@right/:/,/ ObjectX = left
    scan:/@right/:/,/ ObjectY = left
    scan:/@right/:/,/ ObjectCX = left
    scan:/@right/:/,/ ObjectCY = left
    scan:/@right/:/,/ HTML_R = left
    scan:/@right/:/,/ HTML_G = left 
    HTML_B = right
    file HTMLFile
    if  (ObjectType = 'Ellipse') or (ObjectType = "Ellipse3D')
+       HTML_work = ObjectCX / 2
+       Newline = |        <circle cx="@ObjectX@" cy="@ObjectY@" r="@HTML_work@" style="stroke:rgb(@HTML_R@,@HTML_G@,@HTML_B@); fill:rgb(@HTML_R@,@HTML_G@,@HTML_B@);"/>|
+       i:/@Newline@/
+       return
+   endif
    if  (ObjectType = 'Arrow') or (ObjectType = 'Line')
+       Newline = |        <line x1="@ObjectX@" y1="@ObjectY@" x2="@ObjectCX@" y2="@ObjectCY@" style="stroke:rgb(@HTML_R@,@HTML_G@,@HTML_B@); fill:rgb(@HTML_R@,@HTML_G@,@HTML_B@);"/>|
+       i:/@Newline@/
+       return
+   endif
    if  (ObjectType = 'TextTilt')
+       scan:/@right/:/,/ HTML_B = left
+       scan:/@right/:/,/
+       HTML_text = right
+       ObjectX += 5
+       ObjectY += 5
+       call !v902_href
+       Newline = |        <a xlink:href="@HTML_href@"><text class="hover" hovertext="@HTML_text@" x="@ObjectX@" y="@ObjectY@" font-size="@ObjectCX@" fill="rgb(@HTML_R@,@HTML_G@,@HTML_B@)" transform="rotate(-@ObjectCY@ @ObjectX@,@ObjectY@)">@HTML_text@</text></a>|
+       i:/@Newline@/
+       return
+   endif
    if  (ObjectType = 'Text')
+       file PaintFile
+       scan:/@line/:/GECTechnology_Techview_WIN,/
+       scan:/@right/:/,/
+       scan:/@right/:/,/ ObjectType = left
+       scan:/@right/:/,/ ObjectX = left
+       scan:/@right/:/,/ ObjectY = left
+       scan:/@right/:/,/ ObjectCX = left
+       scan:/@right/:/,/ ObjectCY = left
+       scan:/@right/:/,/ HTML_R = left
+       scan:/@right/:/,/ HTML_G = left 
+       scan:/@right/:/,/ HTML_B = left 
+       scan:/@right/:/,/
+       file HTMLFile
+       ObjectX += 5
+       ObjectY += 10
+       Newline = |        <text x="@ObjectX@" y="@ObjectY@" font-size="@ObjectCX@" fill="rgb(@HTML_R@,@HTML_G@,@HTML_B@)">@right@</text>|
+       i:/@Newline@/
+       return
+   endif
    file PaintFile
    return

//****************************************
//* Find the href for the text
//****************************************
!v902_href
    HTML_href = ''
    file HTMLxref
    HTML_search = '@HTML_text@|'
    //message = HTML_search window message info ok
    b
    fs:/@HTML_search@/
    if  (!eof)
+       scan:/@line/:/|/
+       HTML_href = right
+   endif
    file HTMLFile
    return

//****************************************
//* Create the HTML details file
//****************************************
!v910_html_details
    system:"del GECTechnology_details_html/*.html"
    close HTMLtabledata error
    open HTMLtabledata null
    close HTMLlist error
    open HTMLlist null
    i:|<!-- Technology List -->|
    i:|<!DOCTYPE html PUBLIC "-W3C//DTD XHTML 1.0 Trasitional//EN"|
    i:|"http://ww.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">|
    i:|<htlm lang="en">|
    i:|<head>|
    i:|	  <meta charset="utf-8">|
    i:|	  <title>GECTechnology List</title>|
    i:|	  <link rel="stylesheet" type="text/css" href="GECTechnology_list.css">|
    i:|	  <style type="text/css">|
    i:|		table {border: 1px solid black}|
    i:|		tr {|
    i:|			background-color:Linen;|
    i:|			color:gray;|
    i:|			font-size:14px;|
    i:|			font-style:italic;|
    i:|		}|
    i:|		td {border: 2px solid black;}		|
    i:|	  </style>|
    i:|</head>|
    i:|<body>|
    i:|   <p>Search Criteria: <input id="searchname" type="text" size="75"/></p>	|
    i:|   <p>Technology List</p>|
    i:|   <ul id="technology_list">|
    i:|	     <table id="tabledata">|
    i:|          <th>Name</th><th>Version</th><th>Type</th><th>Description</th><th>Vendor</th><th>Arch Layers</th><th>Process</th><th>Business</th><th>Status</th><th>Strategy</th><th>Comments</th>|
    i:|      </table>|
    i:|   </ul>	|
    i:|   <script type = "text/javascript" src="jquery.js"></script>|
    i:|   <script type = "text/javascript" src="GECTechnology_list.js"></script>|
    i:|</body>|
    i:|</html>|
    b
    fs:|</table>|
    b;1

    close HTMLxref error
    open HTMLxref null
    DetailHTMLCount = 0
    close DataFile error
    open DataFile @Filename
    f;1
    do
        if (!eof)
+           scan:/@line/:/|/
+           Key = left pack Key
+           scan:/@right/:/|/
+           Type = left pack Type
+           scan:/@right/:/|/
+           Name = left pack Name
+           scan:/@right/:/|/
+           Description = left pack Description
+           scan:/@right/:/|/
+           Vendor = left pack Vendor
+           scan:/@right/:/|/
+           Version = left pack Version
+           scan:/@right/:/|/
+           Archlayers = left pack Archlayers
+           scan:/@right/:/|/
+           Techstacks = left pack Techstacks
+           scan:/@right/:/|/
+           Size = left pack Size
+           scan:/@right/:/|/
+           Maintenance = left pack Maintenance
+           scan:/@right/:/|/
+           Support = left pack Support
+           scan:/@right/:/|/
+           Hits = left pack Hits
+           scan:/@right/:/|/
+           Process = left pack Process
+           scan:/@right/:/|/
+           Business = left pack Business
+           scan:/@right/:/|/
+           Status = left pack Status
+           scan:/@right/:/|/
+           Strategy = left pack Strategy
+           scan:/@right/:/|/
+           ChangeDate = left pack ChangeDate
+           scan:/@right/:/|/
+           Watch = left pack Watch
+           call !a010_fix_watch
+           scan:/@right/:/|/
+           Age = left
+           Comments = right
+           scan:/@Age/:'/'
+           AgeCCYY = left
+           call !v915_html_detail_file
+           file DataFile
+           f;1
+       endif
    until (eof)
    close DataFile error
    //write HTMLxref fgb.dat
    return

//****************************************
//* Write the HTML Details file
//****************************************
!v915_html_detail_file
    close HTMLDetails error
    open HTMLDetails GECTechnology_Details.html
    b rs:/$Type/:/@Type@/
    b rs:/$Name/:/@Name@/;*
    b rs:/$Description/:/@Description@/
    b rs:/$Version/:/@Version@/
    b rs:/$Vendor/:/@Vendor@/
    b rs:/$Lines/:/@Size@/
    b rs:/$Maintenance/:/@Maintenance@/
    b rs:/$Support/:/@Support@/
    b rs:/$Hits/:/@Hits@/
    b rs:/$Archlayers/:/@Archlayers@/
    b rs:/$Techstacks/:/@Techstacks@/
    b rs:/$Process/:/@Process@/
    b rs:/$Business/:/@Business@/
    b rs:/$Status/:/@Status@/
    b rs:/$Strategy/:/@Strategy@/
    b rs:/$Changed/:/@ChangeDate@/
    b rs:/$Originated/:/@AgeCCYY@/
    b rs:/$Comments/:/@Comments@/
    b
    if  (Watch)
+       rs:/$Watch/:/checked/
+   else
+       rs:/$Watch/://
+   endif
    DetailHTMLCount ++
    HTMLDetailsFilename = 'GECTechnology_details_html/@DetailHTMLCount@.html'
    write HTMLDetails @HTMLDetailsFilename
    close HTMLDetails
    file HTMLxref
    Newline = '@Name@|@DetailHTMLCount@.html'
    i:/@Newline@/
    file HTMLtabledata
    Newline = |<tr id="@Name@sort"><td><a href="@DetailHTMLCount@.html">@Name@</a></td>|
    Newline = |@Newline@<td>@Version@</td>|
    Newline = |@Newline@<td>@Type@</td>|
    Newline = |@Newline@<td>@Description@</td>|
    Newline = |@Newline@<td>@Vendor@</td>|
    Newline = |@Newline@<td>@Archlayers@</td>|
    Newline = |@Newline@<td>@Process@</td>|
    Newline = |@Newline@<td>@Business@</td>|
    Newline = |@Newline@<td>@Status@</td>|
    Newline = |@Newline@<td>@Strategy@</td>|
    Newline = |@Newline@<td>@Comments@</td>|
    Newline = |@Newline@</tr>|
    i:/@Newline@/
    return

//****************************************
//* Check the Archlayers Filter
//****************************************
!w100_archlayers_filter
    if  (Archlayers = null)
+       Keepit = 'n'
+       return
+   endif

    scan:/@GECTechnology_Techview_Archlayers_EFOBJ@/:/,/
    if-1  (!found)
+       scan:/@Archlayers@/:/@GECTechnology_Techview_Archlayers_EFOBJ@/
+       if-2  (!found)
+           Keepit = 'n'
+           return
+       else-2
+           Keepit = 'y'
+           return
+   endif

!w100_loop
    HoldRight = right

    scan:/@Archlayers@/:/@left@/
    if  (!found)
+       Keepit = 'n'
+       return
+   endif

    scan:/@HoldRight/:/,/
    if  (found) goto !w100_loop
    scan:/@Archlayers@/:/@HoldRight@/
    if  (found)
+       Keepit = 'y'
+   else
+       Keepit = 'n'
+   endif
    return

//****************************************
//* Check the Techstacks Filter
//****************************************
!w200_techstacks_filter
    if  (Techstacks = null)
+       Keepit = 'n'
+       return
+   endif
    scan:/@GECTechnology_Techview_Techstacks_EFOBJ@/:/,/
    if-1  (!found)
+       scan:/@Techstacks@/:/@GECTechnology_Techview_Techstacks_EFOBJ@/
+       if-2  (!found)
+           Keepit = 'n'
+           return
+       else-2
+           Keepit = 'y'
+           return
+   endif

!w200_loop
    HoldRight = right
    scan:/@Techstacks@/:/@left@/
    if  (!found)
+       Keepit = 'n'
+       return
+   endif
    scan:/@HoldRight/:/,/
    if  (found) goto !w200_loop
    scan:/@Techstacks@/:/@HoldRight@/
    if  (found)
+       Keepit = 'y'
+   else
+       Keepit = 'n'
+   endif
    return
 
//****************************************
//* Special return for Entry Field Actions
//****************************************
!z999_entryaction_return
    return
 
//*********************************************************************
//*    End of Program GECTechnology.BED
//*********************************************************************
